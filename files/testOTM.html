<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Peng Xu" />

<meta name="date" content="2019-11-21" />

<title>testOTM Vignette</title>

<script>(function() {
  // If window.HTMLWidgets is already defined, then use it; otherwise create a
  // new object. This allows preceding code to set options that affect the
  // initialization process (though none currently exist).
  window.HTMLWidgets = window.HTMLWidgets || {};

  // See if we're running in a viewer pane. If not, we're in a web browser.
  var viewerMode = window.HTMLWidgets.viewerMode =
      /\bviewer_pane=1\b/.test(window.location);

  // See if we're running in Shiny mode. If not, it's a static document.
  // Note that static widgets can appear in both Shiny and static modes, but
  // obviously, Shiny widgets can only appear in Shiny apps/documents.
  var shinyMode = window.HTMLWidgets.shinyMode =
      typeof(window.Shiny) !== "undefined" && !!window.Shiny.outputBindings;

  // We can't count on jQuery being available, so we implement our own
  // version if necessary.
  function querySelectorAll(scope, selector) {
    if (typeof(jQuery) !== "undefined" && scope instanceof jQuery) {
      return scope.find(selector);
    }
    if (scope.querySelectorAll) {
      return scope.querySelectorAll(selector);
    }
  }

  function asArray(value) {
    if (value === null)
      return [];
    if ($.isArray(value))
      return value;
    return [value];
  }

  // Implement jQuery's extend
  function extend(target /*, ... */) {
    if (arguments.length == 1) {
      return target;
    }
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];
      for (var prop in source) {
        if (source.hasOwnProperty(prop)) {
          target[prop] = source[prop];
        }
      }
    }
    return target;
  }

  // IE8 doesn't support Array.forEach.
  function forEach(values, callback, thisArg) {
    if (values.forEach) {
      values.forEach(callback, thisArg);
    } else {
      for (var i = 0; i < values.length; i++) {
        callback.call(thisArg, values[i], i, values);
      }
    }
  }

  // Replaces the specified method with the return value of funcSource.
  //
  // Note that funcSource should not BE the new method, it should be a function
  // that RETURNS the new method. funcSource receives a single argument that is
  // the overridden method, it can be called from the new method. The overridden
  // method can be called like a regular function, it has the target permanently
  // bound to it so "this" will work correctly.
  function overrideMethod(target, methodName, funcSource) {
    var superFunc = target[methodName] || function() {};
    var superFuncBound = function() {
      return superFunc.apply(target, arguments);
    };
    target[methodName] = funcSource(superFuncBound);
  }

  // Add a method to delegator that, when invoked, calls
  // delegatee.methodName. If there is no such method on
  // the delegatee, but there was one on delegator before
  // delegateMethod was called, then the original version
  // is invoked instead.
  // For example:
  //
  // var a = {
  //   method1: function() { console.log('a1'); }
  //   method2: function() { console.log('a2'); }
  // };
  // var b = {
  //   method1: function() { console.log('b1'); }
  // };
  // delegateMethod(a, b, "method1");
  // delegateMethod(a, b, "method2");
  // a.method1();
  // a.method2();
  //
  // The output would be "b1", "a2".
  function delegateMethod(delegator, delegatee, methodName) {
    var inherited = delegator[methodName];
    delegator[methodName] = function() {
      var target = delegatee;
      var method = delegatee[methodName];

      // The method doesn't exist on the delegatee. Instead,
      // call the method on the delegator, if it exists.
      if (!method) {
        target = delegator;
        method = inherited;
      }

      if (method) {
        return method.apply(target, arguments);
      }
    };
  }

  // Implement a vague facsimilie of jQuery's data method
  function elementData(el, name, value) {
    if (arguments.length == 2) {
      return el["htmlwidget_data_" + name];
    } else if (arguments.length == 3) {
      el["htmlwidget_data_" + name] = value;
      return el;
    } else {
      throw new Error("Wrong number of arguments for elementData: " +
        arguments.length);
    }
  }

  // http://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex
  function escapeRegExp(str) {
    return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
  }

  function hasClass(el, className) {
    var re = new RegExp("\\b" + escapeRegExp(className) + "\\b");
    return re.test(el.className);
  }

  // elements - array (or array-like object) of HTML elements
  // className - class name to test for
  // include - if true, only return elements with given className;
  //   if false, only return elements *without* given className
  function filterByClass(elements, className, include) {
    var results = [];
    for (var i = 0; i < elements.length; i++) {
      if (hasClass(elements[i], className) == include)
        results.push(elements[i]);
    }
    return results;
  }

  function on(obj, eventName, func) {
    if (obj.addEventListener) {
      obj.addEventListener(eventName, func, false);
    } else if (obj.attachEvent) {
      obj.attachEvent(eventName, func);
    }
  }

  function off(obj, eventName, func) {
    if (obj.removeEventListener)
      obj.removeEventListener(eventName, func, false);
    else if (obj.detachEvent) {
      obj.detachEvent(eventName, func);
    }
  }

  // Translate array of values to top/right/bottom/left, as usual with
  // the "padding" CSS property
  // https://developer.mozilla.org/en-US/docs/Web/CSS/padding
  function unpackPadding(value) {
    if (typeof(value) === "number")
      value = [value];
    if (value.length === 1) {
      return {top: value[0], right: value[0], bottom: value[0], left: value[0]};
    }
    if (value.length === 2) {
      return {top: value[0], right: value[1], bottom: value[0], left: value[1]};
    }
    if (value.length === 3) {
      return {top: value[0], right: value[1], bottom: value[2], left: value[1]};
    }
    if (value.length === 4) {
      return {top: value[0], right: value[1], bottom: value[2], left: value[3]};
    }
  }

  // Convert an unpacked padding object to a CSS value
  function paddingToCss(paddingObj) {
    return paddingObj.top + "px " + paddingObj.right + "px " + paddingObj.bottom + "px " + paddingObj.left + "px";
  }

  // Makes a number suitable for CSS
  function px(x) {
    if (typeof(x) === "number")
      return x + "px";
    else
      return x;
  }

  // Retrieves runtime widget sizing information for an element.
  // The return value is either null, or an object with fill, padding,
  // defaultWidth, defaultHeight fields.
  function sizingPolicy(el) {
    var sizingEl = document.querySelector("script[data-for='" + el.id + "'][type='application/htmlwidget-sizing']");
    if (!sizingEl)
      return null;
    var sp = JSON.parse(sizingEl.textContent || sizingEl.text || "{}");
    if (viewerMode) {
      return sp.viewer;
    } else {
      return sp.browser;
    }
  }

  // @param tasks Array of strings (or falsy value, in which case no-op).
  //   Each element must be a valid JavaScript expression that yields a
  //   function. Or, can be an array of objects with "code" and "data"
  //   properties; in this case, the "code" property should be a string
  //   of JS that's an expr that yields a function, and "data" should be
  //   an object that will be added as an additional argument when that
  //   function is called.
  // @param target The object that will be "this" for each function
  //   execution.
  // @param args Array of arguments to be passed to the functions. (The
  //   same arguments will be passed to all functions.)
  function evalAndRun(tasks, target, args) {
    if (tasks) {
      forEach(tasks, function(task) {
        var theseArgs = args;
        if (typeof(task) === "object") {
          theseArgs = theseArgs.concat([task.data]);
          task = task.code;
        }
        var taskFunc = tryEval(task);
        if (typeof(taskFunc) !== "function") {
          throw new Error("Task must be a function! Source:\n" + task);
        }
        taskFunc.apply(target, theseArgs);
      });
    }
  }

  // Attempt eval() both with and without enclosing in parentheses.
  // Note that enclosing coerces a function declaration into
  // an expression that eval() can parse
  // (otherwise, a SyntaxError is thrown)
  function tryEval(code) {
    var result = null;
    try {
      result = eval(code);
    } catch(error) {
      if (!error instanceof SyntaxError) {
        throw error;
      }
      try {
        result = eval("(" + code + ")");
      } catch(e) {
        if (e instanceof SyntaxError) {
          throw error;
        } else {
          throw e;
        }
      }
    }
    return result;
  }

  function initSizing(el) {
    var sizing = sizingPolicy(el);
    if (!sizing)
      return;

    var cel = document.getElementById("htmlwidget_container");
    if (!cel)
      return;

    if (typeof(sizing.padding) !== "undefined") {
      document.body.style.margin = "0";
      document.body.style.padding = paddingToCss(unpackPadding(sizing.padding));
    }

    if (sizing.fill) {
      document.body.style.overflow = "hidden";
      document.body.style.width = "100%";
      document.body.style.height = "100%";
      document.documentElement.style.width = "100%";
      document.documentElement.style.height = "100%";
      if (cel) {
        cel.style.position = "absolute";
        var pad = unpackPadding(sizing.padding);
        cel.style.top = pad.top + "px";
        cel.style.right = pad.right + "px";
        cel.style.bottom = pad.bottom + "px";
        cel.style.left = pad.left + "px";
        el.style.width = "100%";
        el.style.height = "100%";
      }

      return {
        getWidth: function() { return cel.offsetWidth; },
        getHeight: function() { return cel.offsetHeight; }
      };

    } else {
      el.style.width = px(sizing.width);
      el.style.height = px(sizing.height);

      return {
        getWidth: function() { return el.offsetWidth; },
        getHeight: function() { return el.offsetHeight; }
      };
    }
  }

  // Default implementations for methods
  var defaults = {
    find: function(scope) {
      return querySelectorAll(scope, "." + this.name);
    },
    renderError: function(el, err) {
      var $el = $(el);

      this.clearError(el);

      // Add all these error classes, as Shiny does
      var errClass = "shiny-output-error";
      if (err.type !== null) {
        // use the classes of the error condition as CSS class names
        errClass = errClass + " " + $.map(asArray(err.type), function(type) {
          return errClass + "-" + type;
        }).join(" ");
      }
      errClass = errClass + " htmlwidgets-error";

      // Is el inline or block? If inline or inline-block, just display:none it
      // and add an inline error.
      var display = $el.css("display");
      $el.data("restore-display-mode", display);

      if (display === "inline" || display === "inline-block") {
        $el.hide();
        if (err.message !== "") {
          var errorSpan = $("<span>").addClass(errClass);
          errorSpan.text(err.message);
          $el.after(errorSpan);
        }
      } else if (display === "block") {
        // If block, add an error just after the el, set visibility:none on the
        // el, and position the error to be on top of the el.
        // Mark it with a unique ID and CSS class so we can remove it later.
        $el.css("visibility", "hidden");
        if (err.message !== "") {
          var errorDiv = $("<div>").addClass(errClass).css("position", "absolute")
            .css("top", el.offsetTop)
            .css("left", el.offsetLeft)
            // setting width can push out the page size, forcing otherwise
            // unnecessary scrollbars to appear and making it impossible for
            // the element to shrink; so use max-width instead
            .css("maxWidth", el.offsetWidth)
            .css("height", el.offsetHeight);
          errorDiv.text(err.message);
          $el.after(errorDiv);

          // Really dumb way to keep the size/position of the error in sync with
          // the parent element as the window is resized or whatever.
          var intId = setInterval(function() {
            if (!errorDiv[0].parentElement) {
              clearInterval(intId);
              return;
            }
            errorDiv
              .css("top", el.offsetTop)
              .css("left", el.offsetLeft)
              .css("maxWidth", el.offsetWidth)
              .css("height", el.offsetHeight);
          }, 500);
        }
      }
    },
    clearError: function(el) {
      var $el = $(el);
      var display = $el.data("restore-display-mode");
      $el.data("restore-display-mode", null);

      if (display === "inline" || display === "inline-block") {
        if (display)
          $el.css("display", display);
        $(el.nextSibling).filter(".htmlwidgets-error").remove();
      } else if (display === "block"){
        $el.css("visibility", "inherit");
        $(el.nextSibling).filter(".htmlwidgets-error").remove();
      }
    },
    sizing: {}
  };

  // Called by widget bindings to register a new type of widget. The definition
  // object can contain the following properties:
  // - name (required) - A string indicating the binding name, which will be
  //   used by default as the CSS classname to look for.
  // - initialize (optional) - A function(el) that will be called once per
  //   widget element; if a value is returned, it will be passed as the third
  //   value to renderValue.
  // - renderValue (required) - A function(el, data, initValue) that will be
  //   called with data. Static contexts will cause this to be called once per
  //   element; Shiny apps will cause this to be called multiple times per
  //   element, as the data changes.
  window.HTMLWidgets.widget = function(definition) {
    if (!definition.name) {
      throw new Error("Widget must have a name");
    }
    if (!definition.type) {
      throw new Error("Widget must have a type");
    }
    // Currently we only support output widgets
    if (definition.type !== "output") {
      throw new Error("Unrecognized widget type '" + definition.type + "'");
    }
    // TODO: Verify that .name is a valid CSS classname

    // Support new-style instance-bound definitions. Old-style class-bound
    // definitions have one widget "object" per widget per type/class of
    // widget; the renderValue and resize methods on such widget objects
    // take el and instance arguments, because the widget object can't
    // store them. New-style instance-bound definitions have one widget
    // object per widget instance; the definition that's passed in doesn't
    // provide renderValue or resize methods at all, just the single method
    //   factory(el, width, height)
    // which returns an object that has renderValue(x) and resize(w, h).
    // This enables a far more natural programming style for the widget
    // author, who can store per-instance state using either OO-style
    // instance fields or functional-style closure variables (I guess this
    // is in contrast to what can only be called C-style pseudo-OO which is
    // what we required before).
    if (definition.factory) {
      definition = createLegacyDefinitionAdapter(definition);
    }

    if (!definition.renderValue) {
      throw new Error("Widget must have a renderValue function");
    }

    // For static rendering (non-Shiny), use a simple widget registration
    // scheme. We also use this scheme for Shiny apps/documents that also
    // contain static widgets.
    window.HTMLWidgets.widgets = window.HTMLWidgets.widgets || [];
    // Merge defaults into the definition; don't mutate the original definition.
    var staticBinding = extend({}, defaults, definition);
    overrideMethod(staticBinding, "find", function(superfunc) {
      return function(scope) {
        var results = superfunc(scope);
        // Filter out Shiny outputs, we only want the static kind
        return filterByClass(results, "html-widget-output", false);
      };
    });
    window.HTMLWidgets.widgets.push(staticBinding);

    if (shinyMode) {
      // Shiny is running. Register the definition with an output binding.
      // The definition itself will not be the output binding, instead
      // we will make an output binding object that delegates to the
      // definition. This is because we foolishly used the same method
      // name (renderValue) for htmlwidgets definition and Shiny bindings
      // but they actually have quite different semantics (the Shiny
      // bindings receive data that includes lots of metadata that it
      // strips off before calling htmlwidgets renderValue). We can't
      // just ignore the difference because in some widgets it's helpful
      // to call this.renderValue() from inside of resize(), and if
      // we're not delegating, then that call will go to the Shiny
      // version instead of the htmlwidgets version.

      // Merge defaults with definition, without mutating either.
      var bindingDef = extend({}, defaults, definition);

      // This object will be our actual Shiny binding.
      var shinyBinding = new Shiny.OutputBinding();

      // With a few exceptions, we'll want to simply use the bindingDef's
      // version of methods if they are available, otherwise fall back to
      // Shiny's defaults. NOTE: If Shiny's output bindings gain additional
      // methods in the future, and we want them to be overrideable by
      // HTMLWidget binding definitions, then we'll need to add them to this
      // list.
      delegateMethod(shinyBinding, bindingDef, "getId");
      delegateMethod(shinyBinding, bindingDef, "onValueChange");
      delegateMethod(shinyBinding, bindingDef, "onValueError");
      delegateMethod(shinyBinding, bindingDef, "renderError");
      delegateMethod(shinyBinding, bindingDef, "clearError");
      delegateMethod(shinyBinding, bindingDef, "showProgress");

      // The find, renderValue, and resize are handled differently, because we
      // want to actually decorate the behavior of the bindingDef methods.

      shinyBinding.find = function(scope) {
        var results = bindingDef.find(scope);

        // Only return elements that are Shiny outputs, not static ones
        var dynamicResults = results.filter(".html-widget-output");

        // It's possible that whatever caused Shiny to think there might be
        // new dynamic outputs, also caused there to be new static outputs.
        // Since there might be lots of different htmlwidgets bindings, we
        // schedule execution for later--no need to staticRender multiple
        // times.
        if (results.length !== dynamicResults.length)
          scheduleStaticRender();

        return dynamicResults;
      };

      // Wrap renderValue to handle initialization, which unfortunately isn't
      // supported natively by Shiny at the time of this writing.

      shinyBinding.renderValue = function(el, data) {
        Shiny.renderDependencies(data.deps);
        // Resolve strings marked as javascript literals to objects
        if (!(data.evals instanceof Array)) data.evals = [data.evals];
        for (var i = 0; data.evals && i < data.evals.length; i++) {
          window.HTMLWidgets.evaluateStringMember(data.x, data.evals[i]);
        }
        if (!bindingDef.renderOnNullValue) {
          if (data.x === null) {
            el.style.visibility = "hidden";
            return;
          } else {
            el.style.visibility = "inherit";
          }
        }
        if (!elementData(el, "initialized")) {
          initSizing(el);

          elementData(el, "initialized", true);
          if (bindingDef.initialize) {
            var result = bindingDef.initialize(el, el.offsetWidth,
              el.offsetHeight);
            elementData(el, "init_result", result);
          }
        }
        bindingDef.renderValue(el, data.x, elementData(el, "init_result"));
        evalAndRun(data.jsHooks.render, elementData(el, "init_result"), [el, data.x]);
      };

      // Only override resize if bindingDef implements it
      if (bindingDef.resize) {
        shinyBinding.resize = function(el, width, height) {
          // Shiny can call resize before initialize/renderValue have been
          // called, which doesn't make sense for widgets.
          if (elementData(el, "initialized")) {
            bindingDef.resize(el, width, height, elementData(el, "init_result"));
          }
        };
      }

      Shiny.outputBindings.register(shinyBinding, bindingDef.name);
    }
  };

  var scheduleStaticRenderTimerId = null;
  function scheduleStaticRender() {
    if (!scheduleStaticRenderTimerId) {
      scheduleStaticRenderTimerId = setTimeout(function() {
        scheduleStaticRenderTimerId = null;
        window.HTMLWidgets.staticRender();
      }, 1);
    }
  }

  // Render static widgets after the document finishes loading
  // Statically render all elements that are of this widget's class
  window.HTMLWidgets.staticRender = function() {
    var bindings = window.HTMLWidgets.widgets || [];
    forEach(bindings, function(binding) {
      var matches = binding.find(document.documentElement);
      forEach(matches, function(el) {
        var sizeObj = initSizing(el, binding);

        if (hasClass(el, "html-widget-static-bound"))
          return;
        el.className = el.className + " html-widget-static-bound";

        var initResult;
        if (binding.initialize) {
          initResult = binding.initialize(el,
            sizeObj ? sizeObj.getWidth() : el.offsetWidth,
            sizeObj ? sizeObj.getHeight() : el.offsetHeight
          );
          elementData(el, "init_result", initResult);
        }

        if (binding.resize) {
          var lastSize = {
            w: sizeObj ? sizeObj.getWidth() : el.offsetWidth,
            h: sizeObj ? sizeObj.getHeight() : el.offsetHeight
          };
          var resizeHandler = function(e) {
            var size = {
              w: sizeObj ? sizeObj.getWidth() : el.offsetWidth,
              h: sizeObj ? sizeObj.getHeight() : el.offsetHeight
            };
            if (size.w === 0 && size.h === 0)
              return;
            if (size.w === lastSize.w && size.h === lastSize.h)
              return;
            lastSize = size;
            binding.resize(el, size.w, size.h, initResult);
          };

          on(window, "resize", resizeHandler);

          // This is needed for cases where we're running in a Shiny
          // app, but the widget itself is not a Shiny output, but
          // rather a simple static widget. One example of this is
          // an rmarkdown document that has runtime:shiny and widget
          // that isn't in a render function. Shiny only knows to
          // call resize handlers for Shiny outputs, not for static
          // widgets, so we do it ourselves.
          if (window.jQuery) {
            window.jQuery(document).on(
              "shown.htmlwidgets shown.bs.tab.htmlwidgets shown.bs.collapse.htmlwidgets",
              resizeHandler
            );
            window.jQuery(document).on(
              "hidden.htmlwidgets hidden.bs.tab.htmlwidgets hidden.bs.collapse.htmlwidgets",
              resizeHandler
            );
          }

          // This is needed for the specific case of ioslides, which
          // flips slides between display:none and display:block.
          // Ideally we would not have to have ioslide-specific code
          // here, but rather have ioslides raise a generic event,
          // but the rmarkdown package just went to CRAN so the
          // window to getting that fixed may be long.
          if (window.addEventListener) {
            // It's OK to limit this to window.addEventListener
            // browsers because ioslides itself only supports
            // such browsers.
            on(document, "slideenter", resizeHandler);
            on(document, "slideleave", resizeHandler);
          }
        }

        var scriptData = document.querySelector("script[data-for='" + el.id + "'][type='application/json']");
        if (scriptData) {
          var data = JSON.parse(scriptData.textContent || scriptData.text);
          // Resolve strings marked as javascript literals to objects
          if (!(data.evals instanceof Array)) data.evals = [data.evals];
          for (var k = 0; data.evals && k < data.evals.length; k++) {
            window.HTMLWidgets.evaluateStringMember(data.x, data.evals[k]);
          }
          binding.renderValue(el, data.x, initResult);
          evalAndRun(data.jsHooks.render, initResult, [el, data.x]);
        }
      });
    });

    invokePostRenderHandlers();
  }


  function has_jQuery3() {
    if (!window.jQuery) {
      return false;
    }
    var $version = window.jQuery.fn.jquery;
    var $major_version = parseInt($version.split(".")[0]);
    return $major_version >= 3;
  }

  /*
  / Shiny 1.4 bumped jQuery from 1.x to 3.x which means jQuery's
  / on-ready handler (i.e., $(fn)) is now asyncronous (i.e., it now
  / really means $(setTimeout(fn)).
  / https://jquery.com/upgrade-guide/3.0/#breaking-change-document-ready-handlers-are-now-asynchronous
  /
  / Since Shiny uses $() to schedule initShiny, shiny>=1.4 calls initShiny
  / one tick later than it did before, which means staticRender() is
  / called renderValue() earlier than (advanced) widget authors might be expecting.
  / https://github.com/rstudio/shiny/issues/2630
  /
  / For a concrete example, leaflet has some methods (e.g., updateBounds)
  / which reference Shiny methods registered in initShiny (e.g., setInputValue).
  / Since leaflet is privy to this life-cycle, it knows to use setTimeout() to
  / delay execution of those methods (until Shiny methods are ready)
  / https://github.com/rstudio/leaflet/blob/18ec981/javascript/src/index.js#L266-L268
  /
  / Ideally widget authors wouldn't need to use this setTimeout() hack that
  / leaflet uses to call Shiny methods on a staticRender(). In the long run,
  / the logic initShiny should be broken up so that method registration happens
  / right away, but binding happens later.
  */
  function maybeStaticRenderLater() {
    if (shinyMode && has_jQuery3()) {
      window.jQuery(window.HTMLWidgets.staticRender);
    } else {
      window.HTMLWidgets.staticRender();
    }
  }

  if (document.addEventListener) {
    document.addEventListener("DOMContentLoaded", function() {
      document.removeEventListener("DOMContentLoaded", arguments.callee, false);
      maybeStaticRenderLater();
    }, false);
  } else if (document.attachEvent) {
    document.attachEvent("onreadystatechange", function() {
      if (document.readyState === "complete") {
        document.detachEvent("onreadystatechange", arguments.callee);
        maybeStaticRenderLater();
      }
    });
  }


  window.HTMLWidgets.getAttachmentUrl = function(depname, key) {
    // If no key, default to the first item
    if (typeof(key) === "undefined")
      key = 1;

    var link = document.getElementById(depname + "-" + key + "-attachment");
    if (!link) {
      throw new Error("Attachment " + depname + "/" + key + " not found in document");
    }
    return link.getAttribute("href");
  };

  window.HTMLWidgets.dataframeToD3 = function(df) {
    var names = [];
    var length;
    for (var name in df) {
        if (df.hasOwnProperty(name))
            names.push(name);
        if (typeof(df[name]) !== "object" || typeof(df[name].length) === "undefined") {
            throw new Error("All fields must be arrays");
        } else if (typeof(length) !== "undefined" && length !== df[name].length) {
            throw new Error("All fields must be arrays of the same length");
        }
        length = df[name].length;
    }
    var results = [];
    var item;
    for (var row = 0; row < length; row++) {
        item = {};
        for (var col = 0; col < names.length; col++) {
            item[names[col]] = df[names[col]][row];
        }
        results.push(item);
    }
    return results;
  };

  window.HTMLWidgets.transposeArray2D = function(array) {
      if (array.length === 0) return array;
      var newArray = array[0].map(function(col, i) {
          return array.map(function(row) {
              return row[i]
          })
      });
      return newArray;
  };
  // Split value at splitChar, but allow splitChar to be escaped
  // using escapeChar. Any other characters escaped by escapeChar
  // will be included as usual (including escapeChar itself).
  function splitWithEscape(value, splitChar, escapeChar) {
    var results = [];
    var escapeMode = false;
    var currentResult = "";
    for (var pos = 0; pos < value.length; pos++) {
      if (!escapeMode) {
        if (value[pos] === splitChar) {
          results.push(currentResult);
          currentResult = "";
        } else if (value[pos] === escapeChar) {
          escapeMode = true;
        } else {
          currentResult += value[pos];
        }
      } else {
        currentResult += value[pos];
        escapeMode = false;
      }
    }
    if (currentResult !== "") {
      results.push(currentResult);
    }
    return results;
  }
  // Function authored by Yihui/JJ Allaire
  window.HTMLWidgets.evaluateStringMember = function(o, member) {
    var parts = splitWithEscape(member, '.', '\\');
    for (var i = 0, l = parts.length; i < l; i++) {
      var part = parts[i];
      // part may be a character or 'numeric' member name
      if (o !== null && typeof o === "object" && part in o) {
        if (i == (l - 1)) { // if we are at the end of the line then evalulate
          if (typeof o[part] === "string")
            o[part] = tryEval(o[part]);
        } else { // otherwise continue to next embedded object
          o = o[part];
        }
      }
    }
  };

  // Retrieve the HTMLWidget instance (i.e. the return value of an
  // HTMLWidget binding's initialize() or factory() function)
  // associated with an element, or null if none.
  window.HTMLWidgets.getInstance = function(el) {
    return elementData(el, "init_result");
  };

  // Finds the first element in the scope that matches the selector,
  // and returns the HTMLWidget instance (i.e. the return value of
  // an HTMLWidget binding's initialize() or factory() function)
  // associated with that element, if any. If no element matches the
  // selector, or the first matching element has no HTMLWidget
  // instance associated with it, then null is returned.
  //
  // The scope argument is optional, and defaults to window.document.
  window.HTMLWidgets.find = function(scope, selector) {
    if (arguments.length == 1) {
      selector = scope;
      scope = document;
    }

    var el = scope.querySelector(selector);
    if (el === null) {
      return null;
    } else {
      return window.HTMLWidgets.getInstance(el);
    }
  };

  // Finds all elements in the scope that match the selector, and
  // returns the HTMLWidget instances (i.e. the return values of
  // an HTMLWidget binding's initialize() or factory() function)
  // associated with the elements, in an array. If elements that
  // match the selector don't have an associated HTMLWidget
  // instance, the returned array will contain nulls.
  //
  // The scope argument is optional, and defaults to window.document.
  window.HTMLWidgets.findAll = function(scope, selector) {
    if (arguments.length == 1) {
      selector = scope;
      scope = document;
    }

    var nodes = scope.querySelectorAll(selector);
    var results = [];
    for (var i = 0; i < nodes.length; i++) {
      results.push(window.HTMLWidgets.getInstance(nodes[i]));
    }
    return results;
  };

  var postRenderHandlers = [];
  function invokePostRenderHandlers() {
    while (postRenderHandlers.length) {
      var handler = postRenderHandlers.shift();
      if (handler) {
        handler();
      }
    }
  }

  // Register the given callback function to be invoked after the
  // next time static widgets are rendered.
  window.HTMLWidgets.addPostRenderHandler = function(callback) {
    postRenderHandlers.push(callback);
  };

  // Takes a new-style instance-bound definition, and returns an
  // old-style class-bound definition. This saves us from having
  // to rewrite all the logic in this file to accomodate both
  // types of definitions.
  function createLegacyDefinitionAdapter(defn) {
    var result = {
      name: defn.name,
      type: defn.type,
      initialize: function(el, width, height) {
        return defn.factory(el, width, height);
      },
      renderValue: function(el, x, instance) {
        return instance.renderValue(x);
      },
      resize: function(el, width, height, instance) {
        return instance.resize(width, height);
      }
    };

    if (defn.find)
      result.find = defn.find;
    if (defn.renderError)
      result.renderError = defn.renderError;
    if (defn.clearError)
      result.clearError = defn.clearError;

    return result;
  }
})();

</script>
<style type="text/css">.rglPlayer {
width: auto;
height: auto;
}
.rglPlayer .rgl-button {
width: auto;
display: inline-block;
font-size: 75%;
}
.rglPlayer .rgl-slider {
display: inline-block;
width: 30%;
}
.rglPlayer .rgl-label {
display: inline;
padding-left: 6px;
padding-right: 6px;
}
</style>
<script>// To generate the help pages for this library, use

// jsdoc --destination ../../../doc/rglwidgetClass --template ~/node_modules/jsdoc-baseline rglClass.src.js

// To validate, use

// setwd(".../inst/htmlwidgets/lib/rglClass")
// hints <- js::jshint(readLines("rglClass.src.js"))
// hints[, c("line", "reason")]

/**
 * The class of an rgl widget
 * @class
*/
rglwidgetClass = function() {
    this.canvas = null;
    this.userMatrix = new CanvasMatrix4();
    this.types = [];
    this.prMatrix = new CanvasMatrix4();
    this.mvMatrix = new CanvasMatrix4();
    this.vp = null;
    this.prmvMatrix = null;
    this.origs = null;
    this.gl = null;
    this.scene = null;
    this.select = {state: "inactive", subscene: null, region: {p1: {x:0, y:0}, p2: {x:0, y:0}}};
    this.drawing = false;
};


    /**
     * Multiply matrix by vector
     * @returns {number[]}
     * @param M {number[][]} Left operand
     * @param v {number[]} Right operand
     */
    rglwidgetClass.prototype.multMV = function(M, v) {
        return [ M.m11 * v[0] + M.m12 * v[1] + M.m13 * v[2] + M.m14 * v[3],
                 M.m21 * v[0] + M.m22 * v[1] + M.m23 * v[2] + M.m24 * v[3],
                 M.m31 * v[0] + M.m32 * v[1] + M.m33 * v[2] + M.m34 * v[3],
                 M.m41 * v[0] + M.m42 * v[1] + M.m43 * v[2] + M.m44 * v[3]
               ];
    };
    
    /**
     * Multiply row vector by Matrix
     * @returns {number[]}
     * @param v {number[]} left operand
     * @param M {number[][]} right operand
     */
    rglwidgetClass.prototype.multVM = function(v, M) {
        return [ M.m11 * v[0] + M.m21 * v[1] + M.m31 * v[2] + M.m41 * v[3],
                 M.m12 * v[0] + M.m22 * v[1] + M.m32 * v[2] + M.m42 * v[3],
                 M.m13 * v[0] + M.m23 * v[1] + M.m33 * v[2] + M.m43 * v[3],
                 M.m14 * v[0] + M.m24 * v[1] + M.m34 * v[2] + M.m44 * v[3]
               ];
    };
    
    /**
     * Euclidean length of a vector
     * @returns {number}
     * @param v {number[]}
     */
    rglwidgetClass.prototype.vlen = function(v) {
      return Math.sqrt(this.dotprod(v, v));
    };

    /**
     * Dot product of two vectors
     * @instance rglwidgetClass
     * @returns {number}
     * @param a {number[]}
     * @param b {number[]}
     */
    rglwidgetClass.prototype.dotprod = function(a, b) {
      return a[0]*b[0] + a[1]*b[1] + a[2]*b[2];
    };

    /**
     * Cross product of two vectors
     * @returns {number[]}
     * @param a {number[]}
     * @param b {number[]}
     */
    rglwidgetClass.prototype.xprod = function(a, b) {
      return [a[1]*b[2] - a[2]*b[1],
          a[2]*b[0] - a[0]*b[2],
          a[0]*b[1] - a[1]*b[0]];
    };

    /**
     * Bind vectors or matrices by columns
     * @returns {number[][]}
     * @param a {number[]|number[][]}
     * @param b {number[]|number[][]}
     */
    rglwidgetClass.prototype.cbind = function(a, b) {
      if (b.length < a.length)
        b = this.repeatToLen(b, a.length);
      else if (a.length < b.length)
        a = this.repeatToLen(a, b.length);
      return a.map(function(currentValue, index, array) {
            return currentValue.concat(b[index]);
      });
    };

    /**
     * Swap elements
     * @returns {any[]}
     * @param a {any[]}
     * @param i {number} Element to swap
     * @param j {number} Other element to swap
     */
    rglwidgetClass.prototype.swap = function(a, i, j) {
      var temp = a[i];
      a[i] = a[j];
      a[j] = temp;
    };

    /**
     * Flatten a matrix into a vector
     * @returns {any[]}
     * @param a {any[][]}
     */
    rglwidgetClass.prototype.flatten = function(arr, result) {
      var value;
      if (typeof result === "undefined") result = [];
      for (var i = 0, length = arr.length; i < length; i++) {
        value = arr[i];
        if (Array.isArray(value)) {
          this.flatten(value, result);
        } else {
          result.push(value);
        }
      }
      return result;
    };

    /**
     * set element of 1d or 2d array as if it was flattened.
     * Column major, zero based!
     * @returns {any[]|any[][]}
     * @param {any[]|any[][]} a - array
     * @param {number} i - element
     * @param {any} value
     */
    rglwidgetClass.prototype.setElement = function(a, i, value) {
      if (Array.isArray(a[0])) {
        var dim = a.length,
            col = Math.floor(i/dim),
            row = i % dim;
        a[row][col] = value;
      } else {
        a[i] = value;
      }
    };

    /**
     * Transpose an array
     * @returns {any[][]}
     * @param {any[][]} a
     */
    rglwidgetClass.prototype.transpose = function(a) {
      var newArray = [],
          n = a.length,
          m = a[0].length,
          i;
      for(i = 0; i < m; i++){
        newArray.push([]);
      }

      for(i = 0; i < n; i++){
        for(var j = 0; j < m; j++){
          newArray[j].push(a[i][j]);
        }
      }
      return newArray;
    };

    /**
     * Calculate sum of squares of a numeric vector
     * @returns {number}
     * @param {number[]} x
     */
    rglwidgetClass.prototype.sumsq = function(x) {
      var result = 0, i;
      for (i=0; i < x.length; i++)
        result += x[i]*x[i];
      return result;
    };

    /**
     * Convert a matrix to a CanvasMatrix4
     * @returns {CanvasMatrix4}
     * @param {number[][]|number[]} mat
     */
    rglwidgetClass.prototype.toCanvasMatrix4 = function(mat) {
      if (mat instanceof CanvasMatrix4)
        return mat;
      var result = new CanvasMatrix4();
      mat = this.flatten(this.transpose(mat));
      result.load(mat);
      return result;
    };

    /**
     * Convert an R-style numeric colour string to an rgb vector
     * @returns {number[]}
     * @param {string} s
     */
    rglwidgetClass.prototype.stringToRgb = function(s) {
      s = s.replace("#", "");
      var bigint = parseInt(s, 16);
      return [((bigint >> 16) & 255)/255,
              ((bigint >> 8) & 255)/255,
               (bigint & 255)/255];
    };

    /**
     * Take a component-by-component product of two 3 vectors
     * @returns {number[]}
     * @param {number[]} x
     * @param {number[]} y
     */
    rglwidgetClass.prototype.componentProduct = function(x, y) {
      if (typeof y === "undefined") {
        this.alertOnce("Bad arg to componentProduct");
      }
      var result = new Float32Array(3), i;
      for (i = 0; i<3; i++)
        result[i] = x[i]*y[i];
      return result;
    };

    /**
     * Get next higher power of two
     * @returns { number }
     * @param { number } value - input value
     */
    rglwidgetClass.prototype.getPowerOfTwo = function(value) {
      var pow = 1;
      while(pow<value) {
        pow *= 2;
      }
      return pow;
    };

    /**
     * Unique entries
     * @returns { any[] }
     * @param { any[] } arr - An array
     */
    rglwidgetClass.prototype.unique = function(arr) {
      arr = [].concat(arr);
      return arr.filter(function(value, index, self) {
        return self.indexOf(value) === index;
      });
    };

    /**
     * Shallow compare of arrays
     * @returns { boolean }
     * @param { any[] } a - An array
     * @param { any[] } b - Another array
     */
    rglwidgetClass.prototype.equalArrays = function(a, b) {
      return a === b || (a && b &&
                      a.length === b.length &&
                      a.every(function(v, i) {return v === b[i];}));
    };
    
    /**
     * Repeat an array to a desired length
     * @returns {any[]}
     * @param {any | any[]} arr The input array
     * @param {number} len The desired output length
     */
    rglwidgetClass.prototype.repeatToLen = function(arr, len) {
      arr = [].concat(arr);
      while (arr.length < len/2)
        arr = arr.concat(arr);
      return arr.concat(arr.slice(0, len - arr.length));
    };

    /**
     * Give a single alert message, not to be repeated.
     * @param {string} msg  The message to give.
     */
    rglwidgetClass.prototype.alertOnce = function(msg) {
      if (typeof this.alerted !== "undefined")
        return;
      this.alerted = true;
      alert(msg);
    };

    rglwidgetClass.prototype.f_is_lit = 1;
    rglwidgetClass.prototype.f_is_smooth = 2;
    rglwidgetClass.prototype.f_has_texture = 4;
    rglwidgetClass.prototype.f_depth_sort = 8;
    rglwidgetClass.prototype.f_fixed_quads = 16;
    rglwidgetClass.prototype.f_is_transparent = 32;
    rglwidgetClass.prototype.f_is_lines = 64;
    rglwidgetClass.prototype.f_sprites_3d = 128;
    rglwidgetClass.prototype.f_sprite_3d = 256;
    rglwidgetClass.prototype.f_is_subscene = 512;
    rglwidgetClass.prototype.f_is_clipplanes = 1024;
    rglwidgetClass.prototype.f_fixed_size = 2048;
    rglwidgetClass.prototype.f_is_points = 4096;
    rglwidgetClass.prototype.f_is_twosided = 8192;
    rglwidgetClass.prototype.f_fat_lines = 16384;
    rglwidgetClass.prototype.f_is_brush = 32768;

    /**
     * Which list does a particular id come from?
     * @returns { string }
     * @param {number} id The id to look up.
     */
    rglwidgetClass.prototype.whichList = function(id) {
      var obj = this.getObj(id),
          flags = obj.flags;
        if (obj.type === "light")
          return "lights";
        if (flags & this.f_is_subscene)
            return "subscenes";
        if (flags & this.f_is_clipplanes)
            return "clipplanes";
        if (flags & this.f_is_transparent)
            return "transparent";
        return "opaque";
    };

    /**
     * Get an object by id number.
     * @returns { Object }
     * @param {number} id
     */
    rglwidgetClass.prototype.getObj = function(id) {
      if (typeof id !== "number") {
        this.alertOnce("getObj id is "+typeof id);
      }
      return this.scene.objects[id];
    };

    /**
     * Get ids of a particular type from a subscene or the whole scene
     * @returns { number[] }
     * @param {string} type What type of object?
     * @param {number} subscene  Which subscene?  If not given, find in the whole scene
     */
    rglwidgetClass.prototype.getIdsByType = function(type, subscene) {
      var
        result = [], i, self = this;
      if (typeof subscene === "undefined") {
        Object.keys(this.scene.objects).forEach(
          function(key) {
            key = parseInt(key, 10);
            if (self.getObj(key).type === type)
              result.push(key);
          });
      } else {
        ids = this.getObj(subscene).objects;
        for (i=0; i < ids.length; i++) {
          if (this.getObj(ids[i]).type === type) {
            result.push(ids[i]);
          }
        }
      }
      return result;
    };

    /**
     * Get a particular material property for an id
     * @returns { any }
     * @param {number} id  Which object?
     * @param {string} property Which material property?
     */
    rglwidgetClass.prototype.getMaterial = function(id, property) {
      var obj = this.getObj(id), mat;
      if (typeof obj.material === "undefined")
        console.error("material undefined");
      mat = obj.material[property];
      if (typeof mat === "undefined")
          mat = this.scene.material[property];
      return mat;
    };

    /**
     * Is a particular id in a subscene?
     * @returns { boolean }
     * @param {number} id Which id?
     * @param {number} subscene Which subscene id?
     */
    rglwidgetClass.prototype.inSubscene = function(id, subscene) {
      return this.getObj(subscene).objects.indexOf(id) > -1;
    };

    /**
     * Add an id to a subscene.
     * @param {number} id Which id?
     * @param {number} subscene Which subscene id?
     */
    rglwidgetClass.prototype.addToSubscene = function(id, subscene) {
      var thelist,
          thesub = this.getObj(subscene),
          ids = [id],
          obj = this.getObj(id), i;
      if (typeof obj != "undefined" && typeof (obj.newIds) !== "undefined") {
        ids = ids.concat(obj.newIds);
      }
      thesub.objects = [].concat(thesub.objects);
      for (i = 0; i < ids.length; i++) {
        id = ids[i];
        if (thesub.objects.indexOf(id) == -1) {
          thelist = this.whichList(id);
          thesub.objects.push(id);
          thesub[thelist].push(id);
        }
      }
    };

    /**
     * Delete an id from a subscene
     * @param { number } id - the id to add
     * @param { number } subscene - the id of the subscene
     */
    rglwidgetClass.prototype.delFromSubscene = function(id, subscene) {
      var thelist,
          thesub = this.getObj(subscene),
          obj = this.getObj(id),
          ids = [id], i;
      if (typeof obj !== "undefined" && typeof (obj.newIds) !== "undefined")
        ids = ids.concat(obj.newIds);
      thesub.objects = [].concat(thesub.objects); // It might be a scalar
      for (j=0; j<ids.length;j++) {
        id = ids[j];
        i = thesub.objects.indexOf(id);
        if (i > -1) {
          thesub.objects.splice(i, 1);
          thelist = this.whichList(id);
          i = thesub[thelist].indexOf(id);
          thesub[thelist].splice(i, 1);
        }
      }
    };

    /**
     * Set the ids in a subscene
     * @param { number[] } ids - the ids to set
     * @param { number } subsceneid - the id of the subscene
     */
    rglwidgetClass.prototype.setSubsceneEntries = function(ids, subsceneid) {
      var sub = this.getObj(subsceneid);
      sub.objects = ids;
      this.initSubscene(subsceneid);
    };

    /**
     * Get the ids in a subscene
     * @returns {number[]}
     * @param { number } subscene - the id of the subscene
     */
    rglwidgetClass.prototype.getSubsceneEntries = function(subscene) {
      return this.getObj(subscene).objects;
    };

    /**
     * Get the ids of the subscenes within a subscene
     * @returns { number[] }
     * @param { number } subscene - the id of the subscene
     */
    rglwidgetClass.prototype.getChildSubscenes = function(subscene) {
      return this.getObj(subscene).subscenes;
    };

    /**
     * Start drawing
     * @returns { boolean } Previous state
     */
    rglwidgetClass.prototype.startDrawing = function() {
    	var value = this.drawing;
    	this.drawing = true;
    	return value;
    };

    /**
     * Stop drawing and check for context loss
     * @param { boolean } saved - Previous state
     */
    rglwidgetClass.prototype.stopDrawing = function(saved) {
      this.drawing = saved;
      if (!saved && this.gl && this.gl.isContextLost())
        this.restartCanvas();
    };

    /**
     * Generate the vertex shader for an object
     * @returns {string}
     * @param { number } id - Id of object
     */
    rglwidgetClass.prototype.getVertexShader = function(id) {
      var obj = this.getObj(id),
          userShader = obj.userVertexShader,
          flags = obj.flags,
          type = obj.type,
          is_lit = flags & this.f_is_lit,
          has_texture = flags & this.f_has_texture,
          fixed_quads = flags & this.f_fixed_quads,
          sprites_3d = flags & this.f_sprites_3d,
          sprite_3d = flags & this.f_sprite_3d,
          nclipplanes = this.countClipplanes(),
          fixed_size = flags & this.f_fixed_size,
          is_points = flags & this.f_is_points,
          is_twosided = flags & this.f_is_twosided,
          fat_lines = flags & this.f_fat_lines,
          is_brush = flags & this.f_is_brush,
          result;

      if (type === "clipplanes" || sprites_3d) return;

      if (typeof userShader !== "undefined") return userShader;

      result = "  /* ****** "+type+" object "+id+" vertex shader ****** */\n"+
      "  attribute vec3 aPos;\n"+
      "  attribute vec4 aCol;\n"+
      " uniform mat4 mvMatrix;\n"+
      " uniform mat4 prMatrix;\n"+
      " varying vec4 vCol;\n"+
      " varying vec4 vPosition;\n";

      if ((is_lit && !fixed_quads && !is_brush) || sprite_3d)
        result = result + "  attribute vec3 aNorm;\n"+
                          " uniform mat4 normMatrix;\n"+
                          " varying vec3 vNormal;\n";

      if (has_texture || type === "text")
        result = result + " attribute vec2 aTexcoord;\n"+
                          " varying vec2 vTexcoord;\n";

      if (fixed_size)
        result = result + "  uniform vec2 textScale;\n";

      if (fixed_quads)
        result = result + "  attribute vec2 aOfs;\n";
      else if (sprite_3d)
        result = result + "  uniform vec3 uOrig;\n"+
                          "  uniform float uSize;\n"+
                          "  uniform mat4 usermat;\n";

      if (is_twosided)
        result = result + "  attribute vec3 aPos1;\n"+
                          "  attribute vec3 aPos2;\n"+
                          "  varying float normz;\n";

      if (fat_lines) {
      	result = result +   "  attribute vec3 aNext;\n"+
                            "  attribute vec2 aPoint;\n"+
                            "  varying vec2 vPoint;\n"+
                            "  varying float vLength;\n"+
                            "  uniform float uAspect;\n"+
                            "  uniform float uLwd;\n";
      }
      
      result = result + "  void main(void) {\n";

      if ((nclipplanes || (!fixed_quads && !sprite_3d)) && !is_brush)
        result = result + "    vPosition = mvMatrix * vec4(aPos, 1.);\n";

      if (!fixed_quads && !sprite_3d && !is_brush)
        result = result + "    gl_Position = prMatrix * vPosition;\n";

      if (is_points) {
        var size = this.getMaterial(id, "size");
        result = result + "    gl_PointSize = "+size.toFixed(1)+";\n";
      }

      result = result + "    vCol = aCol;\n";

      if (is_lit && !fixed_quads && !sprite_3d && !is_brush)
        result = result + "    vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);\n";

      if (has_texture || type == "text")
        result = result + "    vTexcoord = aTexcoord;\n";

      if (fixed_size)
        result = result + "    vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n"+
                          "   pos = pos/pos.w;\n"+
                          "   gl_Position = pos + vec4(aOfs*textScale, 0.,0.);\n";

      if (type == "sprites" && !fixed_size)
        result = result + "    vec4 pos = mvMatrix * vec4(aPos, 1.);\n"+
                          "   pos = pos/pos.w + vec4(aOfs, 0., 0.);\n"+
                          "   gl_Position = prMatrix*pos;\n";

      if (sprite_3d)
        result = result + "   vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);\n"+
                          "   vec4 pos = mvMatrix * vec4(uOrig, 1.);\n"+
                          "   vPosition = pos/pos.w + vec4(uSize*(vec4(aPos, 1.)*usermat).xyz,0.);\n"+
                          "   gl_Position = prMatrix * vPosition;\n";

      if (is_twosided)
        result = result + "   vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n"+
                          "   pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n"+
                          "   vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n"+
                          "   pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n"+
                          "   normz = pos1.x*pos2.y - pos1.y*pos2.x;\n";
                          
      if (fat_lines) 
        /* This code was inspired by Matt Deslauriers' code in https://mattdesl.svbtle.com/drawing-lines-is-hard */
        result = result + "   vec2 aspectVec = vec2(uAspect, 1.0);\n"+
                          "   mat4 projViewModel = prMatrix * mvMatrix;\n"+
                          "   vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n"+
                          "   currentProjected = currentProjected/currentProjected.w;\n"+
                          "   vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n"+
                          "   vec2 currentScreen = currentProjected.xy * aspectVec;\n"+
                          "   vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n"+
                          "   float len = uLwd;\n"+
                          "   vec2 dir = vec2(1.0, 0.0);\n"+
                          "   vPoint = aPoint;\n"+
                          "   vLength = length(nextScreen - currentScreen)/2.0;\n"+
                          "   vLength = vLength/(vLength + len);\n"+
                          "   if (vLength > 0.0) {\n"+
                          "     dir = normalize(nextScreen - currentScreen);\n"+
                          "   }\n"+
                          "   vec2 normal = vec2(-dir.y, dir.x);\n"+
                          "   dir.x /= uAspect;\n"+
                          "   normal.x /= uAspect;\n"+
                          "   vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n"+
                          "   gl_Position = currentProjected + offset;\n";

      if (is_brush)
        result = result + "   gl_Position = vec4(aPos, 1.);\n";
        
      result = result + "  }\n";

      // console.log(result);
      return result;
    };

    /**
     * Generate the fragment shader for an object
     * @returns {string}
     * @param { number } id - Id of object
     */
    rglwidgetClass.prototype.getFragmentShader = function(id) {
      var obj = this.getObj(id),
          userShader = obj.userFragmentShader,
          flags = obj.flags,
          type = obj.type,
          is_lit = flags & this.f_is_lit,
          has_texture = flags & this.f_has_texture,
          fixed_quads = flags & this.f_fixed_quads,
          sprites_3d = flags & this.f_sprites_3d,
          is_twosided = (flags & this.f_is_twosided) > 0,
          fat_lines = flags & this.f_fat_lines,
          is_transparent = flags & this.f_is_transparent,
          nclipplanes = this.countClipplanes(), i,
          texture_format, nlights,
          result;

      if (type === "clipplanes" || sprites_3d) return;

      if (typeof userShader !== "undefined") return userShader;

      if (has_texture)
        texture_format = this.getMaterial(id, "textype");

      result = "/* ****** "+type+" object "+id+" fragment shader ****** */\n"+
               "#ifdef GL_ES\n"+
               "#ifdef GL_FRAGMENT_PRECISION_HIGH\n"+
               "  precision highp float;\n"+
               "#else\n"+
               "  precision mediump float;\n"+
               "#endif\n"+
               "#endif\n"+
               "  varying vec4 vCol; // carries alpha\n"+
               "  varying vec4 vPosition;\n";

      if (has_texture || type === "text")
        result = result + "  varying vec2 vTexcoord;\n"+
                          " uniform sampler2D uSampler;\n";

      if (is_lit && !fixed_quads)
        result = result + "  varying vec3 vNormal;\n";

      for (i = 0; i < nclipplanes; i++)
        result = result + "  uniform vec4 vClipplane"+i+";\n";

      if (is_lit) {
        nlights = this.countLights();
        if (nlights)
            result = result + "  uniform mat4 mvMatrix;\n";
        else
            is_lit = false;
      }

      if (is_lit) {
        result = result + "   uniform vec3 emission;\n"+
                          "   uniform float shininess;\n";

        for (i=0; i < nlights; i++) {
          result = result + "   uniform vec3 ambient" + i + ";\n"+
                            "   uniform vec3 specular" + i +"; // light*material\n"+
                            "   uniform vec3 diffuse" + i + ";\n"+
                            "   uniform vec3 lightDir" + i + ";\n"+
                            "   uniform bool viewpoint" + i + ";\n"+
                            "   uniform bool finite" + i + ";\n";
        }
      }

      if (is_twosided)
        result = result + "   uniform bool front;\n"+
                          "   varying float normz;\n";
                          
      if (fat_lines)
        result = result + "   varying vec2 vPoint;\n"+
                          "   varying float vLength;\n";

      result = result + "  void main(void) {\n";
      
      if (fat_lines) {
        result = result + "    vec2 point = vPoint;\n"+
                          "    bool neg = point.y < 0.0;\n"+
                          "    point.y = neg ? "+
                          "      (point.y + vLength)/(1.0 - vLength) :\n"+
                          "     -(point.y - vLength)/(1.0 - vLength);\n";
        if (is_transparent && type == "linestrip")
          result = result+"    if (neg && length(point) <= 1.0) discard;\n";
        result = result + "    point.y = min(point.y, 0.0);\n"+
                          "    if (length(point) > 1.0) discard;\n";
      }

      for (i=0; i < nclipplanes;i++)
        result = result + "    if (dot(vPosition, vClipplane"+i+") < 0.0) discard;\n";

      if (fixed_quads) {
        result = result +   "    vec3 n = vec3(0., 0., 1.);\n";
      } else if (is_lit) {
      	result = result +   "    vec3 n = normalize(vNormal);\n";
      }

      if (is_twosided) {
      	result = result +   "    if ((normz <= 0.) != front) discard;\n";
      }

      if (is_lit) {
        result = result + "    vec3 eye = normalize(-vPosition.xyz);\n"+
                          "   vec3 lightdir;\n"+
                          "   vec4 colDiff;\n"+
                          "   vec3 halfVec;\n"+
                          "   vec4 lighteffect = vec4(emission, 0.);\n"+
                          "   vec3 col;\n"+
                          "   float nDotL;\n";
        if (!fixed_quads) {
          result = result +   "   n = -faceforward(n, n, eye);\n";
        }
        for (i=0; i < nlights; i++) {
          result = result + "   colDiff = vec4(vCol.rgb * diffuse" + i + ", vCol.a);\n"+
                            "   lightdir = lightDir" + i + ";\n"+
                            "   if (!viewpoint" + i +")\n"+
                            "     lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n"+
                            "   if (!finite" + i + ") {\n"+
                            "     halfVec = normalize(lightdir + eye);\n"+
                            "   } else {\n"+
                            "     lightdir = normalize(lightdir - vPosition.xyz);\n"+
                            "     halfVec = normalize(lightdir + eye);\n"+
                            "   }\n"+
                            "    col = ambient" + i + ";\n"+
                            "   nDotL = dot(n, lightdir);\n"+
                            "   col = col + max(nDotL, 0.) * colDiff.rgb;\n"+
                            "   col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular" + i + ";\n"+
                            "   lighteffect = lighteffect + vec4(col, colDiff.a);\n";
        }

      } else {
        result = result +   "   vec4 colDiff = vCol;\n"+
                            "    vec4 lighteffect = colDiff;\n";
      }

      if (type === "text")
        result = result +   "    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n";

      if (has_texture) {
        result = result + {
            rgb:            "   vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);\n",
            rgba:           "   vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n",
            alpha:          "   vec4 textureColor = texture2D(uSampler, vTexcoord);\n"+
                            "   float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;\n"+
                            "   textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);\n",
            luminance:      "   vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);\n",
          "luminance.alpha":"    vec4 textureColor = texture2D(uSampler, vTexcoord);\n"+
                            "   float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n"+
                            "   textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);\n"
          }[texture_format]+
                            "   gl_FragColor = textureColor;\n";
      } else if (type === "text") {
        result = result +   "    if (textureColor.a < 0.1)\n"+
                            "     discard;\n"+
                            "   else\n"+
                            "     gl_FragColor = textureColor;\n";
      } else
        result = result +   "   gl_FragColor = lighteffect;\n";

      //if (fat_lines)
      //  result = result +   "   gl_FragColor = vec4(0.0, abs(point.x), abs(point.y), 1.0);"
      result = result + "  }\n";

      // console.log(result);
      return result;
    };

    /**
     * Call gl functions to create and compile shader
     * @returns {Object}
     * @param { number } shaderType - gl code for shader type
     * @param { string } code - code for the shader
     */
    rglwidgetClass.prototype.getShader = function(shaderType, code) {
        var gl = this.gl, shader;
        shader = gl.createShader(shaderType);
        gl.shaderSource(shader, code);
        gl.compileShader(shader);
        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS) && !gl.isContextLost())
            alert(gl.getShaderInfoLog(shader));
        return shader;
    };

    /**
     * Handle a texture after its image has been loaded
     * @param { Object } texture - the gl texture object
     * @param { Object } textureCanvas - the canvas holding the image
     */
    rglwidgetClass.prototype.handleLoadedTexture = function(texture, textureCanvas) {
      var gl = this.gl || this.initGL();
      gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);

      gl.bindTexture(gl.TEXTURE_2D, texture);
      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);
      gl.generateMipmap(gl.TEXTURE_2D);

      gl.bindTexture(gl.TEXTURE_2D, null);
    };

    /**
     * Get maximum dimension of texture in current browser.
     * @returns {number}
     */
    rglwidgetClass.prototype.getMaxTexSize = function() {
      var gl = this.gl || this.initGL();	
      return Math.min(4096, gl.getParameter(gl.MAX_TEXTURE_SIZE));
    };
    
    /**
     * Load an image to a texture
     * @param { string } uri - The image location
     * @param { Object } texture - the gl texture object
     */
    rglwidgetClass.prototype.loadImageToTexture = function(uri, texture) {
      var canvas = this.textureCanvas,
          ctx = canvas.getContext("2d"),
          image = new Image(),
          self = this;

       image.onload = function() {
         var w = image.width,
             h = image.height,
             canvasX = self.getPowerOfTwo(w),
             canvasY = self.getPowerOfTwo(h),
             gl = self.gl || self.initGL(),
             maxTexSize = self.getMaxTexSize();
         while (canvasX > 1 && canvasY > 1 && (canvasX > maxTexSize || canvasY > maxTexSize)) {
           canvasX /= 2;
           canvasY /= 2;
         }
         canvas.width = canvasX;
         canvas.height = canvasY;
         ctx.imageSmoothingEnabled = true;
         ctx.drawImage(image, 0, 0, canvasX, canvasY);
         self.handleLoadedTexture(texture, canvas);
         self.drawScene();
       };
       image.src = uri;
     };

    /**
     * Draw text to the texture canvas
     * @returns { Object } object with text measurements
     * @param { string } text - the text
     * @param { number } cex - expansion
     * @param { string } family - font family
     * @param { number } font - font number
     */
    rglwidgetClass.prototype.drawTextToCanvas = function(text, cex, family, font) {
       var canvasX, canvasY,
           textY,
           scaling = 20,
           textColour = "white",

           backgroundColour = "rgba(0,0,0,0)",
           canvas = this.textureCanvas,
           ctx = canvas.getContext("2d"),
           i, textHeight = 0, textHeights = [], width, widths = [], 
           offsetx, offsety = 0, line, lines = [], offsetsx = [],
           offsetsy = [], lineoffsetsy = [], fontStrings = [],
           maxTexSize = this.getMaxTexSize(),
           getFontString = function(i) {
             textHeights[i] = scaling*cex[i];
             var fontString = textHeights[i] + "px",
                 family0 = family[i],
                 font0 = font[i];
             if (family0 === "sans")
               family0 = "sans-serif";
             else if (family0 === "mono")
               family0 = "monospace";
             fontString = fontString + " " + family0;
             if (font0 === 2 || font0 === 4)
               fontString = "bold " + fontString;
             if (font0 === 3 || font0 === 4)
               fontString = "italic " + fontString;
             return fontString;
           };
       cex = this.repeatToLen(cex, text.length);
       family = this.repeatToLen(family, text.length);
       font = this.repeatToLen(font, text.length);

       canvasX = 1;
       line = -1;
       offsetx = maxTexSize;
       for (i = 0; i < text.length; i++)  {
         ctx.font = fontStrings[i] = getFontString(i);
         width = widths[i] = ctx.measureText(text[i]).width;
         if (offsetx + width > maxTexSize) {
           line += 1;
           offsety = lineoffsetsy[line] = offsety + 2*textHeight;
           if (offsety > maxTexSize)
             console.error("Too many strings for texture.");
           textHeight = 0;
           offsetx = 0;
         }
         textHeight = Math.max(textHeight, textHeights[i]);
         offsetsx[i] = offsetx;
         offsetx += width;
         canvasX = Math.max(canvasX, offsetx);
         lines[i] = line;
       }
       offsety = lineoffsetsy[line] = offsety + 2*textHeight;
       for (i = 0; i < text.length; i++) {
       	 offsetsy[i] = lineoffsetsy[lines[i]];
       }
       
       canvasX = this.getPowerOfTwo(canvasX);
       canvasY = this.getPowerOfTwo(offsety);

       canvas.width = canvasX;
       canvas.height = canvasY;

       ctx.fillStyle = backgroundColour;
       ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);

       ctx.textBaseline = "alphabetic";
       for(i = 0; i < text.length; i++) {
         ctx.font = fontStrings[i];
         ctx.fillStyle = textColour;
         ctx.textAlign = "left";
         ctx.fillText(text[i], offsetsx[i],  offsetsy[i]);
       }
       return {canvasX:canvasX, canvasY:canvasY,
               widths:widths, textHeights:textHeights,
               offsetsx:offsetsx, offsetsy:offsetsy};
     };

    /**
     * Set the gl viewport and scissor test
     * @param { number } id - id of subscene
     */
    rglwidgetClass.prototype.setViewport = function(id) {
       var gl = this.gl || this.initGL(),
         vp = this.getObj(id).par3d.viewport,
         x = vp.x*this.canvas.width,
         y = vp.y*this.canvas.height,
         width = vp.width*this.canvas.width,
         height = vp.height*this.canvas.height;
       this.vp = {x:x, y:y, width:width, height:height};
       gl.viewport(x, y, width, height);
       gl.scissor(x, y, width, height);
       gl.enable(gl.SCISSOR_TEST);
     };

    /**
     * Set the projection matrix for a subscene
     * @param { number } id - id of subscene
     */
    rglwidgetClass.prototype.setprMatrix = function(id) {
       var subscene = this.getObj(id),
          embedding = subscene.embeddings.projection;
       if (embedding === "replace")
         this.prMatrix.makeIdentity();
       else
         this.setprMatrix(subscene.parent);
       if (embedding === "inherit")
         return;
       // This is based on the Frustum::enclose code from geom.cpp
       var bbox = subscene.par3d.bbox,
           scale = subscene.par3d.scale,
           ranges = [(bbox[1]-bbox[0])*scale[0]/2,
                     (bbox[3]-bbox[2])*scale[1]/2,
                     (bbox[5]-bbox[4])*scale[2]/2],
           radius = Math.sqrt(this.sumsq(ranges))*1.1; // A bit bigger to handle labels
       if (radius <= 0) radius = 1;
       var observer = subscene.par3d.observer,
           distance = observer[2],
           FOV = subscene.par3d.FOV, ortho = FOV === 0,
           t = ortho ? 1 : Math.tan(FOV*Math.PI/360),
           near = distance - radius,
           far = distance + radius,
           hlen,
           aspect = this.vp.width/this.vp.height,
           z = subscene.par3d.zoom,
           userProjection = subscene.par3d.userProjection;
       if (far < 0.0)
         far = 1.0;
       if (near < far/100.0)
         near = far/100.0;
       hlen = t*near;
       if (ortho) {
         if (aspect > 1)
           this.prMatrix.ortho(-hlen*aspect*z, hlen*aspect*z,
                          -hlen*z, hlen*z, near, far);
         else
           this.prMatrix.ortho(-hlen*z, hlen*z,
                          -hlen*z/aspect, hlen*z/aspect,
                          near, far);
       } else {
         if (aspect > 1)
           this.prMatrix.frustum(-hlen*aspect*z, hlen*aspect*z,
                          -hlen*z, hlen*z, near, far);
         else
           this.prMatrix.frustum(-hlen*z, hlen*z,
                          -hlen*z/aspect, hlen*z/aspect,
                          near, far);
       }
       this.prMatrix.multRight(userProjection);
     };

    /**
     * Set the model-view matrix for a subscene
     * @param { number } id - id of the subscene
     */
    rglwidgetClass.prototype.setmvMatrix = function(id) {
       var observer = this.getObj(id).par3d.observer;
       this.mvMatrix.makeIdentity();
       this.setmodelMatrix(id);
       this.mvMatrix.translate(-observer[0], -observer[1], -observer[2]);

     };

    /**
     * Set the model matrix for a subscene
     * @param { number } id - id of the subscene
     */
    rglwidgetClass.prototype.setmodelMatrix = function(id) {
      var subscene = this.getObj(id),
          embedding = subscene.embeddings.model;
      if (embedding !== "inherit") {
        var scale = subscene.par3d.scale,
            bbox = subscene.par3d.bbox,
            center = [(bbox[0]+bbox[1])/2,
                      (bbox[2]+bbox[3])/2,
                      (bbox[4]+bbox[5])/2];
         this.mvMatrix.translate(-center[0], -center[1], -center[2]);
         this.mvMatrix.scale(scale[0], scale[1], scale[2]);
         this.mvMatrix.multRight( subscene.par3d.userMatrix );
       }
       if (embedding !== "replace")
         this.setmodelMatrix(subscene.parent);
     };

    /**
     * Set the normals matrix for a subscene
     * @param { number } subsceneid - id of the subscene
     */
    rglwidgetClass.prototype.setnormMatrix = function(subsceneid) {
       var self = this,
       recurse = function(id) {
         var sub = self.getObj(id),
             embedding = sub.embeddings.model;
         if (embedding !== "inherit") {
           var scale = sub.par3d.scale;
           self.normMatrix.scale(1/scale[0], 1/scale[1], 1/scale[2]);
           self.normMatrix.multRight(sub.par3d.userMatrix);
         }
         if (embedding !== "replace")
           recurse(sub.parent);
       };
       self.normMatrix.makeIdentity();
       recurse(subsceneid);
     };

    /**
     * Set the combined projection-model-view matrix
     */
    rglwidgetClass.prototype.setprmvMatrix = function() {
       this.prmvMatrix = new CanvasMatrix4( this.mvMatrix );
       this.prmvMatrix.multRight( this.prMatrix );
     };

    /**
     * Count clipping planes in a scene
     * @returns {number}
     */
    rglwidgetClass.prototype.countClipplanes = function() {
      return this.countObjs("clipplanes");
    };

    /**
     * Count lights in a scene
     * @returns { number }
     */
    rglwidgetClass.prototype.countLights = function() {
      return this.countObjs("light");
    };

    /**
     * Count objects of specific type in a scene
     * @returns { number }
     * @param { string } type - Type of object to count
     */
    rglwidgetClass.prototype.countObjs = function(type) {
      var self = this,
          bound = 0;

      Object.keys(this.scene.objects).forEach(
        function(key) {
          if (self.getObj(parseInt(key, 10)).type === type)
            bound = bound + 1;
        });
      return bound;
    };

    /**
     * Initialize a subscene
     * @param { number } id - id of subscene.
     */
    rglwidgetClass.prototype.initSubscene = function(id) {
      var sub = this.getObj(id),
          i, obj;

      if (sub.type !== "subscene")
        return;

      sub.par3d.userMatrix = this.toCanvasMatrix4(sub.par3d.userMatrix);
      sub.par3d.userProjection = this.toCanvasMatrix4(sub.par3d.userProjection);
      sub.par3d.userProjection.transpose();
      sub.par3d.listeners = [].concat(sub.par3d.listeners);
      sub.backgroundId = undefined;
      sub.subscenes = [];
      sub.clipplanes = [];
      sub.transparent = [];
      sub.opaque = [];
      sub.lights = [];
      for (i=0; i < sub.objects.length; i++) {
        obj = this.getObj(sub.objects[i]);
        if (typeof obj === "undefined") {
          sub.objects.splice(i, 1);
          i--;
        } else if (obj.type === "background")
          sub.backgroundId = obj.id;
        else
          sub[this.whichList(obj.id)].push(obj.id);
      }
    };

    /**
     * Copy object
     * @param { number } id - id of object to copy
     * @param { string } reuse - Document id of scene to reuse
     */
    rglwidgetClass.prototype.copyObj = function(id, reuse) {
      var obj = this.getObj(id),
          prev = document.getElementById(reuse);
      if (prev !== null) {
        prev = prev.rglinstance;
        var
          prevobj = prev.getObj(id),
          fields = ["flags", "type",
                    "colors", "vertices", "centers",
                    "normals", "offsets",
                    "texts", "cex", "family", "font", "adj",
                    "material",
                    "radii",
                    "texcoords",
                    "userMatrix", "ids",
                    "dim",
                    "par3d", "userMatrix",
                    "viewpoint", "finite",
                    "pos"],
          i;
        for (i = 0; i < fields.length; i++) {
          if (typeof prevobj[fields[i]] !== "undefined")
            obj[fields[i]] = prevobj[fields[i]];
        }
      } else
        console.warn("copyObj failed");
    };

    /**
     * Update the triangles used to display a plane
     * @param { number } id - id of the plane
     * @param { Object } bbox - bounding box in which to display the plane
     */
    rglwidgetClass.prototype.planeUpdateTriangles = function(id, bbox) {
      var perms = [[0,0,1], [1,2,2], [2,1,0]],
          x, xrow, elem, A, d, nhits, i, j, k, u, v, w, intersect, which, v0, v2, vx, reverse,
          face1 = [], face2 = [], normals = [],
          obj = this.getObj(id),
          nPlanes = obj.normals.length;
      obj.bbox = bbox;
      obj.vertices = [];
      obj.initialized = false;
      for (elem = 0; elem < nPlanes; elem++) {
//    Vertex Av = normal.getRecycled(elem);
        x = [];
        A = obj.normals[elem];
        d = obj.offsets[elem][0];
        nhits = 0;
        for (i=0; i<3; i++)
          for (j=0; j<2; j++)
            for (k=0; k<2; k++) {
              u = perms[0][i];
              v = perms[1][i];
              w = perms[2][i];
              if (A[w] !== 0.0) {
                intersect = -(d + A[u]*bbox[j+2*u] + A[v]*bbox[k+2*v])/A[w];
                if (bbox[2*w] < intersect && intersect < bbox[1+2*w]) {
                  xrow = [];
                  xrow[u] = bbox[j+2*u];
                  xrow[v] = bbox[k+2*v];
                  xrow[w] = intersect;
                  x.push(xrow);
                  face1[nhits] = j + 2*u;
                  face2[nhits] = k + 2*v;
                  nhits++;
                }
              }
            }

            if (nhits > 3) {
            /* Re-order the intersections so the triangles work */
              for (i=0; i<nhits-2; i++) {
                which = 0; /* initialize to suppress warning */
                for (j=i+1; j<nhits; j++) {
                  if (face1[i] == face1[j] || face1[i] == face2[j] ||
                      face2[i] == face1[j] || face2[i] == face2[j] ) {
                    which = j;
                    break;
                  }
                }
                if (which > i+1) {
                  this.swap(x, i+1, which);
                  this.swap(face1, i+1, which);
                  this.swap(face2, i+1, which);
                }
              }
            }
            if (nhits >= 3) {
      /* Put in order so that the normal points out the FRONT of the faces */
              v0 = [x[0][0] - x[1][0] , x[0][1] - x[1][1], x[0][2] - x[1][2]];
              v2 = [x[2][0] - x[1][0] , x[2][1] - x[1][1], x[2][2] - x[1][2]];
              /* cross-product */
              vx = this.xprod(v0, v2);
              reverse = this.dotprod(vx, A) > 0;

              for (i=0; i<nhits-2; i++) {
                obj.vertices.push(x[0]);
                normals.push(A);
                for (j=1; j<3; j++) {
                  obj.vertices.push(x[i + (reverse ? 3-j : j)]);
                  normals.push(A);
                }
              }
            }
      }
      obj.pnormals = normals;
    };
    
    rglwidgetClass.prototype.getAdj = function (pos, offset, text) {
      switch(pos) {
        case 1: return [0.5, 1 + offset];
        case 2: return [1 + offset/text.length, 0.5];
        case 3: return [0.5, -offset];
        case 4: return [-offset/text.length, 0.5];
      }
    }

    /**
     * Initialize object for display
     * @param { number } id - id of object to initialize
     */
    rglwidgetClass.prototype.initObj = function(id) {
      var obj = this.getObj(id),
          flags = obj.flags,
          type = obj.type,
          is_lit = flags & this.f_is_lit,
          is_lines = flags & this.f_is_lines,
          fat_lines = flags & this.f_fat_lines,
          has_texture = flags & this.f_has_texture,
          fixed_quads = flags & this.f_fixed_quads,
          is_transparent = obj.is_transparent,
          depth_sort = flags & this.f_depth_sort,
          sprites_3d = flags & this.f_sprites_3d,
          sprite_3d = flags & this.f_sprite_3d,
          fixed_size = flags & this.f_fixed_size,
          is_twosided = (flags & this.f_is_twosided) > 0,
          is_brush = flags & this.f_is_brush,
          gl = this.gl || this.initGL(),
          polygon_offset,
          texinfo, drawtype, nclipplanes, f, nrows, oldrows,
          i,j,v,v1,v2, mat, uri, matobj, pass, passes, pmode,
          dim, nx, nz, attr;

    if (typeof id !== "number") {
      this.alertOnce("initObj id is "+typeof id);
    }

    obj.initialized = true;

    if (type === "bboxdeco" || type === "subscene")
      return;

    if (type === "light") {
      obj.ambient = new Float32Array(obj.colors[0].slice(0,3));
      obj.diffuse = new Float32Array(obj.colors[1].slice(0,3));
      obj.specular = new Float32Array(obj.colors[2].slice(0,3));
      obj.lightDir = new Float32Array(obj.vertices[0]);
      return;
    }

    if (type === "clipplanes") {
      obj.vClipplane = this.flatten(this.cbind(obj.normals, obj.offsets));
      return;
    }

    if (type === "background" && typeof obj.ids !== "undefined") {
      obj.quad = this.flatten([].concat(obj.ids));
      return;
    }

    polygon_offset = this.getMaterial(id, "polygon_offset");
    if (polygon_offset[0] != 0 || polygon_offset[1] != 0)
      obj.polygon_offset = polygon_offset;

    if (is_transparent) {
      depth_sort = ["triangles", "quads", "surface",
                    "spheres", "sprites", "text"].indexOf(type) >= 0;
    }
    
    if (is_brush)
      this.initSelection(id);

    if (typeof obj.vertices === "undefined")
      obj.vertices = [];

    v = obj.vertices;
    obj.vertexCount = v.length;
    if (!obj.vertexCount) return;

    if (is_twosided) {
      if (typeof obj.userAttributes === "undefined")
        obj.userAttributes = {};
      v1 = Array(v.length);
      v2 = Array(v.length);
      if (obj.type == "triangles" || obj.type == "quads") {
      	if (obj.type == "triangles")
      	  nrow = 3;
      	else
      	  nrow = 4;
        for (i=0; i<Math.floor(v.length/nrow); i++)
          for (j=0; j<nrow; j++) {
            v1[nrow*i + j] = v[nrow*i + ((j+1) % nrow)];
            v2[nrow*i + j] = v[nrow*i + ((j+2) % nrow)];
          }
      } else if (obj.type == "surface") {
        dim = obj.dim[0];
        nx = dim[0];
        nz = dim[1];
        for (j=0; j<nx; j++) {
          for (i=0; i<nz; i++) {
            if (i+1 < nz && j+1 < nx) {
              v2[j + nx*i] = v[j + nx*(i+1)];
              v1[j + nx*i] = v[j+1 + nx*(i+1)];
            } else if (i+1 < nz) {
              v2[j + nx*i] = v[j-1 + nx*i];
              v1[j + nx*i] = v[j + nx*(i+1)];
            } else {
              v2[j + nx*i] = v[j + nx*(i-1)];
              v1[j + nx*i] = v[j-1 + nx*(i-1)];
            }
          }
        }
      }
      obj.userAttributes.aPos1 = v1;
      obj.userAttributes.aPos2 = v2;
    }

    if (!sprites_3d) {
      if (gl.isContextLost()) return;
      obj.prog = gl.createProgram();
      gl.attachShader(obj.prog, this.getShader( gl.VERTEX_SHADER,
        this.getVertexShader(id) ));
      gl.attachShader(obj.prog, this.getShader( gl.FRAGMENT_SHADER,
                      this.getFragmentShader(id) ));
      //  Force aPos to location 0, aCol to location 1
      gl.bindAttribLocation(obj.prog, 0, "aPos");
      gl.bindAttribLocation(obj.prog, 1, "aCol");
      gl.linkProgram(obj.prog);
      var linked = gl.getProgramParameter(obj.prog, gl.LINK_STATUS);
      if (!linked) {

        // An error occurred while linking
        var lastError = gl.getProgramInfoLog(obj.prog);
        console.warn("Error in program linking:" + lastError);

        gl.deleteProgram(obj.prog);
        return;
      }
    }

    if (type === "text") {
      texinfo = this.drawTextToCanvas(obj.texts,
                                      this.flatten(obj.cex),
                                      this.flatten(obj.family),
                                      this.flatten(obj.family));
    }

    if (fixed_quads && !sprites_3d) {
      obj.ofsLoc = gl.getAttribLocation(obj.prog, "aOfs");
    }

    if (sprite_3d) {
      obj.origLoc = gl.getUniformLocation(obj.prog, "uOrig");
      obj.sizeLoc = gl.getUniformLocation(obj.prog, "uSize");
      obj.usermatLoc = gl.getUniformLocation(obj.prog, "usermat");
    }

    if (has_texture || type == "text") {
      if (!obj.texture)
        obj.texture = gl.createTexture();
      obj.texLoc = gl.getAttribLocation(obj.prog, "aTexcoord");
      obj.sampler = gl.getUniformLocation(obj.prog, "uSampler");
    }

    if (has_texture) {
      mat = obj.material;
      if (typeof mat.uri !== "undefined")
        uri = mat.uri;
      else if (typeof mat.uriElementId === "undefined") {
        matobj = this.getObj(mat.uriId);
        if (typeof matobj !== "undefined") {
          uri = matobj.material.uri;
        } else {
          uri = "";
        }
      } else
        uri = document.getElementById(mat.uriElementId).rglinstance.getObj(mat.uriId).material.uri;

      this.loadImageToTexture(uri, obj.texture);
    }

    if (type === "text") {
      this.handleLoadedTexture(obj.texture, this.textureCanvas);
    }

    var stride = 3, nc, cofs, nofs, radofs, oofs, tofs, vnew, fnew,
        nextofs = -1, pointofs = -1, alias, colors, key, selection, filter, adj, pos, offset;

    obj.alias = undefined;
    
    colors = obj.colors;

    j = this.scene.crosstalk.id.indexOf(id);
    if (j >= 0) {
      key = this.scene.crosstalk.key[j];
      options = this.scene.crosstalk.options[j];
      colors = colors.slice(0); 
      for (i = 0; i < v.length; i++)
        colors[i] = obj.colors[i % obj.colors.length].slice(0);
      if ( (selection = this.scene.crosstalk.selection) &&
           (selection.length || !options.selectedIgnoreNone) )
        for (i = 0; i < v.length; i++) {
          if (!selection.includes(key[i])) {
            if (options.deselectedColor)
              colors[i] = options.deselectedColor.slice(0);
            colors[i][3] = colors[i][3]*options.deselectedFade;   /* default: mostly transparent if not selected */
          } else if (options.selectedColor)
            colors[i] = options.selectedColor.slice(0);
        }
      if ( (filter = this.scene.crosstalk.filter) )
        for (i = 0; i < v.length; i++) 
          if (!filter.includes(key[i])) {
            if (options.filteredColor)
              colors[i] = options.filteredColor.slice(0);
            colors[i][3] = colors[i][3]*options.filteredFade;   /* default: completely hidden if filtered */
          }
    }  
    
    nc = obj.colorCount = colors.length;
    if (nc > 1) {
      cofs = stride;
      stride = stride + 4;
      v = this.cbind(v, colors);
    } else {
      cofs = -1;
      obj.onecolor = this.flatten(colors);
    }

    if (typeof obj.normals !== "undefined") {
      nofs = stride;
      stride = stride + 3;
      v = this.cbind(v, typeof obj.pnormals !== "undefined" ? obj.pnormals : obj.normals);
    } else
      nofs = -1;

    if (typeof obj.radii !== "undefined") {
      radofs = stride;
      stride = stride + 1;
      // FIXME:  always concat the radii?
      if (obj.radii.length === v.length) {
        v = this.cbind(v, obj.radii);
      } else if (obj.radii.length === 1) {
        v = v.map(function(row, i, arr) { return row.concat(obj.radii[0]);});
      }
    } else
      radofs = -1;
      
    // Add default indices
    f = Array(v.length);
    for (i = 0; i < v.length; i++)
      f[i] = i;
    obj.f = [f,f];

    if (type == "sprites" && !sprites_3d) {
      tofs = stride;
      stride += 2;
      oofs = stride;
      stride += 2;
      vnew = new Array(4*v.length);
      fnew = new Array(4*v.length);
      alias = new Array(v.length);
      var rescale = fixed_size ? 72 : 1,
          size = obj.radii, s = rescale*size[0]/2;
      last = v.length;
      f = obj.f[0];
      for (i=0; i < v.length; i++) {
        if (size.length > 1)
          s = rescale*size[i]/2;
        vnew[i]  = v[i].concat([0,0,-s,-s]);
        fnew[4*i] = f[i];
        vnew[last]= v[i].concat([1,0, s,-s]);
        fnew[4*i+1] = last++;
        vnew[last]= v[i].concat([1,1, s, s]);
        fnew[4*i+2] = last++;
        vnew[last]= v[i].concat([0,1,-s, s]);
        fnew[4*i+3] = last++;
        alias[i] = [last-3, last-2, last-1];
      }
      v = vnew;
      obj.vertexCount = v.length;
      obj.f = [fnew, fnew];
    } else if (type === "text") {
      tofs = stride;
      stride += 2;
      oofs = stride;
      stride += 2;
      vnew = new Array(4*v.length);
      f = obj.f[0];
      fnew = new Array(4*f.length);
      alias = new Array(v.length);
      last = v.length;
      adj = this.flatten(obj.adj);
      if (typeof obj.pos !== "undefined") {
        pos = this.flatten(obj.pos);
        offset = adj[0];
      }
      for (i=0; i < v.length; i++) {
        if (typeof pos !== "undefined")
          adj = this.getAdj(pos[i % pos.length], offset, obj.texts[i]);
        vnew[i]  = v[i].concat([0,-0.5]).concat(adj);
        fnew[4*i] = f[i];
        vnew[last] = v[i].concat([1,-0.5]).concat(adj);
        fnew[4*i+1] = last++;
        vnew[last] = v[i].concat([1, 1.5]).concat(adj);
        fnew[4*i+2] = last++;
        vnew[last] = v[i].concat([0, 1.5]).concat(adj);
        fnew[4*i+3] = last++;
        alias[i] = [last-3, last-2, last-1];
        for (j=0; j < 4; j++) {
          v1 = vnew[fnew[4*i+j]];
          v1[tofs+2] = 2*(v1[tofs]-v1[tofs+2])*texinfo.widths[i];
          v1[tofs+3] = 2*(v1[tofs+1]-v1[tofs+3])*texinfo.textHeights[i];
          v1[tofs] = (texinfo.offsetsx[i] + v1[tofs]*texinfo.widths[i])/texinfo.canvasX;
          v1[tofs+1] = 1.0-(texinfo.offsetsy[i] -
              v1[tofs+1]*texinfo.textHeights[i])/texinfo.canvasY;
          vnew[fnew[4*i+j]] = v1;
        }
      }
      v = vnew;
      obj.vertexCount = v.length;
      obj.f = [fnew, fnew];
    } else if (typeof obj.texcoords !== "undefined") {
      tofs = stride;
      stride += 2;
      oofs = -1;
      v = this.cbind(v, obj.texcoords);
    } else {
      tofs = -1;
      oofs = -1;
    }
    
    obj.alias = alias;
                          
    if (typeof obj.userAttributes !== "undefined") {
      obj.userAttribOffsets = {};
      obj.userAttribLocations = {};
      obj.userAttribSizes = {};
      for (attr in obj.userAttributes) {
      	obj.userAttribLocations[attr] = gl.getAttribLocation(obj.prog, attr);
      	if (obj.userAttribLocations[attr] >= 0) { // Attribute may not have been used
      	  obj.userAttribOffsets[attr] = stride;
      	  v = this.cbind(v, obj.userAttributes[attr]);
      	  stride = v[0].length;
      	  obj.userAttribSizes[attr] = stride - obj.userAttribOffsets[attr];
      	}
      }
    }

    if (typeof obj.userUniforms !== "undefined") {
      obj.userUniformLocations = {};
      for (attr in obj.userUniforms)
        obj.userUniformLocations[attr] = gl.getUniformLocation(obj.prog, attr);
    }

    if (sprites_3d) {
      obj.userMatrix = new CanvasMatrix4(obj.userMatrix);
      obj.objects = this.flatten([].concat(obj.ids));
      is_lit = false;
      for (i=0; i < obj.objects.length; i++)
        this.initObj(obj.objects[i]);
    }

    if (is_lit && !fixed_quads) {
       obj.normLoc = gl.getAttribLocation(obj.prog, "aNorm");
    }

    nclipplanes = this.countClipplanes();
    if (nclipplanes && !sprites_3d) {
      obj.clipLoc = [];
      for (i=0; i < nclipplanes; i++)
        obj.clipLoc[i] = gl.getUniformLocation(obj.prog,"vClipplane" + i);
    }

    if (is_lit) {
      obj.emissionLoc = gl.getUniformLocation(obj.prog, "emission");
      obj.emission = new Float32Array(this.stringToRgb(this.getMaterial(id, "emission")));
      obj.shininessLoc = gl.getUniformLocation(obj.prog, "shininess");
      obj.shininess = this.getMaterial(id, "shininess");
      obj.nlights = this.countLights();
      obj.ambientLoc = [];
      obj.ambient = new Float32Array(this.stringToRgb(this.getMaterial(id, "ambient")));
      obj.specularLoc = [];
      obj.specular = new Float32Array(this.stringToRgb(this.getMaterial(id, "specular")));
      obj.diffuseLoc = [];
      obj.lightDirLoc = [];
      obj.viewpointLoc = [];
      obj.finiteLoc = [];
      for (i=0; i < obj.nlights; i++) {
        obj.ambientLoc[i] = gl.getUniformLocation(obj.prog, "ambient" + i);
        obj.specularLoc[i] = gl.getUniformLocation(obj.prog, "specular" + i);
        obj.diffuseLoc[i] = gl.getUniformLocation(obj.prog, "diffuse" + i);
        obj.lightDirLoc[i] = gl.getUniformLocation(obj.prog, "lightDir" + i);
        obj.viewpointLoc[i] = gl.getUniformLocation(obj.prog, "viewpoint" + i);
        obj.finiteLoc[i] = gl.getUniformLocation(obj.prog, "finite" + i);
      }
    }
    
    obj.passes = is_twosided + 1;
    obj.pmode = new Array(obj.passes);
    for (pass = 0; pass < obj.passes; pass++) {
      if (type === "triangles" || type === "quads" || type === "surface")
      	pmode = this.getMaterial(id, (pass === 0) ? "front" : "back");
      else pmode = "filled";
      obj.pmode[pass] = pmode;
    }
    
 
      obj.f.length = obj.passes;
      for (pass = 0; pass < obj.passes; pass++) {
      	f = fnew = obj.f[pass];
        pmode = obj.pmode[pass];
      	if (pmode === "culled")
      	  f = [];
        else if (pmode === "points") {
          // stay with default
        } else if ((type === "quads" || type === "text" ||
             type === "sprites") && !sprites_3d) {
          nrows = Math.floor(obj.vertexCount/4);
          if (pmode === "filled") {
            fnew = Array(6*nrows);
            for (i=0; i < nrows; i++) {
              fnew[6*i] = f[4*i];
              fnew[6*i+1] = f[4*i + 1];
              fnew[6*i+2] = f[4*i + 2];
              fnew[6*i+3] = f[4*i];
              fnew[6*i+4] = f[4*i + 2];
              fnew[6*i+5] = f[4*i + 3];
            }
          } else {
            fnew = Array(8*nrows);
            for (i=0; i < nrows; i++) {
              fnew[8*i] = f[4*i];
              fnew[8*i+1] = f[4*i + 1];
              fnew[8*i+2] = f[4*i + 1];
              fnew[8*i+3] = f[4*i + 2];
              fnew[8*i+4] = f[4*i + 2];
              fnew[8*i+5] = f[4*i + 3];
              fnew[8*i+6] = f[4*i + 3];
              fnew[8*i+7] = f[4*i];
            }
          }
        } else if (type === "triangles") {
          nrows = Math.floor(obj.vertexCount/3);
          if (pmode === "filled") {
            fnew = Array(3*nrows);
            for (i=0; i < fnew.length; i++) {
              fnew[i] = f[i];
            }
          } else if (pmode === "lines") {
            fnew = Array(6*nrows);
      	    for (i=0; i < nrows; i++) {
      	      fnew[6*i] = f[3*i];
      	      fnew[6*i + 1] = f[3*i + 1];
      	      fnew[6*i + 2] = f[3*i + 1];
      	      fnew[6*i + 3] = f[3*i + 2];
      	      fnew[6*i + 4] = f[3*i + 2];
      	      fnew[6*i + 5] = f[3*i];
      	    }
          }
        } else if (type === "spheres") {
          // default
        } else if (type === "surface") {
          dim = obj.dim[0];
          nx = dim[0];
          nz = dim[1];
          if (pmode === "filled") {
            fnew = [];
            for (j=0; j<nx-1; j++) {
              for (i=0; i<nz-1; i++) {
                fnew.push(f[j + nx*i],
                       f[j + nx*(i+1)],
                       f[j + 1 + nx*(i+1)],
                       f[j + nx*i],
                       f[j + 1 + nx*(i+1)],
                       f[j + 1 + nx*i]);
              }
            }
          } else if (pmode === "lines") {
            fnew = [];
            for (j=0; j<nx; j++) {
              for (i=0; i<nz; i++) {
                if (i+1 < nz)
                  fnew.push(f[j + nx*i],
                         f[j + nx*(i+1)]);
                if (j+1 < nx)
                  fnew.push(f[j + nx*i],
                         f[j+1 + nx*i]);
              }
            }
          }
        }
        obj.f[pass] = fnew;
        if (depth_sort) {
          drawtype = "DYNAMIC_DRAW";
        } else {
          drawtype = "STATIC_DRAW";
        }
      }
    
    
    if (fat_lines) {
      alias = undefined;
      obj.nextLoc = gl.getAttribLocation(obj.prog, "aNext");
      obj.pointLoc = gl.getAttribLocation(obj.prog, "aPoint");
      obj.aspectLoc = gl.getUniformLocation(obj.prog, "uAspect");
      obj.lwdLoc = gl.getUniformLocation(obj.prog, "uLwd");
      // Expand vertices to turn each segment into a pair of triangles
        
      	for (pass = 0; pass < obj.passes; pass++) {
      	  f = obj.f[pass];	
          oldrows = f.length;
      	  if (obj.pmode[pass] === "lines") 
      	    break;
      	}
      
      if (type === "linestrip") 
        nrows = 4*(oldrows - 1); 
      else
        nrows = 2*oldrows;
      vnew = new Array(nrows);
      fnew = new Array(1.5*nrows);
      var fnext = new Array(nrows),
          fpt = new Array(nrows), 
          pt, start, gap = type === "linestrip" ? 3 : 1;
      
      // We're going to turn each pair of vertices into 4 new ones, with the "next" and "pt" attributes
      // added.
      // We do this by copying the originals in the first pass, adding the new attributes, then in a 
      // second pass add new vertices at the end.

      for (i = 0; i < v.length; i++) {
        vnew[i] = v[i].concat([0,0,0,0,0]); 
      }

      nextofs = stride;
      pointofs = stride + 3;
      stride = stride + 5;
            
      // Now add the extras
      last = v.length - 1;
      ind = 0;
      alias = new Array(f.length);
      for (i = 0; i < f.length; i++)
        alias[i] = [];
      for (i = 0; i < f.length - 1; i++) {
      	if (type !== "linestrip" && i % 2 == 1)
      	  continue;
      	k = ++last;
      	vnew[k] = vnew[f[i]].slice();
      	for (j=0; j<3; j++)
      	  vnew[k][nextofs + j] = vnew[f[i+1]][j];
      	vnew[k][pointofs] = -1;
      	vnew[k][pointofs+1] = -1;
      	fnew[ind] = k;
      	last++;
      	vnew[last] = vnew[k].slice();
      	vnew[last][pointofs] = 1;
      	fnew[ind+1] = last;
      	alias[f[i]].push(last-1, last);
      	last++;
      	k = last;
      	vnew[k] = vnew[f[i+1]].slice();
      	for (j=0; j<3; j++)
      	  vnew[k][nextofs + j] = vnew[f[i]][j];
      	vnew[k][pointofs] = -1;
      	vnew[k][pointofs+1] = 1;
      	fnew[ind+2] = k;
      	fnew[ind+3] = fnew[ind+1];
      	last++;
      	vnew[last] = vnew[k].slice();
      	vnew[last][pointofs] = 1;
      	fnew[ind+4] = last;
      	fnew[ind+5] = fnew[ind+2];
      	ind += 6;
      	alias[f[i+1]].push(last-1, last);
      }
      vnew.length = last+1;
      v = vnew;
      obj.vertexCount = v.length;
      if (typeof alias !== "undefined" && typeof obj.alias !== "undefined") {  // Already have aliases from previous section?
        var oldalias = obj.alias, newalias = Array(obj.alias.length);
        for (i = 0; i < newalias.length; i++) {
          newalias[i] = oldalias[i].slice();
          for (j = 0; j < oldalias[i].length; j++)
            Array.prototype.push.apply(newalias[i], alias[oldalias[j]]); // pushes each element 
        }
        obj.alias = newalias;
      } else
        obj.alias = alias;
      
      for (pass = 0; pass < obj.passes; pass++)
      	if (type === "lines" || type === "linestrip" || obj.pmode[pass] == "lines") {
          obj.f[pass] = fnew;
        }
      
      if (depth_sort) 
        drawtype = "DYNAMIC_DRAW";
      else
        drawtype = "STATIC_DRAW";
    }
    
      for (pass = 0; pass < obj.passes; pass++) {
        if (obj.vertexCount > 65535) {
          if (this.index_uint) {
            obj.f[pass] = new Uint32Array(obj.f[pass]);
            obj.index_uint = true;
          } else
            this.alertOnce("Object has "+obj.vertexCount+" vertices, not supported in this browser.");
        } else {
          obj.f[pass] = new Uint16Array(obj.f[pass]);
          obj.index_uint = false;
        }
      }
    
    if (stride !== v[0].length) {
      this.alertOnce("problem in stride calculation");
    }

    obj.vOffsets = {vofs:0, cofs:cofs, nofs:nofs, radofs:radofs, oofs:oofs, tofs:tofs,
                    nextofs:nextofs, pointofs:pointofs, stride:stride};

    obj.values = new Float32Array(this.flatten(v));

    if (type !== "spheres" && !sprites_3d) {
      obj.buf = gl.createBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
      gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW); //
      obj.ibuf = Array(obj.passes);
      obj.ibuf[0] = gl.createBuffer();
      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[0]);
      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, obj.f[0], gl[drawtype]);
      if (is_twosided) {
      	obj.ibuf[1] = gl.createBuffer();
      	gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[1]);
      	gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, obj.f[1], gl[drawtype]);
      }
    }

    if (!sprites_3d) {
      obj.mvMatLoc = gl.getUniformLocation(obj.prog, "mvMatrix");
      obj.prMatLoc = gl.getUniformLocation(obj.prog, "prMatrix");
    }

    if (fixed_size) {
      obj.textScaleLoc = gl.getUniformLocation(obj.prog, "textScale");
    }

    if (is_lit && !sprites_3d) {
      obj.normMatLoc = gl.getUniformLocation(obj.prog, "normMatrix");
    }

    if (is_twosided) {
      obj.frontLoc = gl.getUniformLocation(obj.prog, "front");
    }
  };

    /**
     * Set gl depth test based on object's material
     * @param { number } id - object to use
     */
    rglwidgetClass.prototype.setDepthTest = function(id) {
      var gl = this.gl || this.initGL(),
          tests = {never: gl.NEVER,
                   less:  gl.LESS,
                   equal: gl.EQUAL,
                   lequal:gl.LEQUAL,
                   greater: gl.GREATER,
                   notequal: gl.NOTEQUAL,
                   gequal: gl.GEQUAL,
                   always: gl.ALWAYS},
           test = tests[this.getMaterial(id, "depth_test")];
      gl.depthFunc(test);
    };

    rglwidgetClass.prototype.mode4type = {points : "POINTS",
                     linestrip : "LINE_STRIP",
                     abclines : "LINES",
                     lines : "LINES",
                     sprites : "TRIANGLES",
                     planes : "TRIANGLES",
                     text : "TRIANGLES",
                     quads : "TRIANGLES",
                     surface : "TRIANGLES",
                     triangles : "TRIANGLES"};

    /**
     * Sort objects from back to front
     * @returns { number[] }
     * @param { Object } obj - object to sort
     */
    rglwidgetClass.prototype.depthSort = function(obj) {
      var n = obj.centers.length,
          depths = new Float32Array(n),
          result = new Array(n),
          compare = function(i,j) { return depths[j] - depths[i]; },
          z, w;
      for(i=0; i<n; i++) {
        z = this.prmvMatrix.m13*obj.centers[i][0] +
            this.prmvMatrix.m23*obj.centers[i][1] +
            this.prmvMatrix.m33*obj.centers[i][2] +
            this.prmvMatrix.m43;
        w = this.prmvMatrix.m14*obj.centers[i][0] +
            this.prmvMatrix.m24*obj.centers[i][1] +
            this.prmvMatrix.m34*obj.centers[i][2] +
            this.prmvMatrix.m44;
        depths[i] = z/w;
        result[i] = i;
      }
      result.sort(compare);
      return result;
    };
    
    rglwidgetClass.prototype.disableArrays = function(obj, enabled) {
      var gl = this.gl || this.initGL(),
          objLocs = ["normLoc", "texLoc", "ofsLoc", "pointLoc", "nextLoc"],
          thisLocs = ["posLoc", "colLoc"], i, attr;
      for (i = 0; i < objLocs.length; i++) 
        if (enabled[objLocs[i]]) gl.disableVertexAttribArray(obj[objLocs[i]]);
      for (i = 0; i < thisLocs.length; i++)
        if (enabled[thisLocs[i]]) gl.disableVertexAttribArray(this[objLocs[i]]);
      if (typeof obj.userAttributes !== "undefined") {
      	for (attr in obj.userAttribSizes) {  // Not all attributes may have been used
      	  gl.disableVertexAttribArray( obj.userAttribLocations[attr] );
      	}
      }
    }
    
    /**
     * Draw an object in a subscene
     * @param { number } id - object to draw
     * @param { number } subsceneid - id of subscene
     */
    rglwidgetClass.prototype.drawObj = function(id, subsceneid) {
      var obj = this.getObj(id),
          subscene = this.getObj(subsceneid),
          flags = obj.flags,
          type = obj.type,
          is_lit = flags & this.f_is_lit,
          has_texture = flags & this.f_has_texture,
          fixed_quads = flags & this.f_fixed_quads,
          is_transparent = flags & this.f_is_transparent,
          depth_sort = flags & this.f_depth_sort,
          sprites_3d = flags & this.f_sprites_3d,
          sprite_3d = flags & this.f_sprite_3d,
          is_lines = flags & this.f_is_lines,
          fat_lines = flags & this.f_fat_lines,
          is_points = flags & this.f_is_points,
          fixed_size = flags & this.f_fixed_size,
          is_twosided = (flags & this.f_is_twosided) > 0,
          gl = this.gl || this.initGL(),
          mat,
          sphereMV, baseofs, ofs, sscale, i, count, light,
          pass, mode, pmode, attr,
          enabled = {};

      if (typeof id !== "number") {
        this.alertOnce("drawObj id is "+typeof id);
      }

      if (type === "planes") {
        if (obj.bbox !== subscene.par3d.bbox || !obj.initialized) {
          this.planeUpdateTriangles(id, subscene.par3d.bbox);
        }
      }

      if (!obj.initialized)
        this.initObj(id);

      if (type === "clipplanes") {
        count = obj.offsets.length;
        var IMVClip = [];
        for (i=0; i < count; i++) {
          IMVClip[i] = this.multMV(this.invMatrix, obj.vClipplane.slice(4*i, 4*(i+1)));
         }
         obj.IMVClip = IMVClip;
        return;
      }

      if (type === "light" || type === "bboxdeco" || !obj.vertexCount)
        return;
    
      if (!is_transparent &&
    	  obj.someHidden) {
        is_transparent = true;
        depth_sort = ["triangles", "quads", "surface",
                      "spheres", "sprites", "text"].indexOf(type) >= 0;
      }        

      this.setDepthTest(id);
      
      if (sprites_3d) {
        var norigs = obj.vertices.length,
            savenorm = new CanvasMatrix4(this.normMatrix);
        this.origs = obj.vertices;
        this.usermat = new Float32Array(obj.userMatrix.getAsArray());
        this.radii = obj.radii;
        this.normMatrix = subscene.spriteNormmat;
        for (this.iOrig=0; this.iOrig < norigs; this.iOrig++) {
          for (i=0; i < obj.objects.length; i++) {
            this.drawObj(obj.objects[i], subsceneid);
          }
        }
        this.normMatrix = savenorm;
        return;
      } else {
        gl.useProgram(obj.prog);
      }

      if (typeof obj.polygon_offset !== "undefined") {
        gl.polygonOffset(obj.polygon_offset[0],
                          obj.polygon_offset[1]);
        gl.enable(gl.POLYGON_OFFSET_FILL);
      }

      if (sprite_3d) {
        gl.uniform3fv(obj.origLoc, new Float32Array(this.origs[this.iOrig]));
        if (this.radii.length > 1) {
          gl.uniform1f(obj.sizeLoc, this.radii[this.iOrig][0]);
        } else {
          gl.uniform1f(obj.sizeLoc, this.radii[0][0]);
        }
        gl.uniformMatrix4fv(obj.usermatLoc, false, this.usermat);
      }

      if (type === "spheres") {
        gl.bindBuffer(gl.ARRAY_BUFFER, this.sphere.buf);
      } else {
        gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
      }

      gl.uniformMatrix4fv( obj.prMatLoc, false, new Float32Array(this.prMatrix.getAsArray()) );
      gl.uniformMatrix4fv( obj.mvMatLoc, false, new Float32Array(this.mvMatrix.getAsArray()) );
      var clipcheck = 0,
          clipplaneids = subscene.clipplanes,
          clip, j;
      for (i=0; i < clipplaneids.length; i++) {
        clip = this.getObj(clipplaneids[i]);
        for (j=0; j < clip.offsets.length; j++) {
          gl.uniform4fv(obj.clipLoc[clipcheck + j], clip.IMVClip[j]);
        }
        clipcheck += clip.offsets.length;
      }
      if (typeof obj.clipLoc !== "undefined")
        for (i=clipcheck; i < obj.clipLoc.length; i++)
          gl.uniform4f(obj.clipLoc[i], 0,0,0,0);

      if (is_lit) {
        gl.uniformMatrix4fv( obj.normMatLoc, false, new Float32Array(this.normMatrix.getAsArray()) );
        gl.uniform3fv( obj.emissionLoc, obj.emission);
        gl.uniform1f( obj.shininessLoc, obj.shininess);
        for (i=0; i < subscene.lights.length; i++) {
          light = this.getObj(subscene.lights[i]);
          if (!light.initialized) this.initObj(subscene.lights[i]);
          gl.uniform3fv( obj.ambientLoc[i], this.componentProduct(light.ambient, obj.ambient));
          gl.uniform3fv( obj.specularLoc[i], this.componentProduct(light.specular, obj.specular));
          gl.uniform3fv( obj.diffuseLoc[i], light.diffuse);
          gl.uniform3fv( obj.lightDirLoc[i], light.lightDir);
          gl.uniform1i( obj.viewpointLoc[i], light.viewpoint);
          gl.uniform1i( obj.finiteLoc[i], light.finite);
        }
        for (i=subscene.lights.length; i < obj.nlights; i++) {
          gl.uniform3f( obj.ambientLoc[i], 0,0,0);
          gl.uniform3f( obj.specularLoc[i], 0,0,0);
          gl.uniform3f( obj.diffuseLoc[i], 0,0,0);
        }
      }

      if (fixed_size) {
        gl.uniform2f( obj.textScaleLoc, 0.75/this.vp.width, 0.75/this.vp.height);
      }

      gl.enableVertexAttribArray( this.posLoc );
      enabled.posLoc = true;

      var nc = obj.colorCount;
      count = obj.vertexCount;

      if (type === "spheres") {
        subscene = this.getObj(subsceneid);
        var scale = subscene.par3d.scale,
            scount = count, indices;
        gl.vertexAttribPointer(this.posLoc,  3, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,  0);
        gl.enableVertexAttribArray(obj.normLoc );
        enabled.normLoc = true;
        gl.vertexAttribPointer(obj.normLoc,  3, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,  0);
        gl.disableVertexAttribArray( this.colLoc );
        var sphereNorm = new CanvasMatrix4();
        sphereNorm.scale(scale[0], scale[1], scale[2]);
        sphereNorm.multRight(this.normMatrix);
        gl.uniformMatrix4fv( obj.normMatLoc, false, new Float32Array(sphereNorm.getAsArray()) );

        if (nc == 1) {
          gl.vertexAttrib4fv( this.colLoc, new Float32Array(obj.onecolor));
        }

        if (has_texture) {
          gl.enableVertexAttribArray( obj.texLoc );
          enabled.texLoc = true;
          gl.vertexAttribPointer(obj.texLoc, 2, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,
                                 4*this.sphere.vOffsets.tofs);
          gl.activeTexture(gl.TEXTURE0);
          gl.bindTexture(gl.TEXTURE_2D, obj.texture);
          gl.uniform1i( obj.sampler, 0);
        }

        if (depth_sort)
          indices = this.depthSort(obj);

        for (i = 0; i < scount; i++) {
          sphereMV = new CanvasMatrix4();

          if (depth_sort) {
            baseofs = indices[i]*obj.vOffsets.stride;
          } else {
            baseofs = i*obj.vOffsets.stride;
          }

          ofs = baseofs + obj.vOffsets.radofs;
          sscale = obj.values[ofs];

          sphereMV.scale(sscale/scale[0], sscale/scale[1], sscale/scale[2]);
          sphereMV.translate(obj.values[baseofs],
                             obj.values[baseofs+1],
                             obj.values[baseofs+2]);
          sphereMV.multRight(this.mvMatrix);
          gl.uniformMatrix4fv( obj.mvMatLoc, false, new Float32Array(sphereMV.getAsArray()) );

          if (nc > 1) {
            ofs = baseofs + obj.vOffsets.cofs;
            gl.vertexAttrib4f( this.colLoc, obj.values[ofs],
                                        obj.values[ofs+1],
                                       obj.values[ofs+2],
                                       obj.values[ofs+3] );
          }
          gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.sphere.ibuf);
          gl.drawElements(gl.TRIANGLES, this.sphere.sphereCount, gl.UNSIGNED_SHORT, 0);
        }
        
        this.disableArrays(obj, enabled);
        if (typeof obj.polygon_offset !== "undefined") 
          gl.disable(gl.POLYGON_OFFSET_FILL);
          
        return;
      } else {
        if (obj.colorCount === 1) {
          gl.disableVertexAttribArray( this.colLoc );
          gl.vertexAttrib4fv( this.colLoc, new Float32Array(obj.onecolor));
        } else {
          gl.enableVertexAttribArray( this.colLoc );
          enabled.colLoc = true;
          gl.vertexAttribPointer(this.colLoc, 4, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.cofs);
        }
      }

      if (is_lit && obj.vOffsets.nofs > 0) {
        gl.enableVertexAttribArray( obj.normLoc );
        enabled.normLoc = true;
        gl.vertexAttribPointer(obj.normLoc, 3, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.nofs);
      }

      if (has_texture || type === "text") {
        gl.enableVertexAttribArray( obj.texLoc );
        enabled.texLoc = true;
        gl.vertexAttribPointer(obj.texLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.tofs);
        gl.activeTexture(gl.TEXTURE0);
        gl.bindTexture(gl.TEXTURE_2D, obj.texture);
        gl.uniform1i( obj.sampler, 0);
      }

      if (fixed_quads) {
        gl.enableVertexAttribArray( obj.ofsLoc );
        enabled.ofsLoc = true;
        gl.vertexAttribPointer(obj.ofsLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.oofs);
      }

      if (typeof obj.userAttributes !== "undefined") {
      	for (attr in obj.userAttribSizes) {  // Not all attributes may have been used
      	  gl.enableVertexAttribArray( obj.userAttribLocations[attr] );
      	  gl.vertexAttribPointer( obj.userAttribLocations[attr], obj.userAttribSizes[attr],
      	  			  gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.userAttribOffsets[attr]);
      	}
      }

      if (typeof obj.userUniforms !== "undefined") {
      	for (attr in obj.userUniformLocations) {
      	  var loc = obj.userUniformLocations[attr];
      	  if (loc !== null) {
      	    var uniform = obj.userUniforms[attr];
      	    if (typeof uniform.length === "undefined")
      	      gl.uniform1f(loc, uniform);
      	    else if (typeof uniform[0].length === "undefined") {
      	      uniform = new Float32Array(uniform);
      	      switch(uniform.length) {
      	      	case 2: gl.uniform2fv(loc, uniform); break;
      	      	case 3: gl.uniform3fv(loc, uniform); break;
      	      	case 4: gl.uniform4fv(loc, uniform); break;
      	      	default: console.warn("bad uniform length");
      	      }
      	    } else if (uniform.length == 4 && uniform[0].length == 4)
      	      gl.uniformMatrix4fv(loc, false, new Float32Array(uniform.getAsArray()));
      	    else
      	      console.warn("unsupported uniform matrix");
      	  }
      	}
      }

      for (pass = 0; pass < obj.passes; pass++) {
      	pmode = obj.pmode[pass];
        if (pmode === "culled")
          continue;

      	mode = fat_lines && (is_lines || pmode == "lines") ? "TRIANGLES" : this.mode4type[type];
        if (depth_sort && pmode == "filled") {// Don't try depthsorting on wireframe or points
          var faces = this.depthSort(obj),
              nfaces = faces.length,
              frowsize = Math.floor(obj.f[pass].length/nfaces);

          if (type !== "spheres") {
            var f = obj.index_uint ? new Uint32Array(obj.f[pass].length) : new Uint16Array(obj.f[pass].length);
            for (i=0; i<nfaces; i++) {
              for (j=0; j<frowsize; j++) {
                f[frowsize*i + j] = obj.f[pass][frowsize*faces[i] + j];
              }
            }
            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[pass]);
            gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.DYNAMIC_DRAW);
          }
        }

      	if (is_twosided)
      	  gl.uniform1i(obj.frontLoc, pass !== 0);

        if (type !== "spheres") 
          gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[pass]);

        if (type === "sprites" || type === "text" || type === "quads") {
          count = count * 6/4;
        } else if (type === "surface") {
          count = obj.f[pass].length;
        }

        count = obj.f[pass].length;
      	if (!is_lines && pmode === "lines" && !fat_lines) {
          mode = "LINES";
        } else if (pmode === "points") {
          mode = "POINTS";
        }
                          
        if ((is_lines || pmode === "lines") && fat_lines) {
          gl.enableVertexAttribArray(obj.pointLoc);
          enabled.pointLoc = true;
          gl.vertexAttribPointer(obj.pointLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.pointofs);
          gl.enableVertexAttribArray(obj.nextLoc );
          enabled.nextLoc = true;
          gl.vertexAttribPointer(obj.nextLoc, 3, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.nextofs);
          gl.uniform1f(obj.aspectLoc, this.vp.width/this.vp.height);
          gl.uniform1f(obj.lwdLoc, this.getMaterial(id, "lwd")/this.vp.height);
        }

        gl.vertexAttribPointer(this.posLoc,  3, gl.FLOAT, false, 4*obj.vOffsets.stride,  4*obj.vOffsets.vofs);

        gl.drawElements(gl[mode], count, obj.index_uint ? gl.UNSIGNED_INT : gl.UNSIGNED_SHORT, 0);
        this.disableArrays(obj, enabled);
     }
     
     if (typeof obj.polygon_offset !== "undefined") 
       gl.disable(gl.POLYGON_OFFSET_FILL);
   };

    /**
     * Draw the background for a subscene
     * @param { number } id - id of background object
     * @param { number } subsceneid - id of subscene
     */
    rglwidgetClass.prototype.drawBackground = function(id, subsceneid) {
      var gl = this.gl || this.initGL(),
          obj = this.getObj(id),
          bg, i;

      if (!obj.initialized)
        this.initObj(id);

      if (obj.colors.length) {
        bg = obj.colors[0];
        gl.clearColor(bg[0], bg[1], bg[2], bg[3]);
        gl.depthMask(true);
        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
      }
      if (typeof obj.quad !== "undefined") {
        this.prMatrix.makeIdentity();
        this.mvMatrix.makeIdentity();
        gl.disable(gl.BLEND);
        gl.disable(gl.DEPTH_TEST);
        gl.depthMask(false);
        for (i=0; i < obj.quad.length; i++)
          this.drawObj(obj.quad[i], subsceneid);
      }
    };

    /**
     * Draw a subscene
     * @param { number } subsceneid - id of subscene
     * @param { boolean } opaquePass - is this the opaque drawing pass?
     */
    rglwidgetClass.prototype.drawSubscene = function(subsceneid, opaquePass) {
      var gl = this.gl || this.initGL(),
          sub = this.getObj(subsceneid),
          objects = this.scene.objects,
          subids = sub.objects,
          subscene_has_faces = false,
          subscene_needs_sorting = false,
          flags, i, obj;
      if (sub.par3d.skipRedraw)
        return;
      for (i=0; i < subids.length; i++) {
      	obj = objects[subids[i]];
        flags = obj.flags;
        if (typeof flags !== "undefined") {
          subscene_has_faces |= (flags & this.f_is_lit)
                           & !(flags & this.f_fixed_quads);
          obj.is_transparent = (flags & this.f_is_transparent) || obj.someHidden;
          subscene_needs_sorting |= (flags & this.f_depth_sort) || obj.is_transparent;
        }
      }

      this.setViewport(subsceneid);

      if (typeof sub.backgroundId !== "undefined" && opaquePass)
          this.drawBackground(sub.backgroundId, subsceneid);

      if (subids.length) {
        this.setprMatrix(subsceneid);
        this.setmvMatrix(subsceneid);

        if (subscene_has_faces) {
          this.setnormMatrix(subsceneid);
          if ((sub.flags & this.f_sprites_3d) &&
              typeof sub.spriteNormmat === "undefined") {
            sub.spriteNormmat = new CanvasMatrix4(this.normMatrix);
          }
        }

        if (subscene_needs_sorting)
          this.setprmvMatrix();

        var clipids = sub.clipplanes;
        if (typeof clipids === "undefined") {
          console.warn("bad clipids");
        }
        if (clipids.length > 0) {
          this.invMatrix = new CanvasMatrix4(this.mvMatrix);
          this.invMatrix.invert();
          for (i = 0; i < clipids.length; i++)
            this.drawObj(clipids[i], subsceneid);
        }

        subids = sub.opaque.concat(sub.transparent);
        if (opaquePass) {
          gl.enable(gl.DEPTH_TEST);
          gl.depthMask(true);
          gl.disable(gl.BLEND);
          for (i = 0; i < subids.length; i++) {
            if (!this.getObj(subids[i]).is_transparent)	
              this.drawObj(subids[i], subsceneid);
          }
        } else {
          gl.depthMask(false);
          gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA,
                               gl.ONE, gl.ONE);
          gl.enable(gl.BLEND);
          for (i = 0; i < subids.length; i++) {
            if (this.getObj(subids[i]).is_transparent)
              this.drawObj(subids[i], subsceneid);
          }
        }
        subids = sub.subscenes;
        for (i = 0; i < subids.length; i++) {
          this.drawSubscene(subids[i], opaquePass);
        }
      }
    };
    
    /**
     * Respond to brush change
     */
    rglwidgetClass.prototype.selectionChanged = function() {
      var i, j, k, id, subid = this.select.subscene, subscene,
          objids, obj,
          p1 = this.select.region.p1, p2 = this.select.region.p2,
          filter, selection = [], handle, keys, xmin, x, xmax, ymin, y, ymax, z, v,
          someHidden;
      if (!subid)
        return;
      subscene = this.getObj(subid);
      objids = subscene.objects;
      filter = this.scene.crosstalk.filter;
      this.setmvMatrix(subid);
      this.setprMatrix(subid);
      this.setprmvMatrix();
      xmin = Math.min(p1.x, p2.x);
      xmax = Math.max(p1.x, p2.x);
      ymin = Math.min(p1.y, p2.y);
      ymax = Math.max(p1.y, p2.y);
      for (i = 0; i < objids.length; i++) {
      	id = objids[i];
      	j = this.scene.crosstalk.id.indexOf(id);
      	if (j >= 0) {
      	  keys = this.scene.crosstalk.key[j];
      	  obj = this.getObj(id);
      	  someHidden = false;
      	  for (k = 0; k < keys.length; k++) {
      	    if (filter && filter.indexOf(keys[k]) < 0) {
      	      someHidden = true;
      	      continue;
      	    }
      	    v = [].concat(obj.vertices[k]).concat(1.0);
            v = this.multVM(v, this.prmvMatrix);
            x = v[0]/v[3];
            y = v[1]/v[3];
            z = v[2]/v[3];
            if (xmin <= x && x <= xmax && ymin <= y && y <= ymax && -1.0 <= z && z <= 1.0) {
              selection.push(keys[k]);
            } else
              someHidden = true;
      	  }
      	  obj.someHidden = someHidden && (filter || selection.length);
      	  obj.initialized = false;
      	  /* Who should we notify?  Only shared data in the current subscene, or everyone? */
      	  if (!this.equalArrays(selection, this.scene.crosstalk.selection)) {
      	    handle = this.scene.crosstalk.sel_handle[j];
      	    handle.set(selection, {rglSubsceneId: this.select.subscene});
      	  }
      	}
      }
    };
    
    /**
     * Respond to selection or filter change from crosstalk
     * @param { Object } event - crosstalk event
     * @param { boolean } filter - filter or selection?
     */
    rglwidgetClass.prototype.selection = function(event, filter) {
      	var i, j, ids, obj, keys, crosstalk = this.scene.crosstalk,
      	    selection, someHidden;

      	// Record the message and find out if this event makes some objects have mixed values:
      	
      	crosstalk = this.scene.crosstalk;
      	
      	if (filter) {
      	  filter = crosstalk.filter = event.value;
      	  selection = crosstalk.selection;
      	} else {  
          selection = crosstalk.selection = event.value;
          filter = crosstalk.filter;
      	}
        ids = crosstalk.id;
        for (i = 0; i < ids.length ; i++) {
          obj = this.getObj(ids[i]);
          obj.initialized = false;
          keys = crosstalk.key[i];
          someHidden = false;
          for (j = 0; j < keys.length && !someHidden; j++) {
            if ((filter && filter.indexOf(keys[j]) < 0) ||
                (selection.length && selection.indexOf(keys[j]) < 0))
                someHidden = true;
          }
          obj.someHidden = someHidden;
        }
        this.drawScene();
    };
    
    /**
     * Clear the selection brush
     * @param { number } except - Subscene that should ignore this request
     */
    rglwidgetClass.prototype.clearBrush = function(except) {
      if (this.select.subscene != except) {
        this.select.state = "inactive";
        this.delFromSubscene(this.scene.brushId, this.select.subscene);
      }
      this.drawScene();
    };

    /**
     * Compute mouse coordinates relative to current canvas
     * @returns { Object }
     * @param { Object } event - event object from mouse click
     */
    rglwidgetClass.prototype.relMouseCoords = function(event) {
      var totalOffsetX = 0,
      totalOffsetY = 0,
      currentElement = this.canvas;

      do {
        totalOffsetX += currentElement.offsetLeft;
        totalOffsetY += currentElement.offsetTop;
        currentElement = currentElement.offsetParent;
      }
      while(currentElement);

      var canvasX = event.pageX - totalOffsetX,
          canvasY = event.pageY - totalOffsetY;

      return {x:canvasX, y:canvasY};
    };

    /**
     * Set mouse handlers for the scene
     */
    rglwidgetClass.prototype.setMouseHandlers = function() {
      var self = this, activeSubscene, handler,
          handlers = {}, drag = 0;

      handlers.rotBase = 0;

      this.screenToVector = function(x, y) {
        var viewport = this.getObj(activeSubscene).par3d.viewport,
          width = viewport.width*this.canvas.width,
          height = viewport.height*this.canvas.height,
          radius = Math.max(width, height)/2.0,
          cx = width/2.0,
          cy = height/2.0,
          px = (x-cx)/radius,
          py = (y-cy)/radius,
          plen = Math.sqrt(px*px+py*py);
        if (plen > 1.e-6) {
          px = px/plen;
          py = py/plen;
        }
        var angle = (Math.SQRT2 - plen)/Math.SQRT2*Math.PI/2,
          z = Math.sin(angle),
          zlen = Math.sqrt(1.0 - z*z);
        px = px * zlen;
        py = py * zlen;
        return [px, py, z];
      };

      handlers.trackballdown = function(x,y) {
        var activeSub = this.getObj(activeSubscene),
            activeModel = this.getObj(this.useid(activeSub.id, "model")),
            i, l = activeModel.par3d.listeners;
        handlers.rotBase = this.screenToVector(x, y);
        this.saveMat = [];
        for (i = 0; i < l.length; i++) {
          activeSub = this.getObj(l[i]);
          activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
        }
      };

      handlers.trackballmove = function(x,y) {
        var rotCurrent = this.screenToVector(x,y),
            rotBase = handlers.rotBase,
            dot = rotBase[0]*rotCurrent[0] +
                  rotBase[1]*rotCurrent[1] +
                  rotBase[2]*rotCurrent[2],
            angle = Math.acos( dot/this.vlen(rotBase)/this.vlen(rotCurrent) )*180.0/Math.PI,
            axis = this.xprod(rotBase, rotCurrent),
            objects = this.scene.objects,
            activeSub = this.getObj(activeSubscene),
            activeModel = this.getObj(this.useid(activeSub.id, "model")),
            l = activeModel.par3d.listeners,
            i;
        for (i = 0; i < l.length; i++) {
          activeSub = this.getObj(l[i]);
          activeSub.par3d.userMatrix.load(objects[l[i]].saveMat);
          activeSub.par3d.userMatrix.rotate(angle, axis[0], axis[1], axis[2]);
        }
        this.drawScene();
      };
      handlers.trackballend = 0;

      this.clamp = function(x, lo, hi) {
      	return Math.max(lo, Math.min(x, hi));
      };

      this.screenToPolar = function(x,y) {
        var viewport = this.getObj(activeSubscene).par3d.viewport,
          width = viewport.width*this.canvas.width,
          height = viewport.height*this.canvas.height,
    	  r = Math.min(width, height)/2,
    	  dx = this.clamp(x - width/2, -r, r),
    	  dy = this.clamp(y - height/2, -r, r);
    	  return [Math.asin(dx/r), Math.asin(-dy/r)];
      };

      handlers.polardown = function(x,y) {
        var activeSub = this.getObj(activeSubscene),
            activeModel = this.getObj(this.useid(activeSub.id, "model")),
            i, l = activeModel.par3d.listeners;
        handlers.dragBase = this.screenToPolar(x, y);
        this.saveMat = [];
        for (i = 0; i < l.length; i++) {
          activeSub = this.getObj(l[i]);
          activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
          activeSub.camBase = [-Math.atan2(activeSub.saveMat.m13, activeSub.saveMat.m11),
                               Math.atan2(activeSub.saveMat.m32, activeSub.saveMat.m22)];
        }
      };

      handlers.polarmove = function(x,y) {
        var dragCurrent = this.screenToPolar(x,y),
            activeSub = this.getObj(activeSubscene),
            activeModel = this.getObj(this.useid(activeSub.id, "model")),
            objects = this.scene.objects,
            l = activeModel.par3d.listeners,
            i, changepos = [];
        for (i = 0; i < l.length; i++) {
          activeSub = this.getObj(l[i]);
          for (j=0; j<2; j++)
            changepos[j] = -(dragCurrent[j] - handlers.dragBase[j]);
          activeSub.par3d.userMatrix.makeIdentity();
          activeSub.par3d.userMatrix.rotate(changepos[0]*180/Math.PI, 0,-1,0);
          activeSub.par3d.userMatrix.multRight(objects[l[i]].saveMat);
          activeSub.par3d.userMatrix.rotate(changepos[1]*180/Math.PI, -1,0,0);
        }
        this.drawScene();
      };
      handlers.polarend = 0;

      handlers.axisdown = function(x,y) {
        handlers.rotBase = this.screenToVector(x, this.canvas.height/2);
        var activeSub = this.getObj(activeSubscene),
            activeModel = this.getObj(this.useid(activeSub.id, "model")),
            i, l = activeModel.par3d.listeners;
        for (i = 0; i < l.length; i++) {
          activeSub = this.getObj(l[i]);
          activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
        }
      };

      handlers.axismove = function(x,y) {
        var rotCurrent = this.screenToVector(x, this.canvas.height/2),
            rotBase = handlers.rotBase,
            angle = (rotCurrent[0] - rotBase[0])*180/Math.PI,
            rotMat = new CanvasMatrix4();
        rotMat.rotate(angle, handlers.axis[0], handlers.axis[1], handlers.axis[2]);
        var activeSub = this.getObj(activeSubscene),
            activeModel = this.getObj(this.useid(activeSub.id, "model")),
            i, l = activeModel.par3d.listeners;
        for (i = 0; i < l.length; i++) {
          activeSub = this.getObj(l[i]);
          activeSub.par3d.userMatrix.load(activeSub.saveMat);
          activeSub.par3d.userMatrix.multLeft(rotMat);
        }
        this.drawScene();
      };
      handlers.axisend = 0;

      handlers.y0zoom = 0;
      handlers.zoom0 = 0;
      handlers.zoomdown = function(x, y) {
        var activeSub = this.getObj(activeSubscene),
          activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
          i, l = activeProjection.par3d.listeners;
        handlers.y0zoom = y;
        for (i = 0; i < l.length; i++) {
          activeSub = this.getObj(l[i]);
          activeSub.zoom0 = Math.log(activeSub.par3d.zoom);
        }
      };
      handlers.zoommove = function(x, y) {
        var activeSub = this.getObj(activeSubscene),
            activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
            i, l = activeProjection.par3d.listeners;
        for (i = 0; i < l.length; i++) {
          activeSub = this.getObj(l[i]);
          activeSub.par3d.zoom = Math.exp(activeSub.zoom0 + (y-handlers.y0zoom)/this.canvas.height);
        }
        this.drawScene();
      };
      handlers.zoomend = 0;

      handlers.y0fov = 0;
      handlers.fovdown = function(x, y) {
        handlers.y0fov = y;
        var activeSub = this.getObj(activeSubscene),
          activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
          i, l = activeProjection.par3d.listeners;
        for (i = 0; i < l.length; i++) {
          activeSub = this.getObj(l[i]);
          activeSub.fov0 = activeSub.par3d.FOV;
        }
      };
      handlers.fovmove = function(x, y) {
        var activeSub = this.getObj(activeSubscene),
            activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
            i, l = activeProjection.par3d.listeners;
        for (i = 0; i < l.length; i++) {
          activeSub = this.getObj(l[i]);
          activeSub.par3d.FOV = Math.max(1, Math.min(179, activeSub.fov0 +
             180*(y-handlers.y0fov)/this.canvas.height));
        }
        this.drawScene();
      };
      handlers.fovend = 0;
      
      handlers.selectingdown = function(x, y) {
      	var viewport = this.getObj(activeSubscene).par3d.viewport,
      	  width = viewport.width*this.canvas.width,
      	  height = viewport.height*this.canvas.height, 
          p = {x: 2.0*x/width - 1.0, y: 2.0*y/height - 1.0};
      	this.select.region = {p1: p, p2: p};
      	if (this.select.subscene && this.select.subscene != activeSubscene)
      	  this.delFromSubscene(this.scene.brushId, this.select.subscene);
      	this.select.subscene = activeSubscene;
      	this.addToSubscene(this.scene.brushId, activeSubscene);
      	this.select.state = "changing";
      	if (typeof this.scene.brushId !== "undefined")
      	  this.getObj(this.scene.brushId).initialized = false;
      	this.drawScene();
      };
      
      handlers.selectingmove = function(x, y) {
      	var viewport = this.getObj(activeSubscene).par3d.viewport,
      	  width = viewport.width*this.canvas.width,
      	  height = viewport.height*this.canvas.height;
      	if (this.select.state === "inactive") 
      	  return;
      	this.select.region.p2 = {x: 2.0*x/width - 1.0, y: 2.0*y/height - 1.0};
      	if (typeof this.scene.brushId !== "undefined")
      	  this.getObj(this.scene.brushId).initialized = false;
      	this.drawScene();
      };
      
      handlers.selectingend = 0;

      this.canvas.onmousedown = function ( ev ){
        if (!ev.which) // Use w3c defns in preference to MS
        switch (ev.button) {
          case 0: ev.which = 1; break;
          case 1:
          case 4: ev.which = 2; break;
          case 2: ev.which = 3;
        }
        drag = ["left", "middle", "right"][ev.which-1];
        var coords = self.relMouseCoords(ev);
        coords.y = self.canvas.height-coords.y;
        activeSubscene = self.whichSubscene(coords);
        var sub = self.getObj(activeSubscene), f;
        handler = sub.par3d.mouseMode[drag];
        switch (handler) {
        case "xAxis":
          handler = "axis";
          handlers.axis = [1.0, 0.0, 0.0];
          break;
        case "yAxis":
          handler = "axis";
          handlers.axis = [0.0, 1.0, 0.0];
          break;
        case "zAxis":
          handler = "axis";
          handlers.axis = [0.0, 0.0, 1.0];
          break;
        }
        f = handlers[handler + "down"];
        if (f) {
          coords = self.translateCoords(activeSubscene, coords);
          f.call(self, coords.x, coords.y);
          ev.preventDefault();
        } else
          console.warn("Mouse handler '" + handler + "' is not implemented.");

      };

      this.canvas.onmouseup = function ( ev ){
        if ( drag === 0 ) return;
        var f = handlers[handler + "end"];
        if (f) {
          f.call(self);
          ev.preventDefault();
        }
        drag = 0;
      };

      this.canvas.onmouseout = this.canvas.onmouseup;

      this.canvas.onmousemove = function ( ev ) {
        if ( drag === 0 ) return;
        var f = handlers[handler + "move"];
        if (f) {
          var coords = self.relMouseCoords(ev);
          coords.y = self.canvas.height - coords.y;
          coords = self.translateCoords(activeSubscene, coords);
          f.call(self, coords.x, coords.y);
        }
      };

      handlers.wheelHandler = function(ev) {
        var del = 1.02, i;
        if (ev.shiftKey) del = 1.002;
        var ds = ((ev.detail || ev.wheelDelta) > 0) ? del : (1 / del);
        if (typeof activeSubscene === "undefined")
          activeSubscene = self.scene.rootSubscene;
        var activeSub = self.getObj(activeSubscene),
            activeProjection = self.getObj(self.useid(activeSub.id, "projection")),
            l = activeProjection.par3d.listeners;

        for (i = 0; i < l.length; i++) {
          activeSub = self.getObj(l[i]);
          activeSub.par3d.zoom *= ds;
        }
        self.drawScene();
        ev.preventDefault();
      };

      this.canvas.addEventListener("DOMMouseScroll", handlers.wheelHandler, false);
      this.canvas.addEventListener("mousewheel", handlers.wheelHandler, false);
    };

    /**
     * Find a particular subscene by inheritance
     * @returns { number } id of subscene to use
     * @param { number } subsceneid - child subscene
     * @param { string } type - type of inheritance:  "projection" or "model"
     */
    rglwidgetClass.prototype.useid = function(subsceneid, type) {
      var sub = this.getObj(subsceneid);
      if (sub.embeddings[type] === "inherit")
        return(this.useid(sub.parent, type));
      else
        return subsceneid;
    };

    /**
     * Check whether point is in viewport of subscene
     * @returns {boolean}
     * @param { Object } coords - screen coordinates of point
     * @param { number } subsceneid - subscene to check
     */
    rglwidgetClass.prototype.inViewport = function(coords, subsceneid) {
      var viewport = this.getObj(subsceneid).par3d.viewport,
        x0 = coords.x - viewport.x*this.canvas.width,
        y0 = coords.y - viewport.y*this.canvas.height;
      return 0 <= x0 && x0 <= viewport.width*this.canvas.width &&
             0 <= y0 && y0 <= viewport.height*this.canvas.height;
    };

    /**
     * Find which subscene contains a point
     * @returns { number } subscene id
     * @param { Object } coords - coordinates of point
     */
    rglwidgetClass.prototype.whichSubscene = function(coords) {
      var self = this,
          recurse = function(subsceneid) {
            var subscenes = self.getChildSubscenes(subsceneid), i, id;
            for (i=0; i < subscenes.length; i++) {
              id = recurse(subscenes[i]);
              if (typeof(id) !== "undefined")
                return(id);
            }
            if (self.inViewport(coords, subsceneid))
              return(subsceneid);
            else
              return undefined;
          },
          rootid = this.scene.rootSubscene,
          result = recurse(rootid);
      if (typeof(result) === "undefined")
        result = rootid;
      return result;
    };

    /**
     * Translate from window coordinates to viewport coordinates
     * @returns { Object } translated coordinates
     * @param { number } subsceneid - which subscene to use?
     * @param { Object } coords - point to translate
     */
    rglwidgetClass.prototype.translateCoords = function(subsceneid, coords) {
      var viewport = this.getObj(subsceneid).par3d.viewport;
      return {x: coords.x - viewport.x*this.canvas.width,
              y: coords.y - viewport.y*this.canvas.height};
    };

    /**
     * Initialize the sphere object
     */
    rglwidgetClass.prototype.initSphere = function() {
      var verts = this.scene.sphereVerts,
          reuse = verts.reuse, result;
      if (typeof reuse !== "undefined") {
        var prev = document.getElementById(reuse).rglinstance.sphere;
        result = {values: prev.values, vOffsets: prev.vOffsets, it: prev.it};
      } else
        result = {values: new Float32Array(this.flatten(this.cbind(this.transpose(verts.vb),
                    this.transpose(verts.texcoords)))),
                  it: new Uint16Array(this.flatten(this.transpose(verts.it))),
                  vOffsets: {vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:-1,
                    tofs:3, nextofs:-1, pointofs:-1, stride:5}};

      result.sphereCount = result.it.length;
      this.sphere = result;
    };
    
    /**
     * Set the vertices in the selection box object
     */
    rglwidgetClass.prototype.initSelection = function(id) {
      if (typeof this.select.region === "undefined")
        return;
      var obj = this.getObj(id),
          width = this.canvas.width,
          height = this.canvas.height, 
          p1 = this.select.region.p1,
          p2 = this.select.region.p2;
          
      obj.vertices = [[p1.x, p1.y, 0.0],
                      [p2.x, p1.y, 0.0],
                      [p2.x, p2.y, 0.0],
                      [p1.x, p2.y, 0.0],
                      [p1.x, p1.y, 0.0]];
    };

    /**
     * Do the gl part of initializing the sphere
     */
    rglwidgetClass.prototype.initSphereGL = function() {
      var gl = this.gl || this.initGL(), sphere = this.sphere;
      if (gl.isContextLost()) return;
      sphere.buf = gl.createBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, sphere.buf);
      gl.bufferData(gl.ARRAY_BUFFER, sphere.values, gl.STATIC_DRAW);
      sphere.ibuf = gl.createBuffer();
      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, sphere.ibuf);
      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, sphere.it, gl.STATIC_DRAW);
      return;
    };

    /**
     * Initialize the DOM object
     * @param { Object } el - the DOM object
     * @param { Object } x - the scene data sent by JSON from R
     */
    rglwidgetClass.prototype.initialize = function(el, x) {
      this.textureCanvas = document.createElement("canvas");
      this.textureCanvas.style.display = "block";
      this.scene = x;
      this.normMatrix = new CanvasMatrix4();
      this.saveMat = {};
      this.distance = null;
      this.posLoc = 0;
      this.colLoc = 1;
      if (el) {
        el.rglinstance = this;
        this.el = el;
        this.webGLoptions = el.rglinstance.scene.webGLoptions;
        this.initCanvas();
      }
      if (typeof Shiny !== "undefined") {
        var self = this;
        Shiny.addCustomMessageHandler("shinyGetPar3d",
          function(message) {
            var i, param, 
                subscene = self.getObj(message.subscene),
                parameters = [].concat(message.parameters),
                result = {tag: message.tag, subscene: message.subscene};
            if (typeof subscene !== "undefined") {
              for (i = 0; i < parameters.length; i++) {
                param = parameters[i];
                result[param] = subscene.par3d[param];
              };
            } else {
              console.log("subscene "+message.subscene+" undefined.")
            }
            Shiny.setInputValue("par3d:shinyPar3d", result, {priority: "event"});
          });
          
        Shiny.addCustomMessageHandler("shinySetPar3d",
          function(message) {
            var param = message.parameter, 
                subscene = self.getObj(message.subscene);
            if (typeof subscene !== "undefined") {
              subscene.par3d[param] = message.value;
              subscene.initialized = false;
              self.drawScene();
            } else {
              console.log("subscene "+message.subscene+" undefined.")
            }
          })
      }
    };

    /**
     * Restart the WebGL canvas
     */
    rglwidgetClass.prototype.restartCanvas = function() {
      var newcanvas = document.createElement("canvas"),
          self = this;
      newcanvas.width = this.el.width;
      newcanvas.height = this.el.height;
      newcanvas.addEventListener("webglcontextrestored",
        this.onContextRestored, false);
      newcanvas.addEventListener("webglcontextlost",
        this.onContextLost, false);
      while (this.el.firstChild) {
        this.el.removeChild(this.el.firstChild);
      }
      this.el.appendChild(newcanvas);
      this.canvas = newcanvas;
      this.setMouseHandlers();
      if (this.gl) 
        Object.keys(this.scene.objects).forEach(function(key){
          self.getObj(parseInt(key, 10)).texture = undefined; 
          });
      this.gl = null;
    };

    /**
     * Initialize the WebGL canvas
     */
    rglwidgetClass.prototype.initCanvas = function() {
      this.restartCanvas();
      var objs = this.scene.objects,
          self = this;
      Object.keys(objs).forEach(function(key){
        var id = parseInt(key, 10),
            obj = self.getObj(id);
        if (typeof obj.reuse !== "undefined")
          self.copyObj(id, obj.reuse);
      });
      Object.keys(objs).forEach(function(key){
        self.initSubscene(parseInt(key, 10));
      });
      this.setMouseHandlers();
      this.initSphere();

      this.onContextRestored = function(event) {
        self.initGL();
        self.drawScene();
      };

      this.onContextLost = function(event) {
        if (!self.drawing)
          this.gl = null;
        event.preventDefault();
      };

      this.initGL0();
      this.lazyLoadScene = function() {
      	if (typeof self.slide === "undefined")
      	  self.slide = self.getSlide();
      	if (self.isInBrowserViewport()) {
      	  if (!self.gl || self.gl.isContextLost())
      	    self.initGL();
      	  self.drawScene();
      	}
      };
      window.addEventListener("DOMContentLoaded", this.lazyLoadScene, false);
      window.addEventListener("load", this.lazyLoadScene, false);
      window.addEventListener("resize", this.lazyLoadScene, false);
      window.addEventListener("scroll", this.lazyLoadScene, false);
      this.slide = this.getSlide();
      if (this.slide) {
        if (typeof this.slide.rgl === "undefined")
          this.slide.rgl = [this];
        else
          this.slide.rgl.push(this);
        if (this.scene.context.rmarkdown) 
          if (this.scene.context.rmarkdown === "ioslides_presentation") {
            this.slide.setAttribute("slideenter", "this.rgl.forEach(function(scene) { scene.lazyLoadScene.call(window);})");
          } else if (this.scene.context.rmarkdown === "slidy_presentation") {
            // This method would also work in ioslides, but it gets triggered
            // something like 5 times per slide for every slide change, so
            // you'd need a quicker function than lazyLoadScene.
            var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver,
            observer = new MutationObserver(function(mutations) {
              mutations.forEach(function(mutation) {
                self.slide.rgl.forEach(function(scene) { scene.lazyLoadScene.call(window); });});});
            observer.observe(this.slide, { attributes: true, attributeFilter:["class"] });
          }
      }
    };

    /**
     * Start the writeWebGL scene. This is only used by writeWebGL; rglwidget has
       no debug element and does the drawing in rglwidget.js.
     */
    rglwidgetClass.prototype.start = function() {
      if (typeof this.prefix !== "undefined") {
        this.debugelement = document.getElementById(this.prefix + "debug");
        this.debug("");
      }
      this.drag = 0;
      this.drawScene();
    };

    /**
     * Display a debug message
     * @param { string } msg - The message to display
     * @param { Object } [img] - Image to insert before message
     */
    rglwidgetClass.prototype.debug = function(msg, img) {
      if (typeof this.debugelement !== "undefined" && this.debugelement !== null) {
        this.debugelement.innerHTML = msg;
        if (typeof img !== "undefined") {
          this.debugelement.insertBefore(img, this.debugelement.firstChild);
        }
      } else if (msg !== "")
        alert(msg);
    };

    /**
     * Get the snapshot image of this scene
     * @returns { Object } The img DOM element
     */
    rglwidgetClass.prototype.getSnapshot = function() {
      var img;
      if (typeof this.scene.snapshot !== "undefined") {
        img = document.createElement("img");
        img.src = this.scene.snapshot;
        img.alt = "Snapshot";
      }
      return img;
    };

    /**
     * Initial test for WebGL
     */
    rglwidgetClass.prototype.initGL0 = function() {
      if (!window.WebGLRenderingContext){
        alert("Your browser does not support WebGL. See http://get.webgl.org");
        return;
      }
    };

    /**
     * If we are in an ioslides or slidy presentation, get the
     * DOM element of the current slide
     * @returns { Object }
     */
    rglwidgetClass.prototype.getSlide = function() {
      var result = this.el, done = false;
      while (result && !done && this.scene.context.rmarkdown) {
      	switch(this.scene.context.rmarkdown) {
          case "ioslides_presentation":
            if (result.tagName === "SLIDE") return result;
            break;
          case "slidy_presentation":
            if (result.tagName === "DIV" && result.classList.contains("slide"))
              return result;
            break;
          default: return null;
      	}
      	result = result.parentElement;
      }
      return null;
    };

    /**
     * Is this scene visible in the browser?
     * @returns { boolean }
     */
    rglwidgetClass.prototype.isInBrowserViewport = function() {
      var rect = this.canvas.getBoundingClientRect(),
          windHeight = (window.innerHeight || document.documentElement.clientHeight),
          windWidth = (window.innerWidth || document.documentElement.clientWidth);
      if (this.scene.context && this.scene.context.rmarkdown !== null) {
      	if (this.slide)
      	  return (this.scene.context.rmarkdown === "ioslides_presentation" &&
      	          this.slide.classList.contains("current")) ||
      	         (this.scene.context.rmarkdown === "slidy_presentation" &&
      	          !this.slide.classList.contains("hidden"));
      }
      return (
      	rect.top >= -windHeight &&
      	rect.left >= -windWidth &&
      	rect.bottom <= 2*windHeight &&
      	rect.right <= 2*windWidth);
    };

    /**
     * Initialize WebGL
     * @returns { Object } the WebGL context
     */
    rglwidgetClass.prototype.initGL = function() {
      var self = this;
      if (this.gl) {
      	if (!this.drawing && this.gl.isContextLost())
          this.restartCanvas();
        else
          return this.gl;
      }
      // if (!this.isInBrowserViewport()) return; Return what??? At this point we know this.gl is null.
      this.canvas.addEventListener("webglcontextrestored",
        this.onContextRestored, false);
      this.canvas.addEventListener("webglcontextlost",
        this.onContextLost, false);
      this.gl = this.canvas.getContext("webgl", this.webGLoptions) ||
               this.canvas.getContext("experimental-webgl", this.webGLoptions);
      this.index_uint = this.gl.getExtension("OES_element_index_uint");
      var save = this.startDrawing();
      this.initSphereGL();
      Object.keys(this.scene.objects).forEach(function(key){
        self.initObj(parseInt(key, 10));
        });
      this.stopDrawing(save);
      return this.gl;
    };

    /**
     * Resize the display to match element
     * @param { Object } el - DOM element to match
     */
    rglwidgetClass.prototype.resize = function(el) {
      this.canvas.width = el.width;
      this.canvas.height = el.height;
    };

    /**
     * Draw the whole scene
     */
    rglwidgetClass.prototype.drawScene = function() {
      var gl = this.gl || this.initGL(),
          wasDrawing = this.startDrawing();
      if (!wasDrawing) {
        if (this.select.state !== "inactive")
          this.selectionChanged();
        gl.enable(gl.DEPTH_TEST);
        gl.depthFunc(gl.LEQUAL);
        gl.clearDepth(1.0);
        gl.clearColor(1,1,1,1);
        gl.depthMask(true); // Must be true before clearing depth buffer
        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
        this.drawSubscene(this.scene.rootSubscene, true);
        this.drawSubscene(this.scene.rootSubscene, false);
      }
      this.stopDrawing(wasDrawing);
    };

    /**
     * Change the displayed subset
     * @param { Object } el - Element of the control; not used.
     * @param { Object } control - The subset control data.
     */
    rglwidgetClass.prototype.subsetSetter = function(el, control) {
      if (typeof control.subscenes === "undefined" ||
          control.subscenes === null)
        control.subscenes = this.scene.rootSubscene;
      var value = Math.round(control.value),
          subscenes = [].concat(control.subscenes),
          fullset = [].concat(control.fullset),
          i, j, entries, subsceneid,
          adds = [], deletes = [],
          ismissing = function(x) {
            return fullset.indexOf(x) < 0;
          },
          tointeger = function(x) {
            return parseInt(x, 10);
          };
      if (isNaN(value))
        value = control.value = 0;
      if (control.accumulate)
        for (i=0; i <= value; i++)
          adds = adds.concat(control.subsets[i]);
      else
        adds = adds.concat(control.subsets[value]);
      deletes = fullset.filter(function(x) { return adds.indexOf(x) < 0; });
      for (i = 0; i < subscenes.length; i++) {
        subsceneid = subscenes[i];
        if (typeof this.getObj(subsceneid) === "undefined")
          this.alertOnce("typeof object is undefined");
        for (j = 0; j < adds.length; j++)
          this.addToSubscene(adds[j], subsceneid);
        for (j = 0; j < deletes.length; j++)
          this.delFromSubscene(deletes[j], subsceneid);
      }
    };

    /**
     * Change the requested property
     * @param { Object } el - Element of the control; not used.
     * @param { Object } control - The property setter control data.
     */
    rglwidgetClass.prototype.propertySetter = function(el, control)  {
      var value = control.value,
          values = [].concat(control.values),
          svals = [].concat(control.param),
          direct = values[0] === null,
          entries = [].concat(control.entries),
          ncol = entries.length,
          nrow = values.length/ncol,
          properties = this.repeatToLen(control.properties, ncol),
          objids = this.repeatToLen(control.objids, ncol),
          property, objid = objids[0],
          obj = this.getObj(objid),
          propvals, i, v1, v2, p, entry, gl, needsBinding,
          newprop, newid,

          getPropvals = function() {
            if (property === "userMatrix")
              return obj.par3d.userMatrix.getAsArray();
            else if (property === "scale" || property === "FOV" || property === "zoom")
              return [].concat(obj.par3d[property]);
            else
              return [].concat(obj[property]);
          };

          putPropvals = function(newvals) {
            if (newvals.length == 1)
              newvals = newvals[0];
            if (property === "userMatrix")
              obj.par3d.userMatrix.load(newvals);
            else if (property === "scale" || property === "FOV" || property === "zoom")
              obj.par3d[property] = newvals;
            else
              obj[property] = newvals;
          };

      if (direct && typeof value === "undefined")
        return;

      if (control.interp) {
        values = values.slice(0, ncol).concat(values).
                 concat(values.slice(ncol*(nrow-1), ncol*nrow));
        svals = [-Infinity].concat(svals).concat(Infinity);
        for (i = 1; i < svals.length; i++) {
          if (value <= svals[i]) {
            if (svals[i] === Infinity)
              p = 1;
            else
              p = (svals[i] - value)/(svals[i] - svals[i-1]);
            break;
          }
        }
      } else if (!direct) {
        value = Math.round(value);
      }

      for (j=0; j<entries.length; j++) {
        entry = entries[j];
        newprop = properties[j];
        newid = objids[j];

        if (newprop !== property || newid != objid) {
          if (typeof property !== "undefined")
            putPropvals(propvals);
          property = newprop;
          objid = newid;
          obj = this.getObj(objid);
          propvals = getPropvals();
        }
        if (control.interp) {
          v1 = values[ncol*(i-1) + j];
          v2 = values[ncol*i + j];
          this.setElement(propvals, entry, p*v1 + (1-p)*v2);
        } else if (!direct) {
          this.setElement(propvals, entry, values[ncol*value + j]);
        } else {
          this.setElement(propvals, entry, value[j]);
        }
      }
      putPropvals(propvals);

      needsBinding = [];
      for (j=0; j < entries.length; j++) {
        if (properties[j] === "values" &&
            needsBinding.indexOf(objids[j]) === -1) {
          needsBinding.push(objids[j]);
        }
      }
      for (j=0; j < needsBinding.length; j++) {
        gl = this.gl || this.initGL();
        obj = this.getObj(needsBinding[j]);
        gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
        gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW);
      }
    };

    /**
     * Change the requested vertices
     * @param { Object } el - Element of the control; not used.
     * @param { Object } control - The vertext setter control data.
     */
    rglwidgetClass.prototype.vertexSetter = function(el, control)  {
      var svals = [].concat(control.param),
          j, k, p, a, propvals, stride, ofs, obj, entry,
          attrib,
          ofss    = {x:"vofs", y:"vofs", z:"vofs",
                     red:"cofs", green:"cofs", blue:"cofs",
                     alpha:"cofs", radii:"radofs",
                     nx:"nofs", ny:"nofs", nz:"nofs",
                     ox:"oofs", oy:"oofs", oz:"oofs",
                     ts:"tofs", tt:"tofs"},
          pos     = {x:0, y:1, z:2,
                     red:0, green:1, blue:2,
                     alpha:3,radii:0,
                     nx:0, ny:1, nz:2,
                     ox:0, oy:1, oz:2,
                     ts:0, tt:1},
        values = control.values,
        direct = values === null,
        ncol,
        interp = control.interp,
        vertices = [].concat(control.vertices),
        attributes = [].concat(control.attributes),
        value = control.value, newval, aliases, alias;

      ncol = Math.max(vertices.length, attributes.length);

      if (!ncol)
        return;

      vertices = this.repeatToLen(vertices, ncol);
      attributes = this.repeatToLen(attributes, ncol);

      if (direct)
        interp = false;

      /* JSON doesn't pass Infinity */
      svals[0] = -Infinity;
      svals[svals.length - 1] = Infinity;

      for (j = 1; j < svals.length; j++) {
        if (value <= svals[j]) {
          if (interp) {
            if (svals[j] === Infinity)
              p = 1;
            else
              p = (svals[j] - value)/(svals[j] - svals[j-1]);
          } else {
            if (svals[j] - value > value - svals[j-1])
              j = j - 1;
          }
          break;
        }
      }

      obj = this.getObj(control.objid);
      // First, make sure color attributes vary in original
      if (typeof obj.vOffsets !== "undefined") {
      	varies = true;
        for (k = 0; k < ncol; k++) {
          attrib = attributes[k];
          if (typeof attrib !== "undefined") {
            ofs = obj.vOffsets[ofss[attrib]];
            if (ofs < 0) {
              switch(attrib) {
              	case "alpha":
              	case "red":
              	case "green":
              	case "blue":
              	  obj.colors = [obj.colors[0], obj.colors[0]];
              	  break;
              }
              varies = false;
            }
          }
        }
        if (!varies)
          this.initObj(control.objid);
      }
      propvals = obj.values;
      aliases = obj.alias;
      if (typeof aliases === "undefined")
        aliases = [];
      for (k=0; k<ncol; k++) {
        if (direct) {
          newval = value;
        } else if (interp) {
          newval = p*values[j-1][k] + (1-p)*values[j][k];
        } else {
          newval = values[j][k];
        }      	
        attrib = attributes[k];
        vertex = vertices[k];
        alias = aliases[vertex];
        if (obj.type === "planes" || obj.type === "clipplanes") {
          ofs = ["nx", "ny", "nz", "offset"].indexOf(attrib);
          if (ofs >= 0) {
            if (ofs < 3) {
              if (obj.normals[vertex][ofs] != newval) {  // Assume no aliases here...
              	obj.normals[vertex][ofs] = newval;
              	obj.initialized = false;
              }
            } else {
              if (obj.offsets[vertex][0] != newval) {
              	obj.offsets[vertex][0] = newval;
              	obj.initialized = false;
              }
            }
            continue;
          }
        }
        // Not a plane setting...
        ofs = obj.vOffsets[ofss[attrib]];
        if (ofs < 0)
          this.alertOnce("Attribute '"+attrib+"' not found in object "+control.objid);
        else {
          stride = obj.vOffsets.stride;
          ofs = ofs + pos[attrib];
          entry = vertex*stride + ofs;
          propvals[entry] = newval;
          if (typeof alias !== "undefined")
            for (a = 0; a < alias.length; a++)
              propvals[alias[a]*stride + ofs] = newval;
        }
      }
      if (typeof obj.buf !== "undefined") {
        var gl = this.gl || this.initGL();
        gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
        gl.bufferData(gl.ARRAY_BUFFER, propvals, gl.STATIC_DRAW);
      }
    };

    /**
     * Change the requested vertex properties by age
     * @param { Object } el - Element of the control; not used.
     * @param { Object } control - The age setter control data.
     */
    rglwidgetClass.prototype.ageSetter = function(el, control) {
      var objids = [].concat(control.objids),
          nobjs = objids.length,
          time = control.value,
          births = [].concat(control.births),
          ages = [].concat(control.ages),
          steps = births.length,
          j = Array(steps),
          p = Array(steps),
          i, k, age, j0, propvals, stride, ofs, objid, obj,
          attrib, dim, varies, alias, aliases, a, d,
          attribs = ["colors", "alpha", "radii", "vertices",
                     "normals", "origins", "texcoords",
                     "x", "y", "z",
                     "red", "green", "blue"],
          ofss    = ["cofs", "cofs", "radofs", "vofs",
                     "nofs", "oofs", "tofs",
                     "vofs", "vofs", "vofs",
                     "cofs", "cofs", "cofs"],
          dims    = [3,1,1,3,
                     3,2,2,
                     1,1,1,
                     1,1,1],
          pos     = [0,3,0,0,
                     0,0,0,
                     0,1,2,
                     0,1,2];
      /* Infinity doesn't make it through JSON */
      ages[0] = -Infinity;
      ages[ages.length-1] = Infinity;
      for (i = 0; i < steps; i++) {
        if (births[i] !== null) {  // NA in R becomes null
          age = time - births[i];
          for (j0 = 1; age > ages[j0]; j0++);
          if (ages[j0] == Infinity)
            p[i] = 1;
          else if (ages[j0] > ages[j0-1])
            p[i] = (ages[j0] - age)/(ages[j0] - ages[j0-1]);
          else
            p[i] = 0;
          j[i] = j0;
        }
      }
      // First, make sure color attributes vary in original
      for (l = 0; l < nobjs; l++) {
      	objid = objids[l];
      	obj = this.getObj(objid);
      	varies = true;
        if (typeof obj.vOffsets === "undefined")
          continue;
        for (k = 0; k < attribs.length; k++) {
          attrib = control[attribs[k]];
          if (typeof attrib !== "undefined") {
            ofs = obj.vOffsets[ofss[k]];
            if (ofs < 0) {
              switch(attribs[k]) {
              	case "colors":
              	case "alpha":
              	case "red":
              	case "green":
              	case "blue":
              	  obj.colors = [obj.colors[0], obj.colors[0]];
              	  break;
              }
              varies = false;
            }
          }
        }
        if (!varies)
          this.initObj(objid);
      }
      for (l = 0; l < nobjs; l++) {
        objid = objids[l];
        obj = this.getObj(objid);
        if (typeof obj.vOffsets === "undefined")
          continue;
        aliases = obj.alias;
        if (typeof aliases === "undefined")
          aliases = [];
        propvals = obj.values;
        stride = obj.vOffsets.stride;
        for (k = 0; k < attribs.length; k++) {
          attrib = control[attribs[k]];
          if (typeof attrib !== "undefined") {
            ofs = obj.vOffsets[ofss[k]];
            if (ofs >= 0) {
              dim = dims[k];
              ofs = ofs + pos[k];
              for (i = 0; i < steps; i++) {
              	alias = aliases[i];
                if (births[i] !== null) {
                  for (d=0; d < dim; d++) {
                    propvals[i*stride + ofs + d] = p[i]*attrib[dim*(j[i]-1) + d] + (1-p[i])*attrib[dim*j[i] + d];
                    if (typeof alias !== "undefined")
                      for (a=0; a < alias.length; a++)
                        propvals[alias[a]*stride + ofs + d] = propvals[i*stride + ofs + d];
                  }
                }
              }
            } else
              this.alertOnce("\'"+attribs[k]+"\' property not found in object "+objid);
          }
        }
        obj.values = propvals;
        if (typeof obj.buf !== "undefined") {
          gl = this.gl || this.initGL();
          gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
          gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW);
        }
      }
    };

    /**
     * Bridge to old style control
     * @param { Object } el - Element of the control; not used.
     * @param { Object } control - The bridge control data.
     */
    rglwidgetClass.prototype.oldBridge = function(el, control) {
      var attrname, global = window[control.prefix + "rgl"];
      if (global)
        for (attrname in global)
          this[attrname] = global[attrname];
      window[control.prefix + "rgl"] = this;
    };

    /**
     * Set up a player control
     * @param { Object } el - The player control element
     * @param { Object } control - The player data.
     */
    rglwidgetClass.prototype.Player = function(el, control) {
      var
        self = this,
        components = [].concat(control.components),
        buttonLabels = [].concat(control.buttonLabels),

        Tick = function() { /* "this" will be a timer */
          var i,
              nominal = this.value,
              slider = this.Slider,
              labels = this.outputLabels,
              output = this.Output,
              step;
          if (typeof slider !== "undefined" && nominal != slider.value)
            slider.value = nominal;
          if (typeof output !== "undefined") {
            step = Math.round((nominal - output.sliderMin)/output.sliderStep);
            if (labels !== null) {
              output.innerHTML = labels[step];
            } else {
              step = step*output.sliderStep + output.sliderMin;
              output.innerHTML = step.toPrecision(output.outputPrecision);
            }
          }
          for (i=0; i < this.actions.length; i++) {
            this.actions[i].value = nominal;
          }
          self.applyControls(el, this.actions, false);
          self.drawScene();
        },

        OnSliderInput = function() { /* "this" will be the slider */
          this.rgltimer.value = Number(this.value);
          this.rgltimer.Tick();
        },

        addSlider = function(min, max, step, value) {
          var slider = document.createElement("input");
          slider.type = "range";
          slider.min = min;
          slider.max = max;
          slider.step = step;
          slider.value = value;
          slider.oninput = OnSliderInput;
          slider.sliderActions = control.actions;
          slider.sliderScene = this;
          slider.className = "rgl-slider";
          slider.id = el.id + "-slider";
          el.rgltimer.Slider = slider;
          slider.rgltimer = el.rgltimer;
          el.appendChild(slider);
        },

        addLabel = function(labels, min, step, precision) {
          var output = document.createElement("output");
          output.sliderMin = min;
          output.sliderStep = step;
          output.outputPrecision = precision;
          output.className = "rgl-label";
          output.id = el.id + "-label";
          el.rgltimer.Output = output;
          el.rgltimer.outputLabels = labels;
          el.appendChild(output);
        },

        addButton = function(which, label, active) {
          var button = document.createElement("input"),
              onclicks = {Reverse: function() { this.rgltimer.reverse();},
                    Play: function() { this.rgltimer.play();
                                       this.value = this.rgltimer.enabled ? this.inactiveValue : this.activeValue; },
                   Slower: function() { this.rgltimer.slower(); },
                   Faster: function() { this.rgltimer.faster(); },
                   Reset: function() { this.rgltimer.reset(); },
              	   Step:  function() { this.rgltimer.step(); }
              };
          button.rgltimer = el.rgltimer;
          button.type = "button";
          button.value = label;
          button.activeValue = label;
          button.inactiveValue = active;
          if (which === "Play")
            button.rgltimer.PlayButton = button;
          button.onclick = onclicks[which];
          button.className = "rgl-button";
          button.id = el.id + "-" + which;
          el.appendChild(button);
        };

        if (typeof control.reinit !== "undefined" && control.reinit !== null) {
          control.actions.reinit = control.reinit;
        }
        el.rgltimer = new rgltimerClass(Tick, control.start, control.interval, control.stop,
                                        control.step, control.value, control.rate, control.loop, control.actions);
        for (var i=0; i < components.length; i++) {
          switch(components[i]) {
            case "Slider": addSlider(control.start, control.stop,
                                   control.step, control.value);
              break;
            case "Label": addLabel(control.labels, control.start,
                                   control.step, control.precision);
              break;
            default:
              addButton(components[i], buttonLabels[i], control.pause);
          }
        }
        el.rgltimer.Tick();
    };

    /**
     * Apply all registered controls
     * @param { Object } el - DOM element of the control
     * @param { Object } x - List of actions to apply
     * @param { boolean } [draw=true] - Whether to redraw after applying
     */
    rglwidgetClass.prototype.applyControls = function(el, x, draw) {
      var self = this, reinit = x.reinit, i, control, type;
      for (i = 0; i < x.length; i++) {
        control = x[i];
        type = control.type;
        self[type](el, control);
      }
      if (typeof reinit !== "undefined" && reinit !== null) {
        reinit = [].concat(reinit);
        for (i = 0; i < reinit.length; i++)
          self.getObj(reinit[i]).initialized = false;
      }
      if (typeof draw === "undefined" || draw)
        self.drawScene();
    };

    /**
     * Handler for scene change
     * @param { Object } message - What sort of scene change to do?
     */
    rglwidgetClass.prototype.sceneChangeHandler = function(message) {
      var self = document.getElementById(message.elementId).rglinstance,
          objs = message.objects, mat = message.material,
          root = message.rootSubscene,
          initSubs = message.initSubscenes,
          redraw = message.redrawScene,
          skipRedraw = message.skipRedraw,
          deletes, subs, allsubs = [], i,j;
      if (typeof message.delete !== "undefined") {
        deletes = [].concat(message.delete);
        if (typeof message.delfromSubscenes !== "undefined")
          subs = [].concat(message.delfromSubscenes);
        else
          subs = [];
        for (i = 0; i < deletes.length; i++) {
          for (j = 0; j < subs.length; j++) {
            self.delFromSubscene(deletes[i], subs[j]);
          }
          delete self.scene.objects[deletes[i]];
        }
      }
      if (typeof objs !== "undefined") {
        Object.keys(objs).forEach(function(key){
          key = parseInt(key, 10);
          self.scene.objects[key] = objs[key];
          self.initObj(key);
          var obj = self.getObj(key),
              subs = [].concat(obj.inSubscenes), k;
          allsubs = allsubs.concat(subs);
          for (k = 0; k < subs.length; k++)
            self.addToSubscene(key, subs[k]);
        });
      }
      if (typeof mat !== "undefined") {
        self.scene.material = mat;
      }
      if (typeof root !== "undefined") {
        self.scene.rootSubscene = root;
      }
      if (typeof initSubs !== "undefined")
        allsubs = allsubs.concat(initSubs);
      allsubs = self.unique(allsubs);
      for (i = 0; i < allsubs.length; i++) {
        self.initSubscene(allsubs[i]);
      }
      if (typeof skipRedraw !== "undefined") {
        root = self.getObj(self.scene.rootSubscene);
        root.par3d.skipRedraw = skipRedraw;
      }
      if (redraw)
        self.drawScene();
    };
    
    /**
     * Set mouse mode for a subscene
     * @param { string } mode - name of mode
     * @param { number } button - button number (1 to 3)
     * @param { number } subscene - subscene id number
     * @param { number } stayActive - if truthy, don't clear brush
     */
    rglwidgetClass.prototype.setMouseMode = function(mode, button, subscene, stayActive) {
      var sub = this.getObj(subscene),
          which = ["left", "right", "middle"][button - 1];
      if (!stayActive && sub.par3d.mouseMode[which] === "selecting")
        this.clearBrush(null);
      sub.par3d.mouseMode[which] = mode;
    };

/**
 * The class of an rgl timer object
 * @class
*/

/**
 * Construct an rgltimerClass object
 * @constructor
 * @param { function } Tick - action when timer fires
 * @param { number } startTime - nominal start time in seconds
 * @param { number } interval - seconds between updates
 * @param { number } stopTime - nominal stop time in seconds
 * @param { number } stepSize - nominal step size
 * @param { number } value - current nominal time
 * @param { number } rate - nominal units per second
 * @param { string } loop - "none", "cycle" or "oscillate"
 * @param { Object } actions - list of actions
 */
rgltimerClass = function(Tick, startTime, interval, stopTime, stepSize, value, rate, loop, actions) {
  this.enabled = false;
  this.timerId = 0;
  /** nominal start time in seconds */
  this.startTime = startTime;   
  /** current nominal time */      
  this.value = value;
  /** seconds between updates */                 
  this.interval = interval;
  /** nominal stop time */           
  this.stopTime = stopTime;
  /** nominal step size */           
  this.stepSize = stepSize;
  /** nominal units per second */           
  this.rate = rate;
  /** "none", "cycle", or "oscillate" */                   
  this.loop = loop;
  /** real world start time */                   
  this.realStart = undefined;
  /** multiplier for fast-forward or reverse */         
  this.multiplier = 1;                
  this.actions = actions;
  this.Tick = Tick;
};

  /**
   * Start playing timer object
   */
  rgltimerClass.prototype.play = function() {
    if (this.enabled) {
      this.enabled = false;
      window.clearInterval(this.timerId);
      this.timerId = 0;
      return;
    }
    var tick = function(self) {
      var now = new Date();
      self.value = self.multiplier*self.rate*(now - self.realStart)/1000 + self.startTime;
      self.forceToRange();
      if (typeof self.Tick !== "undefined") {
        self.Tick(self.value);
      }

    };
    this.realStart = new Date() - 1000*(this.value - this.startTime)/this.rate/this.multiplier;
    this.timerId = window.setInterval(tick, 1000*this.interval, this);
    this.enabled = true;
  };

  /**
   * Force value into legal range
   */
  rgltimerClass.prototype.forceToRange = function() {
    if (this.value > this.stopTime + this.stepSize/2 || this.value < this.startTime - this.stepSize/2) {
      if (!this.loop) {
        this.reset();
      } else {
        var cycle = this.stopTime - this.startTime + this.stepSize,
            newval = (this.value - this.startTime) % cycle + this.startTime;
        if (newval < this.startTime) {
          newval += cycle;
        }
        this.realStart += (this.value - newval)*1000/this.multiplier/this.rate;
        this.value = newval;
      }
    }
  };

  /**
   * Reset to start values
   */
  rgltimerClass.prototype.reset = function() {
    this.value = this.startTime;
    this.newmultiplier(1);
    if (typeof this.Tick !== "undefined") {
        this.Tick(this.value);
    }
    if (this.enabled)
      this.play();  /* really pause... */
    if (typeof this.PlayButton !== "undefined")
      this.PlayButton.value = "Play";
  };

  /**
   * Increase the multiplier to play faster
   */
  rgltimerClass.prototype.faster = function() {
    this.newmultiplier(Math.SQRT2*this.multiplier);
  };

  /**
   * Decrease the multiplier to play slower
   */
  rgltimerClass.prototype.slower = function() {
    this.newmultiplier(this.multiplier/Math.SQRT2);
  };

  /**
   * Change sign of multiplier to reverse direction
   */
  rgltimerClass.prototype.reverse = function() {
    this.newmultiplier(-this.multiplier);
  };

  /**
   * Set multiplier for play speed
   * @param { number } newmult - new value
   */
  rgltimerClass.prototype.newmultiplier = function(newmult) {
    if (newmult != this.multiplier) {
      this.realStart += 1000*(this.value - this.startTime)/this.rate*(1/this.multiplier - 1/newmult);
      this.multiplier = newmult;
    }
  };

  /**
   * Take one step
   */
  rgltimerClass.prototype.step = function() {
    this.value += this.rate*this.multiplier;
    this.forceToRange();
    if (typeof this.Tick !== "undefined")
      this.Tick(this.value);
  };
</script>
<script>/*
 * Copyright (C) 2009 Apple Inc. All Rights Reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

 * Copyright (2016) Duncan Murdoch - fixed CanvasMatrix4.ortho,
 * cleaned up.
 */
/*
    CanvasMatrix4 class

    This class implements a 4x4 matrix. It has functions which
    duplicate the functionality of the OpenGL matrix stack and
    glut functions.

    IDL:

    [
        Constructor(in CanvasMatrix4 matrix),           // copy passed matrix into new CanvasMatrix4
        Constructor(in sequence<float> array)           // create new CanvasMatrix4 with 16 floats (row major)
        Constructor()                                   // create new CanvasMatrix4 with identity matrix
    ]
    interface CanvasMatrix4 {
        attribute float m11;
        attribute float m12;
        attribute float m13;
        attribute float m14;
        attribute float m21;
        attribute float m22;
        attribute float m23;
        attribute float m24;
        attribute float m31;
        attribute float m32;
        attribute float m33;
        attribute float m34;
        attribute float m41;
        attribute float m42;
        attribute float m43;
        attribute float m44;

        void load(in CanvasMatrix4 matrix);                 // copy the values from the passed matrix
        void load(in sequence<float> array);                // copy 16 floats into the matrix
        sequence<float> getAsArray();                       // return the matrix as an array of 16 floats
        WebGLFloatArray getAsCanvasFloatArray();           // return the matrix as a WebGLFloatArray with 16 values
        void makeIdentity();                                // replace the matrix with identity
        void transpose();                                   // replace the matrix with its transpose
        void invert();                                      // replace the matrix with its inverse

        void translate(in float x, in float y, in float z); // multiply the matrix by passed translation values on the right
        void scale(in float x, in float y, in float z);     // multiply the matrix by passed scale values on the right
        void rotate(in float angle,                         // multiply the matrix by passed rotation values on the right
                    in float x, in float y, in float z);    // (angle is in degrees)
        void multRight(in CanvasMatrix matrix);             // multiply the matrix by the passed matrix on the right
        void multLeft(in CanvasMatrix matrix);              // multiply the matrix by the passed matrix on the left
        void ortho(in float left, in float right,           // multiply the matrix by the passed ortho values on the right
                   in float bottom, in float top,
                   in float near, in float far);
        void frustum(in float left, in float right,         // multiply the matrix by the passed frustum values on the right
                     in float bottom, in float top,
                     in float near, in float far);
        void perspective(in float fovy, in float aspect,    // multiply the matrix by the passed perspective values on the right
                         in float zNear, in float zFar);
        void lookat(in float eyex, in float eyey, in float eyez,    // multiply the matrix by the passed lookat
                    in float ctrx, in float ctry, in float ctrz,    // values on the right
                    in float upx, in float upy, in float upz);
    }
*/

CanvasMatrix4 = function(m)
{
    if (typeof m == 'object') {
        if ("length" in m && m.length >= 16) {
            this.load(m[0], m[1], m[2], m[3], m[4], m[5], m[6], m[7], m[8], m[9], m[10], m[11], m[12], m[13], m[14], m[15]);
            return;
        }
        else if (m instanceof CanvasMatrix4) {
            this.load(m);
            return;
        }
    }
    this.makeIdentity();
};

CanvasMatrix4.prototype.load = function()
{
    if (arguments.length == 1 && typeof arguments[0] == 'object') {
        var matrix = arguments[0];

        if ("length" in matrix && matrix.length == 16) {
            this.m11 = matrix[0];
            this.m12 = matrix[1];
            this.m13 = matrix[2];
            this.m14 = matrix[3];

            this.m21 = matrix[4];
            this.m22 = matrix[5];
            this.m23 = matrix[6];
            this.m24 = matrix[7];

            this.m31 = matrix[8];
            this.m32 = matrix[9];
            this.m33 = matrix[10];
            this.m34 = matrix[11];

            this.m41 = matrix[12];
            this.m42 = matrix[13];
            this.m43 = matrix[14];
            this.m44 = matrix[15];
            return;
        }

        if (arguments[0] instanceof CanvasMatrix4) {

            this.m11 = matrix.m11;
            this.m12 = matrix.m12;
            this.m13 = matrix.m13;
            this.m14 = matrix.m14;

            this.m21 = matrix.m21;
            this.m22 = matrix.m22;
            this.m23 = matrix.m23;
            this.m24 = matrix.m24;

            this.m31 = matrix.m31;
            this.m32 = matrix.m32;
            this.m33 = matrix.m33;
            this.m34 = matrix.m34;

            this.m41 = matrix.m41;
            this.m42 = matrix.m42;
            this.m43 = matrix.m43;
            this.m44 = matrix.m44;
            return;
        }
    }

    this.makeIdentity();
};

CanvasMatrix4.prototype.getAsArray = function()
{
    return [
        this.m11, this.m12, this.m13, this.m14,
        this.m21, this.m22, this.m23, this.m24,
        this.m31, this.m32, this.m33, this.m34,
        this.m41, this.m42, this.m43, this.m44
    ];
};

CanvasMatrix4.prototype.getAsWebGLFloatArray = function()
{
    return new WebGLFloatArray(this.getAsArray());
};

CanvasMatrix4.prototype.makeIdentity = function()
{
    this.m11 = 1;
    this.m12 = 0;
    this.m13 = 0;
    this.m14 = 0;

    this.m21 = 0;
    this.m22 = 1;
    this.m23 = 0;
    this.m24 = 0;

    this.m31 = 0;
    this.m32 = 0;
    this.m33 = 1;
    this.m34 = 0;

    this.m41 = 0;
    this.m42 = 0;
    this.m43 = 0;
    this.m44 = 1;
};

CanvasMatrix4.prototype.transpose = function()
{
    var tmp = this.m12;
    this.m12 = this.m21;
    this.m21 = tmp;

    tmp = this.m13;
    this.m13 = this.m31;
    this.m31 = tmp;

    tmp = this.m14;
    this.m14 = this.m41;
    this.m41 = tmp;

    tmp = this.m23;
    this.m23 = this.m32;
    this.m32 = tmp;

    tmp = this.m24;
    this.m24 = this.m42;
    this.m42 = tmp;

    tmp = this.m34;
    this.m34 = this.m43;
    this.m43 = tmp;
};

CanvasMatrix4.prototype.invert = function()
{
    // Calculate the 4x4 determinant
    // If the determinant is zero,
    // then the inverse matrix is not unique.
    var det = this._determinant4x4();

    if (Math.abs(det) < 1e-8)
        return null;

    this._makeAdjoint();

    // Scale the adjoint matrix to get the inverse
    this.m11 /= det;
    this.m12 /= det;
    this.m13 /= det;
    this.m14 /= det;

    this.m21 /= det;
    this.m22 /= det;
    this.m23 /= det;
    this.m24 /= det;

    this.m31 /= det;
    this.m32 /= det;
    this.m33 /= det;
    this.m34 /= det;

    this.m41 /= det;
    this.m42 /= det;
    this.m43 /= det;
    this.m44 /= det;
};

CanvasMatrix4.prototype.translate = function(x,y,z)
{
    if (x === undefined)
        x = 0;
    if (y === undefined)
        y = 0;
    if (z === undefined)
        z = 0;

    var matrix = new CanvasMatrix4();
    matrix.m41 = x;
    matrix.m42 = y;
    matrix.m43 = z;

    this.multRight(matrix);
};

CanvasMatrix4.prototype.scale = function(x,y,z)
{
    if (x === undefined)
        x = 1;
    if (z === undefined) {
        if (y === undefined) {
            y = x;
            z = x;
        }
        else
            z = 1;
    }
    else if (y === undefined)
        y = x;

    var matrix = new CanvasMatrix4();
    matrix.m11 = x;
    matrix.m22 = y;
    matrix.m33 = z;

    this.multRight(matrix);
};

CanvasMatrix4.prototype.rotate = function(angle,x,y,z)
{
    // angles are in degrees. Switch to radians
    angle = angle / 180 * Math.PI;

    angle /= 2;
    var sinA = Math.sin(angle);
    var cosA = Math.cos(angle);
    var sinA2 = sinA * sinA;

    // normalize
    var length = Math.sqrt(x * x + y * y + z * z);
    if (length === 0) {
        // bad vector, just use something reasonable
        x = 0;
        y = 0;
        z = 1;
    } else if (length != 1) {
        x /= length;
        y /= length;
        z /= length;
    }

    var mat = new CanvasMatrix4();

    // optimize case where axis is along major axis
    if (x == 1 && y === 0 && z === 0) {
        mat.m11 = 1;
        mat.m12 = 0;
        mat.m13 = 0;
        mat.m21 = 0;
        mat.m22 = 1 - 2 * sinA2;
        mat.m23 = 2 * sinA * cosA;
        mat.m31 = 0;
        mat.m32 = -2 * sinA * cosA;
        mat.m33 = 1 - 2 * sinA2;
        mat.m14 = mat.m24 = mat.m34 = 0;
        mat.m41 = mat.m42 = mat.m43 = 0;
        mat.m44 = 1;
    } else if (x === 0 && y == 1 && z === 0) {
        mat.m11 = 1 - 2 * sinA2;
        mat.m12 = 0;
        mat.m13 = -2 * sinA * cosA;
        mat.m21 = 0;
        mat.m22 = 1;
        mat.m23 = 0;
        mat.m31 = 2 * sinA * cosA;
        mat.m32 = 0;
        mat.m33 = 1 - 2 * sinA2;
        mat.m14 = mat.m24 = mat.m34 = 0;
        mat.m41 = mat.m42 = mat.m43 = 0;
        mat.m44 = 1;
    } else if (x === 0 && y === 0 && z == 1) {
        mat.m11 = 1 - 2 * sinA2;
        mat.m12 = 2 * sinA * cosA;
        mat.m13 = 0;
        mat.m21 = -2 * sinA * cosA;
        mat.m22 = 1 - 2 * sinA2;
        mat.m23 = 0;
        mat.m31 = 0;
        mat.m32 = 0;
        mat.m33 = 1;
        mat.m14 = mat.m24 = mat.m34 = 0;
        mat.m41 = mat.m42 = mat.m43 = 0;
        mat.m44 = 1;
    } else {
        var x2 = x*x;
        var y2 = y*y;
        var z2 = z*z;

        mat.m11 = 1 - 2 * (y2 + z2) * sinA2;
        mat.m12 = 2 * (x * y * sinA2 + z * sinA * cosA);
        mat.m13 = 2 * (x * z * sinA2 - y * sinA * cosA);
        mat.m21 = 2 * (y * x * sinA2 - z * sinA * cosA);
        mat.m22 = 1 - 2 * (z2 + x2) * sinA2;
        mat.m23 = 2 * (y * z * sinA2 + x * sinA * cosA);
        mat.m31 = 2 * (z * x * sinA2 + y * sinA * cosA);
        mat.m32 = 2 * (z * y * sinA2 - x * sinA * cosA);
        mat.m33 = 1 - 2 * (x2 + y2) * sinA2;
        mat.m14 = mat.m24 = mat.m34 = 0;
        mat.m41 = mat.m42 = mat.m43 = 0;
        mat.m44 = 1;
    }
    this.multRight(mat);
};

CanvasMatrix4.prototype.multRight = function(mat)
{
    var m11 = (this.m11 * mat.m11 + this.m12 * mat.m21 +
               this.m13 * mat.m31 + this.m14 * mat.m41);
    var m12 = (this.m11 * mat.m12 + this.m12 * mat.m22 +
               this.m13 * mat.m32 + this.m14 * mat.m42);
    var m13 = (this.m11 * mat.m13 + this.m12 * mat.m23 +
               this.m13 * mat.m33 + this.m14 * mat.m43);
    var m14 = (this.m11 * mat.m14 + this.m12 * mat.m24 +
               this.m13 * mat.m34 + this.m14 * mat.m44);

    var m21 = (this.m21 * mat.m11 + this.m22 * mat.m21 +
               this.m23 * mat.m31 + this.m24 * mat.m41);
    var m22 = (this.m21 * mat.m12 + this.m22 * mat.m22 +
               this.m23 * mat.m32 + this.m24 * mat.m42);
    var m23 = (this.m21 * mat.m13 + this.m22 * mat.m23 +
               this.m23 * mat.m33 + this.m24 * mat.m43);
    var m24 = (this.m21 * mat.m14 + this.m22 * mat.m24 +
               this.m23 * mat.m34 + this.m24 * mat.m44);

    var m31 = (this.m31 * mat.m11 + this.m32 * mat.m21 +
               this.m33 * mat.m31 + this.m34 * mat.m41);
    var m32 = (this.m31 * mat.m12 + this.m32 * mat.m22 +
               this.m33 * mat.m32 + this.m34 * mat.m42);
    var m33 = (this.m31 * mat.m13 + this.m32 * mat.m23 +
               this.m33 * mat.m33 + this.m34 * mat.m43);
    var m34 = (this.m31 * mat.m14 + this.m32 * mat.m24 +
               this.m33 * mat.m34 + this.m34 * mat.m44);

    var m41 = (this.m41 * mat.m11 + this.m42 * mat.m21 +
               this.m43 * mat.m31 + this.m44 * mat.m41);
    var m42 = (this.m41 * mat.m12 + this.m42 * mat.m22 +
               this.m43 * mat.m32 + this.m44 * mat.m42);
    var m43 = (this.m41 * mat.m13 + this.m42 * mat.m23 +
               this.m43 * mat.m33 + this.m44 * mat.m43);
    var m44 = (this.m41 * mat.m14 + this.m42 * mat.m24 +
               this.m43 * mat.m34 + this.m44 * mat.m44);

    this.m11 = m11;
    this.m12 = m12;
    this.m13 = m13;
    this.m14 = m14;

    this.m21 = m21;
    this.m22 = m22;
    this.m23 = m23;
    this.m24 = m24;

    this.m31 = m31;
    this.m32 = m32;
    this.m33 = m33;
    this.m34 = m34;

    this.m41 = m41;
    this.m42 = m42;
    this.m43 = m43;
    this.m44 = m44;
};

CanvasMatrix4.prototype.multLeft = function(mat)
{
    var m11 = (mat.m11 * this.m11 + mat.m12 * this.m21 +
               mat.m13 * this.m31 + mat.m14 * this.m41);
    var m12 = (mat.m11 * this.m12 + mat.m12 * this.m22 +
               mat.m13 * this.m32 + mat.m14 * this.m42);
    var m13 = (mat.m11 * this.m13 + mat.m12 * this.m23 +
               mat.m13 * this.m33 + mat.m14 * this.m43);
    var m14 = (mat.m11 * this.m14 + mat.m12 * this.m24 +
               mat.m13 * this.m34 + mat.m14 * this.m44);

    var m21 = (mat.m21 * this.m11 + mat.m22 * this.m21 +
               mat.m23 * this.m31 + mat.m24 * this.m41);
    var m22 = (mat.m21 * this.m12 + mat.m22 * this.m22 +
               mat.m23 * this.m32 + mat.m24 * this.m42);
    var m23 = (mat.m21 * this.m13 + mat.m22 * this.m23 +
               mat.m23 * this.m33 + mat.m24 * this.m43);
    var m24 = (mat.m21 * this.m14 + mat.m22 * this.m24 +
               mat.m23 * this.m34 + mat.m24 * this.m44);

    var m31 = (mat.m31 * this.m11 + mat.m32 * this.m21 +
               mat.m33 * this.m31 + mat.m34 * this.m41);
    var m32 = (mat.m31 * this.m12 + mat.m32 * this.m22 +
               mat.m33 * this.m32 + mat.m34 * this.m42);
    var m33 = (mat.m31 * this.m13 + mat.m32 * this.m23 +
               mat.m33 * this.m33 + mat.m34 * this.m43);
    var m34 = (mat.m31 * this.m14 + mat.m32 * this.m24 +
               mat.m33 * this.m34 + mat.m34 * this.m44);

    var m41 = (mat.m41 * this.m11 + mat.m42 * this.m21 +
               mat.m43 * this.m31 + mat.m44 * this.m41);
    var m42 = (mat.m41 * this.m12 + mat.m42 * this.m22 +
               mat.m43 * this.m32 + mat.m44 * this.m42);
    var m43 = (mat.m41 * this.m13 + mat.m42 * this.m23 +
               mat.m43 * this.m33 + mat.m44 * this.m43);
    var m44 = (mat.m41 * this.m14 + mat.m42 * this.m24 +
               mat.m43 * this.m34 + mat.m44 * this.m44);

    this.m11 = m11;
    this.m12 = m12;
    this.m13 = m13;
    this.m14 = m14;

    this.m21 = m21;
    this.m22 = m22;
    this.m23 = m23;
    this.m24 = m24;

    this.m31 = m31;
    this.m32 = m32;
    this.m33 = m33;
    this.m34 = m34;

    this.m41 = m41;
    this.m42 = m42;
    this.m43 = m43;
    this.m44 = m44;
};

CanvasMatrix4.prototype.ortho = function(left, right, bottom, top, near, far)
{
    var tx = (left + right) / (left - right);
    var ty = (top + bottom) / (bottom - top);
    var tz = (far + near) / (near - far);

    var matrix = new CanvasMatrix4();
    matrix.m11 = 2 / (right - left);
    matrix.m12 = 0;
    matrix.m13 = 0;
    matrix.m14 = 0;
    matrix.m21 = 0;
    matrix.m22 = 2 / (top - bottom);
    matrix.m23 = 0;
    matrix.m24 = 0;
    matrix.m31 = 0;
    matrix.m32 = 0;
    matrix.m33 = -2 / (far - near);
    matrix.m34 = 0;
    matrix.m41 = tx;
    matrix.m42 = ty;
    matrix.m43 = tz;
    matrix.m44 = 1;

    this.multRight(matrix);
};

CanvasMatrix4.prototype.frustum = function(left, right, bottom, top, near, far)
{
    var matrix = new CanvasMatrix4();
    var A = (right + left) / (right - left);
    var B = (top + bottom) / (top - bottom);
    var C = -(far + near) / (far - near);
    var D = -(2 * far * near) / (far - near);

    matrix.m11 = (2 * near) / (right - left);
    matrix.m12 = 0;
    matrix.m13 = 0;
    matrix.m14 = 0;

    matrix.m21 = 0;
    matrix.m22 = 2 * near / (top - bottom);
    matrix.m23 = 0;
    matrix.m24 = 0;

    matrix.m31 = A;
    matrix.m32 = B;
    matrix.m33 = C;
    matrix.m34 = -1;

    matrix.m41 = 0;
    matrix.m42 = 0;
    matrix.m43 = D;
    matrix.m44 = 0;

    this.multRight(matrix);
};

CanvasMatrix4.prototype.perspective = function(fovy, aspect, zNear, zFar)
{
    var top = Math.tan(fovy * Math.PI / 360) * zNear;
    var bottom = -top;
    var left = aspect * bottom;
    var right = aspect * top;
    this.frustum(left, right, bottom, top, zNear, zFar);
};

CanvasMatrix4.prototype.lookat = function(eyex, eyey, eyez, centerx, centery, centerz, upx, upy, upz)
{
    var matrix = new CanvasMatrix4();

    // Make rotation matrix

    // Z vector
    var zx = eyex - centerx;
    var zy = eyey - centery;
    var zz = eyez - centerz;
    var mag = Math.sqrt(zx * zx + zy * zy + zz * zz);
    if (mag) {
        zx /= mag;
        zy /= mag;
        zz /= mag;
    }

    // Y vector
    var yx = upx;
    var yy = upy;
    var yz = upz;

    // X vector = Y cross Z
    xx =  yy * zz - yz * zy;
    xy = -yx * zz + yz * zx;
    xz =  yx * zy - yy * zx;

    // Recompute Y = Z cross X
    yx = zy * xz - zz * xy;
    yy = -zx * xz + zz * xx;
    yx = zx * xy - zy * xx;

    // cross product gives area of parallelogram, which is < 1.0 for
    // non-perpendicular unit-length vectors; so normalize x, y here

    mag = Math.sqrt(xx * xx + xy * xy + xz * xz);
    if (mag) {
        xx /= mag;
        xy /= mag;
        xz /= mag;
    }

    mag = Math.sqrt(yx * yx + yy * yy + yz * yz);
    if (mag) {
        yx /= mag;
        yy /= mag;
        yz /= mag;
    }

    matrix.m11 = xx;
    matrix.m12 = xy;
    matrix.m13 = xz;
    matrix.m14 = 0;

    matrix.m21 = yx;
    matrix.m22 = yy;
    matrix.m23 = yz;
    matrix.m24 = 0;

    matrix.m31 = zx;
    matrix.m32 = zy;
    matrix.m33 = zz;
    matrix.m34 = 0;

    matrix.m41 = 0;
    matrix.m42 = 0;
    matrix.m43 = 0;
    matrix.m44 = 1;
    matrix.translate(-eyex, -eyey, -eyez);

    this.multRight(matrix);
};

// Support functions
CanvasMatrix4.prototype._determinant2x2 = function(a, b, c, d)
{
    return a * d - b * c;
};

CanvasMatrix4.prototype._determinant3x3 = function(a1, a2, a3, b1, b2, b3, c1, c2, c3)
{
    return a1 * this._determinant2x2(b2, b3, c2, c3) -
         b1 * this._determinant2x2(a2, a3, c2, c3) +
         c1 * this._determinant2x2(a2, a3, b2, b3);
};

CanvasMatrix4.prototype._determinant4x4 = function()
{
    var a1 = this.m11;
    var b1 = this.m12;
    var c1 = this.m13;
    var d1 = this.m14;

    var a2 = this.m21;
    var b2 = this.m22;
    var c2 = this.m23;
    var d2 = this.m24;

    var a3 = this.m31;
    var b3 = this.m32;
    var c3 = this.m33;
    var d3 = this.m34;

    var a4 = this.m41;
    var b4 = this.m42;
    var c4 = this.m43;
    var d4 = this.m44;

    return a1 * this._determinant3x3(b2, b3, b4, c2, c3, c4, d2, d3, d4) -
         b1 * this._determinant3x3(a2, a3, a4, c2, c3, c4, d2, d3, d4) +
         c1 * this._determinant3x3(a2, a3, a4, b2, b3, b4, d2, d3, d4) -
         d1 * this._determinant3x3(a2, a3, a4, b2, b3, b4, c2, c3, c4);
};

CanvasMatrix4.prototype._makeAdjoint = function()
{
    var a1 = this.m11;
    var b1 = this.m12;
    var c1 = this.m13;
    var d1 = this.m14;

    var a2 = this.m21;
    var b2 = this.m22;
    var c2 = this.m23;
    var d2 = this.m24;

    var a3 = this.m31;
    var b3 = this.m32;
    var c3 = this.m33;
    var d3 = this.m34;

    var a4 = this.m41;
    var b4 = this.m42;
    var c4 = this.m43;
    var d4 = this.m44;

    // Row column labeling reversed since we transpose rows & columns
    this.m11  =   this._determinant3x3(b2, b3, b4, c2, c3, c4, d2, d3, d4);
    this.m21  = - this._determinant3x3(a2, a3, a4, c2, c3, c4, d2, d3, d4);
    this.m31  =   this._determinant3x3(a2, a3, a4, b2, b3, b4, d2, d3, d4);
    this.m41  = - this._determinant3x3(a2, a3, a4, b2, b3, b4, c2, c3, c4);

    this.m12  = - this._determinant3x3(b1, b3, b4, c1, c3, c4, d1, d3, d4);
    this.m22  =   this._determinant3x3(a1, a3, a4, c1, c3, c4, d1, d3, d4);
    this.m32  = - this._determinant3x3(a1, a3, a4, b1, b3, b4, d1, d3, d4);
    this.m42  =   this._determinant3x3(a1, a3, a4, b1, b3, b4, c1, c3, c4);

    this.m13  =   this._determinant3x3(b1, b2, b4, c1, c2, c4, d1, d2, d4);
    this.m23  = - this._determinant3x3(a1, a2, a4, c1, c2, c4, d1, d2, d4);
    this.m33  =   this._determinant3x3(a1, a2, a4, b1, b2, b4, d1, d2, d4);
    this.m43  = - this._determinant3x3(a1, a2, a4, b1, b2, b4, c1, c2, c4);

    this.m14  = - this._determinant3x3(b1, b2, b3, c1, c2, c3, d1, d2, d3);
    this.m24  =   this._determinant3x3(a1, a2, a3, c1, c2, c3, d1, d2, d3);
    this.m34  = - this._determinant3x3(a1, a2, a3, b1, b2, b3, d1, d2, d3);
    this.m44  =   this._determinant3x3(a1, a2, a3, b1, b2, b3, c1, c2, c3);
};
</script>
<script>/* el is the div, holding the rgl object as el.rglinstance,
     which holds x as el.rglinstance.scene
   x is the JSON encoded rglwidget.
*/


HTMLWidgets.widget({

  name: 'rglWebGL',

  type: 'output',

  factory: function(el, width, height) {
    el.width = width;
    el.height = height;
    var rgl = new rglwidgetClass(),
        onchangeselection = function(e) {
          for (var i = 0; i < rgl.scene.crosstalk.sel_handle.length; i++)
            rgl.clearBrush(except = e.rglSubsceneId);
          rgl.selection(e, false);
        },
        onchangefilter = function(e) {
          rgl.selection(e, true);
        };
    
    return { 
      renderValue: function(x) {
        var i, pel, player, groups;
      
        x.crosstalk.group = groups = [].concat(x.crosstalk.group);
        x.crosstalk.id = [].concat(x.crosstalk.id);
        x.crosstalk.key = [].concat(x.crosstalk.key);
        x.crosstalk.sel_handle = new Array(groups.length);
        x.crosstalk.fil_handle = new Array(groups.length);
        x.crosstalk.selection = [];
        for (i = 0; i < groups.length; i++) {
          x.crosstalk.sel_handle[i] = new crosstalk.SelectionHandle(groups[i], {sharedId: x.crosstalk.id[i]});
          x.crosstalk.sel_handle[i].on("change", onchangeselection);
          x.crosstalk.fil_handle[i] = new crosstalk.FilterHandle(groups[i], {sharedId: x.crosstalk.id[i]});
          x.crosstalk.fil_handle[i].on("change", onchangefilter);
        }
        rgl.initialize(el, x);
        rgl.initGL();
  
  /* We might have been called after (some of) the players were rendered.
     We need to make sure we respond to their initial values. */

        if (typeof x.players !== "undefined") {
          var players = [].concat(x.players);
          for (i = 0; i < players.length; i++) {
            pel = document.getElementById(players[i]);
            if (pel) {
              player = pel.rglPlayer;
              if (player && !player.initialized) {
                rgl.Player(pel, player);
                player.initialized = true;
              }
            }
          }
        }
        rgl.drag = 0;
        rgl.drawScene();
      },

      resize: function(width, height) {
        el.width = width;
        el.height = height;
        el.rglinstance.resize(el);
        el.rglinstance.drawScene();
      }
    };
  }
});
</script>
<script>/*! jQuery v1.11.3 | (c) 2005, 2015 jQuery Foundation, Inc. | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l="1.11.3",m=function(a,b){return new m.fn.init(a,b)},n=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,o=/^-ms-/,p=/-([\da-z])/gi,q=function(a,b){return b.toUpperCase()};m.fn=m.prototype={jquery:l,constructor:m,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=m.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return m.each(this,a,b)},map:function(a){return this.pushStack(m.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},m.extend=m.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||m.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(m.isPlainObject(c)||(b=m.isArray(c)))?(b?(b=!1,f=a&&m.isArray(a)?a:[]):f=a&&m.isPlainObject(a)?a:{},g[d]=m.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},m.extend({expando:"jQuery"+(l+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===m.type(a)},isArray:Array.isArray||function(a){return"array"===m.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!m.isArray(a)&&a-parseFloat(a)+1>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==m.type(a)||a.nodeType||m.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,"constructor")&&!j.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(k.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(b){b&&m.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(o,"ms-").replace(p,q)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=r(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(n,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(r(Object(a))?m.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var c=+b.length,d=0,e=a.length;while(c>d)a[e++]=b[d++];if(c!==c)while(void 0!==b[d])a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=r(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(f=a[b],b=a,a=f),m.isFunction(a)?(c=d.call(arguments,2),e=function(){return a.apply(b||this,c.concat(d.call(arguments)))},e.guid=a.guid=a.guid||m.guid++,e):void 0},now:function(){return+new Date},support:k}),m.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function r(a){var b="length"in a&&a.length,c=m.type(a);return"function"===c||m.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var s=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=M.replace("w","w#"),O="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+L+"*\\]",P=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",Q=new RegExp(L+"+","g"),R=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),S=new RegExp("^"+L+"*,"+L+"*"),T=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),U=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),V=new RegExp(P),W=new RegExp("^"+N+"$"),X={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+P),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,aa=/[+~]/,ba=/'|\\/g,ca=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),da=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ea=function(){m()};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(fa){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],k=b.nodeType,"string"!=typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&p){if(11!==k&&(f=_.exec(a)))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return H.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName)return H.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=1!==k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(ba,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--)o[l]=s+ra(o[l]);w=aa.test(a)&&pa(b.parentNode)||b,x=o.join(",")}if(x)try{return H.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function oa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function pa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=g.documentElement,e=g.defaultView,e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",ea,!1):e.attachEvent&&e.attachEvent("onunload",ea)),p=!f(g),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ja(function(a){return a.appendChild(g.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(g.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!g.getElementsByName||!g.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(g.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ja(function(a){var b=g.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",P)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===g||a.ownerDocument===v&&t(v,a)?-1:b===g||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===g?-1:b===g?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)i.unshift(c);while(h[d]===i[d])d++;return d?la(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},g):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return ga(b,n,null,[a]).length>0},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ga.selectors={cacheLength:50,createPseudo:ia,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ca,da),a[3]=(a[3]||a[4]||a[5]||"").replace(ca,da),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ca,da).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(Q," ")+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=J(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return ga(a,b).length>0}}),contains:ia(function(a){return a=a.replace(ca,da),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ia(function(a){return W.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(ca,da).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:oa(function(){return[0]}),last:oa(function(a,b){return[b-1]}),eq:oa(function(a,b,c){return[0>c?c+b:c]}),even:oa(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:oa(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:oa(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:oa(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function qa(){}qa.prototype=d.filters=d.pseudos,d.setFilters=new qa,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)};function ra(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function sa(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function ta(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function ua(a,b,c){for(var d=0,e=b.length;e>d;d++)ga(a,b[d],c);return c}function va(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function wa(a,b,c,d,e,f){return d&&!d[u]&&(d=wa(d)),e&&!e[u]&&(e=wa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||ua(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:va(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=va(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=va(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function xa(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=sa(function(a){return a===b},h,!0),l=sa(function(a){return J(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];f>i;i++)if(c=d.relative[a[i].type])m=[sa(ta(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return wa(i>1&&ta(m),i>1&&ra(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&xa(a.slice(i,e)),f>e&&xa(a=a.slice(e)),f>e&&ra(a))}m.push(c)}return ta(m)}function ya(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++])if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){m=0;while(o=b[m++])o(r,s,g,h);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=F.call(i));s=va(s)}H.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&ga.uniqueSort(i)}return k&&(w=v,j=t),r};return c?ia(f):f}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=xa(b[c]),f[u]?d.push(f):e.push(f);f=A(a,ya(e,d)),f.selector=a}return f},i=ga.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(ca,da),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(ca,da),aa.test(j[0].type)&&pa(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&ra(j),!a)return H.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,aa.test(a)&&pa(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ka("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ka("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ja(function(a){return null==a.getAttribute("disabled")})||ka(K,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);m.find=s,m.expr=s.selectors,m.expr[":"]=m.expr.pseudos,m.unique=s.uniqueSort,m.text=s.getText,m.isXMLDoc=s.isXML,m.contains=s.contains;var t=m.expr.match.needsContext,u=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,v=/^.[^:#\[\.,]*$/;function w(a,b,c){if(m.isFunction(b))return m.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return m.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(v.test(b))return m.filter(b,a,c);b=m.filter(b,a)}return m.grep(a,function(a){return m.inArray(a,b)>=0!==c})}m.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?m.find.matchesSelector(d,a)?[d]:[]:m.find.matches(a,m.grep(b,function(a){return 1===a.nodeType}))},m.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(m(a).filter(function(){for(b=0;e>b;b++)if(m.contains(d[b],this))return!0}));for(b=0;e>b;b++)m.find(a,d[b],c);return c=this.pushStack(e>1?m.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(w(this,a||[],!1))},not:function(a){return this.pushStack(w(this,a||[],!0))},is:function(a){return!!w(this,"string"==typeof a&&t.test(a)?m(a):a||[],!1).length}});var x,y=a.document,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=m.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||x).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof m?b[0]:b,m.merge(this,m.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:y,!0)),u.test(c[1])&&m.isPlainObject(b))for(c in b)m.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=y.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return x.find(a);this.length=1,this[0]=d}return this.context=y,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):m.isFunction(a)?"undefined"!=typeof x.ready?x.ready(a):a(m):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),m.makeArray(a,this))};A.prototype=m.fn,x=m(y);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};m.extend({dir:function(a,b,c){var d=[],e=a[b];while(e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!m(e).is(c)))1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),m.fn.extend({has:function(a){var b,c=m(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(m.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=t.test(a)||"string"!=typeof a?m(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&m.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?m.unique(f):f)},index:function(a){return a?"string"==typeof a?m.inArray(this[0],m(a)):m.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(m.unique(m.merge(this.get(),m(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function D(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}m.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return m.dir(a,"parentNode")},parentsUntil:function(a,b,c){return m.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return m.dir(a,"nextSibling")},prevAll:function(a){return m.dir(a,"previousSibling")},nextUntil:function(a,b,c){return m.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return m.dir(a,"previousSibling",c)},siblings:function(a){return m.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return m.sibling(a.firstChild)},contents:function(a){return m.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:m.merge([],a.childNodes)}},function(a,b){m.fn[a]=function(c,d){var e=m.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=m.filter(d,e)),this.length>1&&(C[a]||(e=m.unique(e)),B.test(a)&&(e=e.reverse())),this.pushStack(e)}});var E=/\S+/g,F={};function G(a){var b=F[a]={};return m.each(a.match(E)||[],function(a,c){b[c]=!0}),b}m.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):m.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&e>f;f++)if(h[f].apply(l[0],l[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())},k={add:function(){if(h){var d=h.length;!function f(b){m.each(b,function(b,c){var d=m.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&m.each(arguments,function(a,c){var d;while((d=m.inArray(c,h,d))>-1)h.splice(d,1),b&&(e>=d&&e--,f>=d&&f--)}),this},has:function(a){return a?m.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=c||[],c=[a,c.slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},m.extend({Deferred:function(a){var b=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return m.Deferred(function(c){m.each(b,function(b,f){var g=m.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&m.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?m.extend(a,d):d}},e={};return d.pipe=d.then,m.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&m.isFunction(a.promise)?e:0,g=1===f?a:m.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&m.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;m.fn.ready=function(a){return m.ready.promise().done(a),this},m.extend({isReady:!1,readyWait:1,holdReady:function(a){a?m.readyWait++:m.ready(!0)},ready:function(a){if(a===!0?!--m.readyWait:!m.isReady){if(!y.body)return setTimeout(m.ready);m.isReady=!0,a!==!0&&--m.readyWait>0||(H.resolveWith(y,[m]),m.fn.triggerHandler&&(m(y).triggerHandler("ready"),m(y).off("ready")))}}});function I(){y.addEventListener?(y.removeEventListener("DOMContentLoaded",J,!1),a.removeEventListener("load",J,!1)):(y.detachEvent("onreadystatechange",J),a.detachEvent("onload",J))}function J(){(y.addEventListener||"load"===event.type||"complete"===y.readyState)&&(I(),m.ready())}m.ready.promise=function(b){if(!H)if(H=m.Deferred(),"complete"===y.readyState)setTimeout(m.ready);else if(y.addEventListener)y.addEventListener("DOMContentLoaded",J,!1),a.addEventListener("load",J,!1);else{y.attachEvent("onreadystatechange",J),a.attachEvent("onload",J);var c=!1;try{c=null==a.frameElement&&y.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!m.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}I(),m.ready()}}()}return H.promise(b)};var K="undefined",L;for(L in m(k))break;k.ownLast="0"!==L,k.inlineBlockNeedsLayout=!1,m(function(){var a,b,c,d;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",k.inlineBlockNeedsLayout=a=3===b.offsetWidth,a&&(c.style.zoom=1)),c.removeChild(d))}),function(){var a=y.createElement("div");if(null==k.deleteExpando){k.deleteExpando=!0;try{delete a.test}catch(b){k.deleteExpando=!1}}a=null}(),m.acceptData=function(a){var b=m.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute("classid")===b};var M=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,N=/([A-Z])/g;function O(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(N,"-$1").toLowerCase();if(c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:M.test(c)?m.parseJSON(c):c}catch(e){}m.data(a,b,c)}else c=void 0}return c}function P(a){var b;for(b in a)if(("data"!==b||!m.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;

return!0}function Q(a,b,d,e){if(m.acceptData(a)){var f,g,h=m.expando,i=a.nodeType,j=i?m.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||void 0!==d||"string"!=typeof b)return k||(k=i?a[h]=c.pop()||m.guid++:h),j[k]||(j[k]=i?{}:{toJSON:m.noop}),("object"==typeof b||"function"==typeof b)&&(e?j[k]=m.extend(j[k],b):j[k].data=m.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[m.camelCase(b)]=d),"string"==typeof b?(f=g[b],null==f&&(f=g[m.camelCase(b)])):f=g,f}}function R(a,b,c){if(m.acceptData(a)){var d,e,f=a.nodeType,g=f?m.cache:a,h=f?a[m.expando]:m.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){m.isArray(b)?b=b.concat(m.map(b,m.camelCase)):b in d?b=[b]:(b=m.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;while(e--)delete d[b[e]];if(c?!P(d):!m.isEmptyObject(d))return}(c||(delete g[h].data,P(g[h])))&&(f?m.cleanData([a],!0):k.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}m.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?m.cache[a[m.expando]]:a[m.expando],!!a&&!P(a)},data:function(a,b,c){return Q(a,b,c)},removeData:function(a,b){return R(a,b)},_data:function(a,b,c){return Q(a,b,c,!0)},_removeData:function(a,b){return R(a,b,!0)}}),m.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=m.data(f),1===f.nodeType&&!m._data(f,"parsedAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=m.camelCase(d.slice(5)),O(f,d,e[d])));m._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){m.data(this,a)}):arguments.length>1?this.each(function(){m.data(this,a,b)}):f?O(f,a,m.data(f,a)):void 0},removeData:function(a){return this.each(function(){m.removeData(this,a)})}}),m.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=m._data(a,b),c&&(!d||m.isArray(c)?d=m._data(a,b,m.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=m.queue(a,b),d=c.length,e=c.shift(),f=m._queueHooks(a,b),g=function(){m.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return m._data(a,c)||m._data(a,c,{empty:m.Callbacks("once memory").add(function(){m._removeData(a,b+"queue"),m._removeData(a,c)})})}}),m.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?m.queue(this[0],a):void 0===b?this:this.each(function(){var c=m.queue(this,a,b);m._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&m.dequeue(this,a)})},dequeue:function(a){return this.each(function(){m.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=m.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=m._data(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var S=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=["Top","Right","Bottom","Left"],U=function(a,b){return a=b||a,"none"===m.css(a,"display")||!m.contains(a.ownerDocument,a)},V=m.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===m.type(c)){e=!0;for(h in c)m.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,m.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(m(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},W=/^(?:checkbox|radio)$/i;!function(){var a=y.createElement("input"),b=y.createElement("div"),c=y.createDocumentFragment();if(b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",k.leadingWhitespace=3===b.firstChild.nodeType,k.tbody=!b.getElementsByTagName("tbody").length,k.htmlSerialize=!!b.getElementsByTagName("link").length,k.html5Clone="<:nav></:nav>"!==y.createElement("nav").cloneNode(!0).outerHTML,a.type="checkbox",a.checked=!0,c.appendChild(a),k.appendChecked=a.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,c.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,k.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){k.noCloneEvent=!1}),b.cloneNode(!0).click()),null==k.deleteExpando){k.deleteExpando=!0;try{delete b.test}catch(d){k.deleteExpando=!1}}}(),function(){var b,c,d=y.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(k[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),k[b+"Bubbles"]=d.attributes[c].expando===!1);d=null}();var X=/^(?:input|select|textarea)$/i,Y=/^key/,Z=/^(?:mouse|pointer|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,_=/^([^.]*)(?:\.(.+)|)$/;function aa(){return!0}function ba(){return!1}function ca(){try{return y.activeElement}catch(a){}}m.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m._data(a);if(r){c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=m.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||(k=r.handle=function(a){return typeof m===K||a&&m.event.triggered===a.type?void 0:m.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(E)||[""],h=b.length;while(h--)f=_.exec(b[h])||[],o=q=f[1],p=(f[2]||"").split(".").sort(),o&&(j=m.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=m.event.special[o]||{},l=m.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&m.expr.match.needsContext.test(e),namespace:p.join(".")},i),(n=g[o])||(n=g[o]=[],n.delegateCount=0,j.setup&&j.setup.call(a,d,p,k)!==!1||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent("on"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?n.splice(n.delegateCount++,0,l):n.push(l),m.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m.hasData(a)&&m._data(a);if(r&&(k=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--)if(h=_.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=m.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,n=k[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=n.length;while(f--)g=n[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(n.splice(f,1),g.selector&&n.delegateCount--,l.remove&&l.remove.call(a,g));i&&!n.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||m.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)m.event.remove(a,o+b[j],c,d,!0);m.isEmptyObject(k)&&(delete r.handle,m._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,n,o=[d||y],p=j.call(b,"type")?b.type:b,q=j.call(b,"namespace")?b.namespace.split("."):[];if(h=l=d=d||y,3!==d.nodeType&&8!==d.nodeType&&!$.test(p+m.event.triggered)&&(p.indexOf(".")>=0&&(q=p.split("."),p=q.shift(),q.sort()),g=p.indexOf(":")<0&&"on"+p,b=b[m.expando]?b:new m.Event(p,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=q.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:m.makeArray(c,[b]),k=m.event.special[p]||{},e||!k.trigger||k.trigger.apply(d,c)!==!1)){if(!e&&!k.noBubble&&!m.isWindow(d)){for(i=k.delegateType||p,$.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||y)&&o.push(l.defaultView||l.parentWindow||a)}n=0;while((h=o[n++])&&!b.isPropagationStopped())b.type=n>1?i:k.bindType||p,f=(m._data(h,"events")||{})[b.type]&&m._data(h,"handle"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&m.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||k._default.apply(o.pop(),c)===!1)&&m.acceptData(d)&&g&&d[p]&&!m.isWindow(d)){l=d[g],l&&(d[g]=null),m.event.triggered=p;try{d[p]()}catch(r){}m.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=m.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(m._data(this,"events")||{})[a.type]||[],k=m.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=m.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,g=0;while((e=f.handlers[g++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,c=((m.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?m(c,this).index(i)>=0:m.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[m.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=Z.test(e)?this.mouseHooks:Y.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new m.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||y),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||y,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ca()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===ca()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return m.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return m.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=m.extend(new m.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?m.event.trigger(e,null,b):m.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},m.removeEvent=y.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===K&&(a[d]=null),a.detachEvent(d,c))},m.Event=function(a,b){return this instanceof m.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?aa:ba):this.type=a,b&&m.extend(this,b),this.timeStamp=a&&a.timeStamp||m.now(),void(this[m.expando]=!0)):new m.Event(a,b)},m.Event.prototype={isDefaultPrevented:ba,isPropagationStopped:ba,isImmediatePropagationStopped:ba,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=aa,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=aa,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=aa,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){m.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!m.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.submitBubbles||(m.event.special.submit={setup:function(){return m.nodeName(this,"form")?!1:void m.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=m.nodeName(b,"input")||m.nodeName(b,"button")?b.form:void 0;c&&!m._data(c,"submitBubbles")&&(m.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),m._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&m.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return m.nodeName(this,"form")?!1:void m.event.remove(this,"._submit")}}),k.changeBubbles||(m.event.special.change={setup:function(){return X.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(m.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),m.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),m.event.simulate("change",this,a,!0)})),!1):void m.event.add(this,"beforeactivate._change",function(a){var b=a.target;X.test(b.nodeName)&&!m._data(b,"changeBubbles")&&(m.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||m.event.simulate("change",this.parentNode,a,!0)}),m._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return m.event.remove(this,"._change"),!X.test(this.nodeName)}}),k.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){m.event.simulate(b,a.target,m.event.fix(a),!0)};m.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=m._data(d,b);e||d.addEventListener(a,c,!0),m._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=m._data(d,b)-1;e?m._data(d,b,e):(d.removeEventListener(a,c,!0),m._removeData(d,b))}}}),m.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=ba;else if(!d)return this;return 1===e&&(g=d,d=function(a){return m().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=m.guid++)),this.each(function(){m.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,m(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=ba),this.each(function(){m.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){m.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?m.event.trigger(a,b,c,!0):void 0}});function da(a){var b=ea.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}var ea="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",fa=/ jQuery\d+="(?:null|\d+)"/g,ga=new RegExp("<(?:"+ea+")[\\s/>]","i"),ha=/^\s+/,ia=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ja=/<([\w:]+)/,ka=/<tbody/i,la=/<|&#?\w+;/,ma=/<(?:script|style|link)/i,na=/checked\s*(?:[^=]|=\s*.checked.)/i,oa=/^$|\/(?:java|ecma)script/i,pa=/^true\/(.*)/,qa=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ra={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:k.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},sa=da(y),ta=sa.appendChild(y.createElement("div"));ra.optgroup=ra.option,ra.tbody=ra.tfoot=ra.colgroup=ra.caption=ra.thead,ra.th=ra.td;function ua(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==K?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==K?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||m.nodeName(d,b)?f.push(d):m.merge(f,ua(d,b));return void 0===b||b&&m.nodeName(a,b)?m.merge([a],f):f}function va(a){W.test(a.type)&&(a.defaultChecked=a.checked)}function wa(a,b){return m.nodeName(a,"table")&&m.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function xa(a){return a.type=(null!==m.find.attr(a,"type"))+"/"+a.type,a}function ya(a){var b=pa.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function za(a,b){for(var c,d=0;null!=(c=a[d]);d++)m._data(c,"globalEval",!b||m._data(b[d],"globalEval"))}function Aa(a,b){if(1===b.nodeType&&m.hasData(a)){var c,d,e,f=m._data(a),g=m._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)m.event.add(b,c,h[c][d])}g.data&&(g.data=m.extend({},g.data))}}function Ba(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!k.noCloneEvent&&b[m.expando]){e=m._data(b);for(d in e.events)m.removeEvent(b,d,e.handle);b.removeAttribute(m.expando)}"script"===c&&b.text!==a.text?(xa(b).text=a.text,ya(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),k.html5Clone&&a.innerHTML&&!m.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&W.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}m.extend({clone:function(a,b,c){var d,e,f,g,h,i=m.contains(a.ownerDocument,a);if(k.html5Clone||m.isXMLDoc(a)||!ga.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(ta.innerHTML=a.outerHTML,ta.removeChild(f=ta.firstChild)),!(k.noCloneEvent&&k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||m.isXMLDoc(a)))for(d=ua(f),h=ua(a),g=0;null!=(e=h[g]);++g)d[g]&&Ba(e,d[g]);if(b)if(c)for(h=h||ua(a),d=d||ua(f),g=0;null!=(e=h[g]);g++)Aa(e,d[g]);else Aa(a,f);return d=ua(f,"script"),d.length>0&&za(d,!i&&ua(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,l,n=a.length,o=da(b),p=[],q=0;n>q;q++)if(f=a[q],f||0===f)if("object"===m.type(f))m.merge(p,f.nodeType?[f]:f);else if(la.test(f)){h=h||o.appendChild(b.createElement("div")),i=(ja.exec(f)||["",""])[1].toLowerCase(),l=ra[i]||ra._default,h.innerHTML=l[1]+f.replace(ia,"<$1></$2>")+l[2],e=l[0];while(e--)h=h.lastChild;if(!k.leadingWhitespace&&ha.test(f)&&p.push(b.createTextNode(ha.exec(f)[0])),!k.tbody){f="table"!==i||ka.test(f)?"<table>"!==l[1]||ka.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;while(e--)m.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j)}m.merge(p,h.childNodes),h.textContent="";while(h.firstChild)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));h&&o.removeChild(h),k.appendChecked||m.grep(ua(p,"input"),va),q=0;while(f=p[q++])if((!d||-1===m.inArray(f,d))&&(g=m.contains(f.ownerDocument,f),h=ua(o.appendChild(f),"script"),g&&za(h),c)){e=0;while(f=h[e++])oa.test(f.type||"")&&c.push(f)}return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=m.expando,j=m.cache,l=k.deleteExpando,n=m.event.special;null!=(d=a[h]);h++)if((b||m.acceptData(d))&&(f=d[i],g=f&&j[f])){if(g.events)for(e in g.events)n[e]?m.event.remove(d,e):m.removeEvent(d,e,g.handle);j[f]&&(delete j[f],l?delete d[i]:typeof d.removeAttribute!==K?d.removeAttribute(i):d[i]=null,c.push(f))}}}),m.fn.extend({text:function(a){return V(this,function(a){return void 0===a?m.text(this):this.empty().append((this[0]&&this[0].ownerDocument||y).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wa(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wa(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?m.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||m.cleanData(ua(c)),c.parentNode&&(b&&m.contains(c.ownerDocument,c)&&za(ua(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&m.cleanData(ua(a,!1));while(a.firstChild)a.removeChild(a.firstChild);a.options&&m.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return m.clone(this,a,b)})},html:function(a){return V(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(fa,""):void 0;if(!("string"!=typeof a||ma.test(a)||!k.htmlSerialize&&ga.test(a)||!k.leadingWhitespace&&ha.test(a)||ra[(ja.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(ia,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(m.cleanData(ua(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,m.cleanData(ua(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,n=this,o=l-1,p=a[0],q=m.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&na.test(p))return this.each(function(c){var d=n.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(i=m.buildFragment(a,this[0].ownerDocument,!1,this),c=i.firstChild,1===i.childNodes.length&&(i=c),c)){for(g=m.map(ua(i,"script"),xa),f=g.length;l>j;j++)d=i,j!==o&&(d=m.clone(d,!0,!0),f&&m.merge(g,ua(d,"script"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,m.map(g,ya),j=0;f>j;j++)d=g[j],oa.test(d.type||"")&&!m._data(d,"globalEval")&&m.contains(h,d)&&(d.src?m._evalUrl&&m._evalUrl(d.src):m.globalEval((d.text||d.textContent||d.innerHTML||"").replace(qa,"")));i=c=null}return this}}),m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){m.fn[a]=function(a){for(var c,d=0,e=[],g=m(a),h=g.length-1;h>=d;d++)c=d===h?this:this.clone(!0),m(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Ca,Da={};function Ea(b,c){var d,e=m(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:m.css(e[0],"display");return e.detach(),f}function Fa(a){var b=y,c=Da[a];return c||(c=Ea(a,b),"none"!==c&&c||(Ca=(Ca||m("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(Ca[0].contentWindow||Ca[0].contentDocument).document,b.write(),b.close(),c=Ea(a,b),Ca.detach()),Da[a]=c),c}!function(){var a;k.shrinkWrapBlocks=function(){if(null!=a)return a;a=!1;var b,c,d;return c=y.getElementsByTagName("body")[0],c&&c.style?(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",b.appendChild(y.createElement("div")).style.width="5px",a=3!==b.offsetWidth),c.removeChild(d),a):void 0}}();var Ga=/^margin/,Ha=new RegExp("^("+S+")(?!px)[a-z%]+$","i"),Ia,Ja,Ka=/^(top|right|bottom|left)$/;a.getComputedStyle?(Ia=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)},Ja=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Ia(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||m.contains(a.ownerDocument,a)||(g=m.style(a,b)),Ha.test(g)&&Ga.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):y.documentElement.currentStyle&&(Ia=function(a){return a.currentStyle},Ja=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Ia(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),Ha.test(g)&&!Ka.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"});function La(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d,e,f,g,h;if(b=y.createElement("div"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=d&&d.style){c.cssText="float:left;opacity:.5",k.opacity="0.5"===c.opacity,k.cssFloat=!!c.cssFloat,b.style.backgroundClip="content-box",b.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===b.style.backgroundClip,k.boxSizing=""===c.boxSizing||""===c.MozBoxSizing||""===c.WebkitBoxSizing,m.extend(k,{reliableHiddenOffsets:function(){return null==g&&i(),g},boxSizingReliable:function(){return null==f&&i(),f},pixelPosition:function(){return null==e&&i(),e},reliableMarginRight:function(){return null==h&&i(),h}});function i(){var b,c,d,i;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),b.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",e=f=!1,h=!0,a.getComputedStyle&&(e="1%"!==(a.getComputedStyle(b,null)||{}).top,f="4px"===(a.getComputedStyle(b,null)||{width:"4px"}).width,i=b.appendChild(y.createElement("div")),i.style.cssText=b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",b.style.width="1px",h=!parseFloat((a.getComputedStyle(i,null)||{}).marginRight),b.removeChild(i)),b.innerHTML="<table><tr><td></td><td>t</td></tr></table>",i=b.getElementsByTagName("td"),i[0].style.cssText="margin:0;border:0;padding:0;display:none",g=0===i[0].offsetHeight,g&&(i[0].style.display="",i[1].style.display="none",g=0===i[0].offsetHeight),c.removeChild(d))}}}(),m.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Ma=/alpha\([^)]*\)/i,Na=/opacity\s*=\s*([^)]*)/,Oa=/^(none|table(?!-c[ea]).+)/,Pa=new RegExp("^("+S+")(.*)$","i"),Qa=new RegExp("^([+-])=("+S+")","i"),Ra={position:"absolute",visibility:"hidden",display:"block"},Sa={letterSpacing:"0",fontWeight:"400"},Ta=["Webkit","O","Moz","ms"];function Ua(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ta.length;while(e--)if(b=Ta[e]+c,b in a)return b;return d}function Va(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=m._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&U(d)&&(f[g]=m._data(d,"olddisplay",Fa(d.nodeName)))):(e=U(d),(c&&"none"!==c||!e)&&m._data(d,"olddisplay",e?c:m.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Wa(a,b,c){var d=Pa.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Xa(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=m.css(a,c+T[f],!0,e)),d?("content"===c&&(g-=m.css(a,"padding"+T[f],!0,e)),"margin"!==c&&(g-=m.css(a,"border"+T[f]+"Width",!0,e))):(g+=m.css(a,"padding"+T[f],!0,e),"padding"!==c&&(g+=m.css(a,"border"+T[f]+"Width",!0,e)));return g}function Ya(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ia(a),g=k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Ja(a,b,f),(0>e||null==e)&&(e=a.style[b]),Ha.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Xa(a,b,c||(g?"border":"content"),d,f)+"px"}m.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Ja(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":k.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=m.camelCase(b),i=a.style;if(b=m.cssProps[h]||(m.cssProps[h]=Ua(i,h)),g=m.cssHooks[b]||m.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=Qa.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(m.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||m.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=m.camelCase(b);return b=m.cssProps[h]||(m.cssProps[h]=Ua(a.style,h)),g=m.cssHooks[b]||m.cssHooks[h],g&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Ja(a,b,d)),"normal"===f&&b in Sa&&(f=Sa[b]),""===c||c?(e=parseFloat(f),c===!0||m.isNumeric(e)?e||0:f):f}}),m.each(["height","width"],function(a,b){m.cssHooks[b]={get:function(a,c,d){return c?Oa.test(m.css(a,"display"))&&0===a.offsetWidth?m.swap(a,Ra,function(){return Ya(a,b,d)}):Ya(a,b,d):void 0},set:function(a,c,d){var e=d&&Ia(a);return Wa(a,c,d?Xa(a,b,d,k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,e),e):0)}}}),k.opacity||(m.cssHooks.opacity={get:function(a,b){return Na.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=m.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===m.trim(f.replace(Ma,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Ma.test(f)?f.replace(Ma,e):f+" "+e)}}),m.cssHooks.marginRight=La(k.reliableMarginRight,function(a,b){return b?m.swap(a,{display:"inline-block"},Ja,[a,"marginRight"]):void 0}),m.each({margin:"",padding:"",border:"Width"},function(a,b){m.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+T[d]+b]=f[d]||f[d-2]||f[0];return e}},Ga.test(a)||(m.cssHooks[a+b].set=Wa)}),m.fn.extend({css:function(a,b){return V(this,function(a,b,c){var d,e,f={},g=0;if(m.isArray(b)){for(d=Ia(a),e=b.length;e>g;g++)f[b[g]]=m.css(a,b[g],!1,d);return f}return void 0!==c?m.style(a,b,c):m.css(a,b)},a,b,arguments.length>1)},show:function(){return Va(this,!0)},hide:function(){return Va(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){U(this)?m(this).show():m(this).hide()})}});function Za(a,b,c,d,e){
return new Za.prototype.init(a,b,c,d,e)}m.Tween=Za,Za.prototype={constructor:Za,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(m.cssNumber[c]?"":"px")},cur:function(){var a=Za.propHooks[this.prop];return a&&a.get?a.get(this):Za.propHooks._default.get(this)},run:function(a){var b,c=Za.propHooks[this.prop];return this.options.duration?this.pos=b=m.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Za.propHooks._default.set(this),this}},Za.prototype.init.prototype=Za.prototype,Za.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=m.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){m.fx.step[a.prop]?m.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[m.cssProps[a.prop]]||m.cssHooks[a.prop])?m.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Za.propHooks.scrollTop=Za.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},m.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},m.fx=Za.prototype.init,m.fx.step={};var $a,_a,ab=/^(?:toggle|show|hide)$/,bb=new RegExp("^(?:([+-])=|)("+S+")([a-z%]*)$","i"),cb=/queueHooks$/,db=[ib],eb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=bb.exec(b),f=e&&e[3]||(m.cssNumber[a]?"":"px"),g=(m.cssNumber[a]||"px"!==f&&+d)&&bb.exec(m.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,m.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function fb(){return setTimeout(function(){$a=void 0}),$a=m.now()}function gb(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=T[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function hb(a,b,c){for(var d,e=(eb[b]||[]).concat(eb["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function ib(a,b,c){var d,e,f,g,h,i,j,l,n=this,o={},p=a.style,q=a.nodeType&&U(a),r=m._data(a,"fxshow");c.queue||(h=m._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,n.always(function(){n.always(function(){h.unqueued--,m.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=m.css(a,"display"),l="none"===j?m._data(a,"olddisplay")||Fa(a.nodeName):j,"inline"===l&&"none"===m.css(a,"float")&&(k.inlineBlockNeedsLayout&&"inline"!==Fa(a.nodeName)?p.zoom=1:p.display="inline-block")),c.overflow&&(p.overflow="hidden",k.shrinkWrapBlocks()||n.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],ab.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(q?"hide":"show")){if("show"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||m.style(a,d)}else j=void 0;if(m.isEmptyObject(o))"inline"===("none"===j?Fa(a.nodeName):j)&&(p.display=j);else{r?"hidden"in r&&(q=r.hidden):r=m._data(a,"fxshow",{}),f&&(r.hidden=!q),q?m(a).show():n.done(function(){m(a).hide()}),n.done(function(){var b;m._removeData(a,"fxshow");for(b in o)m.style(a,b,o[b])});for(d in o)g=hb(q?r[d]:0,d,n),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function jb(a,b){var c,d,e,f,g;for(c in a)if(d=m.camelCase(c),e=b[d],f=a[c],m.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=m.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function kb(a,b,c){var d,e,f=0,g=db.length,h=m.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=$a||fb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:m.extend({},b),opts:m.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:$a||fb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=m.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(jb(k,j.opts.specialEasing);g>f;f++)if(d=db[f].call(j,a,k,j.opts))return d;return m.map(k,hb,j),m.isFunction(j.opts.start)&&j.opts.start.call(a,j),m.fx.timer(m.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}m.Animation=m.extend(kb,{tweener:function(a,b){m.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],eb[c]=eb[c]||[],eb[c].unshift(b)},prefilter:function(a,b){b?db.unshift(a):db.push(a)}}),m.speed=function(a,b,c){var d=a&&"object"==typeof a?m.extend({},a):{complete:c||!c&&b||m.isFunction(a)&&a,duration:a,easing:c&&b||b&&!m.isFunction(b)&&b};return d.duration=m.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in m.fx.speeds?m.fx.speeds[d.duration]:m.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){m.isFunction(d.old)&&d.old.call(this),d.queue&&m.dequeue(this,d.queue)},d},m.fn.extend({fadeTo:function(a,b,c,d){return this.filter(U).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=m.isEmptyObject(a),f=m.speed(b,c,d),g=function(){var b=kb(this,m.extend({},a),f);(e||m._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=m.timers,g=m._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&cb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&m.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=m._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=m.timers,g=d?d.length:0;for(c.finish=!0,m.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),m.each(["toggle","show","hide"],function(a,b){var c=m.fn[b];m.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(gb(b,!0),a,d,e)}}),m.each({slideDown:gb("show"),slideUp:gb("hide"),slideToggle:gb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){m.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),m.timers=[],m.fx.tick=function(){var a,b=m.timers,c=0;for($a=m.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||m.fx.stop(),$a=void 0},m.fx.timer=function(a){m.timers.push(a),a()?m.fx.start():m.timers.pop()},m.fx.interval=13,m.fx.start=function(){_a||(_a=setInterval(m.fx.tick,m.fx.interval))},m.fx.stop=function(){clearInterval(_a),_a=null},m.fx.speeds={slow:600,fast:200,_default:400},m.fn.delay=function(a,b){return a=m.fx?m.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e;b=y.createElement("div"),b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=y.createElement("select"),e=c.appendChild(y.createElement("option")),a=b.getElementsByTagName("input")[0],d.style.cssText="top:1px",k.getSetAttribute="t"!==b.className,k.style=/top/.test(d.getAttribute("style")),k.hrefNormalized="/a"===d.getAttribute("href"),k.checkOn=!!a.value,k.optSelected=e.selected,k.enctype=!!y.createElement("form").enctype,c.disabled=!0,k.optDisabled=!e.disabled,a=y.createElement("input"),a.setAttribute("value",""),k.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),k.radioValue="t"===a.value}();var lb=/\r/g;m.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=m.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,m(this).val()):a,null==e?e="":"number"==typeof e?e+="":m.isArray(e)&&(e=m.map(e,function(a){return null==a?"":a+""})),b=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=m.valHooks[e.type]||m.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(lb,""):null==c?"":c)}}}),m.extend({valHooks:{option:{get:function(a){var b=m.find.attr(a,"value");return null!=b?b:m.trim(m.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&m.nodeName(c.parentNode,"optgroup"))){if(b=m(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=m.makeArray(b),g=e.length;while(g--)if(d=e[g],m.inArray(m.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),m.each(["radio","checkbox"],function(){m.valHooks[this]={set:function(a,b){return m.isArray(b)?a.checked=m.inArray(m(a).val(),b)>=0:void 0}},k.checkOn||(m.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var mb,nb,ob=m.expr.attrHandle,pb=/^(?:checked|selected)$/i,qb=k.getSetAttribute,rb=k.input;m.fn.extend({attr:function(a,b){return V(this,m.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){m.removeAttr(this,a)})}}),m.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===K?m.prop(a,b,c):(1===f&&m.isXMLDoc(a)||(b=b.toLowerCase(),d=m.attrHooks[b]||(m.expr.match.bool.test(b)?nb:mb)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=m.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void m.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++])d=m.propFix[c]||c,m.expr.match.bool.test(c)?rb&&qb||!pb.test(c)?a[d]=!1:a[m.camelCase("default-"+c)]=a[d]=!1:m.attr(a,c,""),a.removeAttribute(qb?c:d)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&m.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),nb={set:function(a,b,c){return b===!1?m.removeAttr(a,c):rb&&qb||!pb.test(c)?a.setAttribute(!qb&&m.propFix[c]||c,c):a[m.camelCase("default-"+c)]=a[c]=!0,c}},m.each(m.expr.match.bool.source.match(/\w+/g),function(a,b){var c=ob[b]||m.find.attr;ob[b]=rb&&qb||!pb.test(b)?function(a,b,d){var e,f;return d||(f=ob[b],ob[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,ob[b]=f),e}:function(a,b,c){return c?void 0:a[m.camelCase("default-"+b)]?b.toLowerCase():null}}),rb&&qb||(m.attrHooks.value={set:function(a,b,c){return m.nodeName(a,"input")?void(a.defaultValue=b):mb&&mb.set(a,b,c)}}),qb||(mb={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},ob.id=ob.name=ob.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},m.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:mb.set},m.attrHooks.contenteditable={set:function(a,b,c){mb.set(a,""===b?!1:b,c)}},m.each(["width","height"],function(a,b){m.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),k.style||(m.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var sb=/^(?:input|select|textarea|button|object)$/i,tb=/^(?:a|area)$/i;m.fn.extend({prop:function(a,b){return V(this,m.prop,a,b,arguments.length>1)},removeProp:function(a){return a=m.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),m.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!m.isXMLDoc(a),f&&(b=m.propFix[b]||b,e=m.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=m.find.attr(a,"tabindex");return b?parseInt(b,10):sb.test(a.nodeName)||tb.test(a.nodeName)&&a.href?0:-1}}}}),k.hrefNormalized||m.each(["href","src"],function(a,b){m.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),k.optSelected||(m.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),m.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){m.propFix[this.toLowerCase()]=this}),k.enctype||(m.propFix.enctype="encoding");var ub=/[\t\r\n\f]/g;m.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ub," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=m.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ub," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?m.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(m.isFunction(a)?function(c){m(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=m(this),f=a.match(E)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===K||"boolean"===c)&&(this.className&&m._data(this,"__className__",this.className),this.className=this.className||a===!1?"":m._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ub," ").indexOf(b)>=0)return!0;return!1}}),m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){m.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),m.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var vb=m.now(),wb=/\?/,xb=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;m.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=m.trim(b+"");return e&&!m.trim(e.replace(xb,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():m.error("Invalid JSON: "+b)},m.parseXML=function(b){var c,d;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||m.error("Invalid XML: "+b),c};var yb,zb,Ab=/#.*$/,Bb=/([?&])_=[^&]*/,Cb=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Db=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Eb=/^(?:GET|HEAD)$/,Fb=/^\/\//,Gb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Hb={},Ib={},Jb="*/".concat("*");try{zb=location.href}catch(Kb){zb=y.createElement("a"),zb.href="",zb=zb.href}yb=Gb.exec(zb.toLowerCase())||[];function Lb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(m.isFunction(c))while(d=f[e++])"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Mb(a,b,c,d){var e={},f=a===Ib;function g(h){var i;return e[h]=!0,m.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Nb(a,b){var c,d,e=m.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&m.extend(!0,a,c),a}function Ob(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Pb(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:zb,type:"GET",isLocal:Db.test(yb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Jb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Nb(Nb(a,m.ajaxSettings),b):Nb(m.ajaxSettings,a)},ajaxPrefilter:Lb(Hb),ajaxTransport:Lb(Ib),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=m.ajaxSetup({},b),l=k.context||k,n=k.context&&(l.nodeType||l.jquery)?m(l):m.event,o=m.Deferred(),p=m.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j){j={};while(b=Cb.exec(f))j[b[1].toLowerCase()]=b[2]}b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||zb)+"").replace(Ab,"").replace(Fb,yb[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=m.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(c=Gb.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===yb[1]&&c[2]===yb[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(yb[3]||("http:"===yb[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=m.param(k.data,k.traditional)),Mb(Hb,k,b,v),2===t)return v;h=m.event&&k.global,h&&0===m.active++&&m.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!Eb.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(wb.test(e)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=Bb.test(e)?e.replace(Bb,"$1_="+vb++):e+(wb.test(e)?"&":"?")+"_="+vb++)),k.ifModified&&(m.lastModified[e]&&v.setRequestHeader("If-Modified-Since",m.lastModified[e]),m.etag[e]&&v.setRequestHeader("If-None-Match",m.etag[e])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+Jb+"; q=0.01":""):k.accepts["*"]);for(d in k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(d in{success:1,error:1,complete:1})v[d](k[d]);if(i=Mb(Ib,k,b,v)){v.readyState=1,h&&n.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Ob(k,v,c)),u=Pb(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(m.lastModified[e]=w),w=v.getResponseHeader("etag"),w&&(m.etag[e]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&n.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(n.trigger("ajaxComplete",[v,k]),--m.active||m.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return m.get(a,b,c,"json")},getScript:function(a,b){return m.get(a,void 0,b,"script")}}),m.each(["get","post"],function(a,b){m[b]=function(a,c,d,e){return m.isFunction(c)&&(e=e||d,d=c,c=void 0),m.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),m._evalUrl=function(a){return m.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},m.fn.extend({wrapAll:function(a){if(m.isFunction(a))return this.each(function(b){m(this).wrapAll(a.call(this,b))});if(this[0]){var b=m(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&1===a.firstChild.nodeType)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(m.isFunction(a)?function(b){m(this).wrapInner(a.call(this,b))}:function(){var b=m(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=m.isFunction(a);return this.each(function(c){m(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)}).end()}}),m.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!k.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||m.css(a,"display"))},m.expr.filters.visible=function(a){return!m.expr.filters.hidden(a)};var Qb=/%20/g,Rb=/\[\]$/,Sb=/\r?\n/g,Tb=/^(?:submit|button|image|reset|file)$/i,Ub=/^(?:input|select|textarea|keygen)/i;function Vb(a,b,c,d){var e;if(m.isArray(b))m.each(b,function(b,e){c||Rb.test(a)?d(a,e):Vb(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==m.type(b))d(a,b);else for(e in b)Vb(a+"["+e+"]",b[e],c,d)}m.param=function(a,b){var c,d=[],e=function(a,b){b=m.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=m.ajaxSettings&&m.ajaxSettings.traditional),m.isArray(a)||a.jquery&&!m.isPlainObject(a))m.each(a,function(){e(this.name,this.value)});else for(c in a)Vb(c,a[c],b,e);return d.join("&").replace(Qb,"+")},m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=m.prop(this,"elements");return a?m.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!m(this).is(":disabled")&&Ub.test(this.nodeName)&&!Tb.test(a)&&(this.checked||!W.test(a))}).map(function(a,b){var c=m(this).val();return null==c?null:m.isArray(c)?m.map(c,function(a){return{name:b.name,value:a.replace(Sb,"\r\n")}}):{name:b.name,value:c.replace(Sb,"\r\n")}}).get()}}),m.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&Zb()||$b()}:Zb;var Wb=0,Xb={},Yb=m.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Xb)Xb[a](void 0,!0)}),k.cors=!!Yb&&"withCredentials"in Yb,Yb=k.ajax=!!Yb,Yb&&m.ajaxTransport(function(a){if(!a.crossDomain||k.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Wb;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Xb[g],b=void 0,f.onreadystatechange=m.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Xb[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}});function Zb(){try{return new a.XMLHttpRequest}catch(b){}}function $b(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return m.globalEval(a),a}}}),m.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),m.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=y.head||m("head")[0]||y.documentElement;return{send:function(d,e){b=y.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var _b=[],ac=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=_b.pop()||m.expando+"_"+vb++;return this[a]=!0,a}}),m.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(ac.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&ac.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=m.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(ac,"$1"+e):b.jsonp!==!1&&(b.url+=(wb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||m.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,_b.push(e)),g&&m.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),m.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||y;var d=u.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=m.buildFragment([a],b,e),e&&e.length&&m(e).remove(),m.merge([],d.childNodes))};var bc=m.fn.load;m.fn.load=function(a,b,c){if("string"!=typeof a&&bc)return bc.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=m.trim(a.slice(h,a.length)),a=a.slice(0,h)),m.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),g.length>0&&m.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?m("<div>").append(m.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){m.fn[b]=function(a){return this.on(b,a)}}),m.expr.filters.animated=function(a){return m.grep(m.timers,function(b){return a===b.elem}).length};var cc=a.document.documentElement;function dc(a){return m.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}m.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=m.css(a,"position"),l=m(a),n={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=m.css(a,"top"),i=m.css(a,"left"),j=("absolute"===k||"fixed"===k)&&m.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),m.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(n.top=b.top-h.top+g),null!=b.left&&(n.left=b.left-h.left+e),"using"in b?b.using.call(a,n):l.css(n)}},m.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){m.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,m.contains(b,e)?(typeof e.getBoundingClientRect!==K&&(d=e.getBoundingClientRect()),c=dc(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===m.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),m.nodeName(a[0],"html")||(c=a.offset()),c.top+=m.css(a[0],"borderTopWidth",!0),c.left+=m.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-m.css(d,"marginTop",!0),left:b.left-c.left-m.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||cc;while(a&&!m.nodeName(a,"html")&&"static"===m.css(a,"position"))a=a.offsetParent;return a||cc})}}),m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);m.fn[a]=function(d){return V(this,function(a,d,e){var f=dc(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?m(f).scrollLeft():e,c?e:m(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),m.each(["top","left"],function(a,b){m.cssHooks[b]=La(k.pixelPosition,function(a,c){return c?(c=Ja(a,b),Ha.test(c)?m(a).position()[b]+"px":c):void 0})}),m.each({Height:"height",Width:"width"},function(a,b){m.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){m.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return V(this,function(b,c,d){var e;return m.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?m.css(b,c,g):m.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),m.fn.size=function(){return this.length},m.fn.andSelf=m.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return m});var ec=a.jQuery,fc=a.$;return m.noConflict=function(b){return a.$===m&&(a.$=fc),b&&a.jQuery===m&&(a.jQuery=ec),m},typeof b===K&&(a.jQuery=a.$=m),m});
</script>
<style type="text/css">
.container-fluid.crosstalk-bscols {
margin-left: -30px;
margin-right: -30px;
white-space: normal;
}

body > .container-fluid.crosstalk-bscols {
margin-left: auto;
margin-right: auto;
}
.crosstalk-input-checkboxgroup .crosstalk-options-group .crosstalk-options-column {
display: inline-block;
padding-right: 12px;
vertical-align: top;
}
@media only screen and (max-width:480px) {
.crosstalk-input-checkboxgroup .crosstalk-options-group .crosstalk-options-column {
display: block;
padding-right: inherit;
}
}
</style>
<script>!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a),this._types={},this._seq=0}return e(a,[{key:"on",value:function(a,b){var c=this._types[a];c||(c=this._types[a]={});var d="sub"+this._seq++;return c[d]=b,d}},{key:"off",value:function(a,b){var c=this._types[a];if("function"==typeof b){for(var d in c)if(c.hasOwnProperty(d)&&c[d]===b)return delete c[d],d;return!1}if("string"==typeof b)return!(!c||!c[b])&&(delete c[b],b);throw new Error("Unexpected type for listener")}},{key:"trigger",value:function(a,b,c){var d=this._types[a];for(var e in d)d.hasOwnProperty(e)&&d[e].call(c,b)}}]),a}();c.default=f},{}],2:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a){var b=a.var("filterset"),c=b.get();return c||(c=new m.default,b.set(c)),c}function h(){return r++}Object.defineProperty(c,"__esModule",{value:!0}),c.FilterHandle=void 0;var i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=a("./events"),k=e(j),l=a("./filterset"),m=e(l),n=a("./group"),o=e(n),p=a("./util"),q=d(p),r=1;c.FilterHandle=function(){function a(b,c){f(this,a),this._eventRelay=new k.default,this._emitter=new q.SubscriptionTracker(this._eventRelay),this._group=null,this._filterSet=null,this._filterVar=null,this._varOnChangeSub=null,this._extraInfo=q.extend({sender:this},c),this._id="filter"+h(),this.setGroup(b)}return i(a,[{key:"setGroup",value:function(a){var b=this;if(this._group!==a&&(this._group||a)&&(this._filterVar&&(this._filterVar.off("change",this._varOnChangeSub),this.clear(),this._varOnChangeSub=null,this._filterVar=null,this._filterSet=null),this._group=a,a)){a=(0,o.default)(a),this._filterSet=g(a),this._filterVar=(0,o.default)(a).var("filter");var c=this._filterVar.on("change",function(a){b._eventRelay.trigger("change",a,b)});this._varOnChangeSub=c}}},{key:"_mergeExtraInfo",value:function(a){return q.extend({},this._extraInfo?this._extraInfo:null,a?a:null)}},{key:"close",value:function(){this._emitter.removeAllListeners(),this.clear(),this.setGroup(null)}},{key:"clear",value:function(a){this._filterSet&&(this._filterSet.clear(this._id),this._onChange(a))}},{key:"set",value:function(a,b){this._filterSet&&(this._filterSet.update(this._id,a),this._onChange(b))}},{key:"on",value:function(a,b){return this._emitter.on(a,b)}},{key:"off",value:function(a,b){return this._emitter.off(a,b)}},{key:"_onChange",value:function(a){this._filterSet&&this._filterVar.set(this._filterSet.value,this._mergeExtraInfo(a))}},{key:"filteredKeys",get:function(){return this._filterSet?this._filterSet.value:null}}]),a}()},{"./events":1,"./filterset":3,"./group":4,"./util":11}],3:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){return a===b?0:a<b?-1:a>b?1:void 0}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./util"),h=function(){function a(){d(this,a),this.reset()}return f(a,[{key:"reset",value:function(){this._handles={},this._keys={},this._value=null,this._activeHandles=0}},{key:"update",value:function(a,b){null!==b&&(b=b.slice(0),b.sort(e));var c=(0,g.diffSortedLists)(this._handles[a],b),d=c.added,f=c.removed;this._handles[a]=b;for(var h=0;h<d.length;h++)this._keys[d[h]]=(this._keys[d[h]]||0)+1;for(var i=0;i<f.length;i++)this._keys[f[i]]--;this._updateValue(b)}},{key:"_updateValue",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._allKeys,b=Object.keys(this._handles).length;if(0===b)this._value=null;else{this._value=[];for(var c=0;c<a.length;c++){var d=this._keys[a[c]];d===b&&this._value.push(a[c])}}}},{key:"clear",value:function(a){if("undefined"!=typeof this._handles[a]){var b=this._handles[a];b||(b=[]);for(var c=0;c<b.length;c++)this._keys[b[c]]--;delete this._handles[a],this._updateValue()}}},{key:"value",get:function(){return this._value}},{key:"_allKeys",get:function(){var a=Object.keys(this._keys);return a.sort(e),a}}]),a}();c.default=h},{"./util":11}],4:[function(a,b,c){(function(b){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a){if(a&&"string"==typeof a)return k.hasOwnProperty(a)||(k[a]=new l(a)),k[a];if("object"===("undefined"==typeof a?"undefined":h(a))&&a._vars&&a.var)return a;if(Array.isArray(a)&&1==a.length&&"string"==typeof a[0])return f(a[0]);throw new Error("Invalid groupName argument")}Object.defineProperty(c,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};c.default=f;var i=a("./var"),j=d(i);b.__crosstalk_groups=b.__crosstalk_groups||{};var k=b.__crosstalk_groups,l=function(){function a(b){e(this,a),this.name=b,this._vars={}}return g(a,[{key:"var",value:function(a){if(!a||"string"!=typeof a)throw new Error("Invalid var name");return this._vars.hasOwnProperty(a)||(this._vars[a]=new j.default(this,a)),this._vars[a]}},{key:"has",value:function(a){if(!a||"string"!=typeof a)throw new Error("Invalid var name");return this._vars.hasOwnProperty(a)}}]),a}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./var":12}],5:[function(a,b,c){(function(b){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){return k.var(a)}function f(a){return k.has(a)}Object.defineProperty(c,"__esModule",{value:!0});var g=a("./group"),h=d(g),i=a("./selection"),j=a("./filter");a("./input"),a("./input_selectize"),a("./input_checkboxgroup"),a("./input_slider");var k=(0,h.default)("default");b.Shiny&&b.Shiny.addCustomMessageHandler("update-client-value",function(a){"string"==typeof a.group?(0,h.default)(a.group).var(a.name).set(a.value):e(a.name).set(a.value)});var l={group:h.default,var:e,has:f,SelectionHandle:i.SelectionHandle,FilterHandle:j.FilterHandle};c.default=l,b.crosstalk=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./filter":2,"./group":4,"./input":6,"./input_checkboxgroup":7,"./input_selectize":8,"./input_slider":9,"./selection":10}],6:[function(a,b,c){(function(a){"use strict";function b(b){i[b.className]=b,a.document&&"complete"!==a.document.readyState?h(function(){d()}):a.document&&setTimeout(d,100)}function d(){Object.keys(i).forEach(function(a){var b=i[a];h("."+b.className).not(".crosstalk-input-bound").each(function(a,c){g(b,c)})})}function e(a){return a.replace(/([!"#$%&'()*+,.\/:;<=>?@\[\\\]^`{|}~])/g,"\\$1")}function f(a){var b=h(a);Object.keys(i).forEach(function(c){if(b.hasClass(c)&&!b.hasClass("crosstalk-input-bound")){var d=i[c];g(d,a)}})}function g(a,b){var c=h(b).find("script[type='application/json'][data-for='"+e(b.id)+"']"),d=JSON.parse(c[0].innerText),f=a.factory(b,d);h(b).data("crosstalk-instance",f),h(b).addClass("crosstalk-input-bound")}Object.defineProperty(c,"__esModule",{value:!0}),c.register=b;var h=a.jQuery,i={};a.Shiny&&!function(){var b=new a.Shiny.InputBinding,c=a.jQuery;c.extend(b,{find:function(a){return c(a).find(".crosstalk-input")},initialize:function(a){c(a).hasClass("crosstalk-input-bound")||f(a)},getId:function(a){return a.id},getValue:function(a){},setValue:function(a,b){},receiveMessage:function(a,b){},subscribe:function(a,b){c(a).data("crosstalk-instance").resume()},unsubscribe:function(a){c(a).data("crosstalk-instance").suspend()}}),a.Shiny.inputBindings.register(b,"crosstalk.inputBinding")}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(a,b,c){(function(b){"use strict";function c(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}var d=a("./input"),e=c(d),f=a("./filter"),g=b.jQuery;e.register({className:"crosstalk-input-checkboxgroup",factory:function(a,b){var c=new f.FilterHandle(b.group),d=void 0,e=g(a);return e.on("change","input[type='checkbox']",function(){var a=e.find("input[type='checkbox']:checked");0===a.length?(d=null,c.clear()):!function(){var e={};a.each(function(){b.map[this.value].forEach(function(a){e[a]=!0})});var f=Object.keys(e);f.sort(),d=f,c.set(f)}()}),{suspend:function(){c.clear()},resume:function(){d&&c.set(d)}}}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./filter":2,"./input":6}],8:[function(a,b,c){(function(b){"use strict";function c(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}var d=a("./input"),e=c(d),f=a("./util"),g=c(f),h=a("./filter"),i=b.jQuery;e.register({className:"crosstalk-input-select",factory:function(a,b){var c=[{value:"",label:"(All)"}],d=g.dataframeToD3(b.items),e={options:c.concat(d),valueField:"value",labelField:"label",searchField:"label"},f=i(a).find("select")[0],j=i(f).selectize(e)[0].selectize,k=new h.FilterHandle(b.group),l=void 0;return j.on("change",function(){0===j.items.length?(l=null,k.clear()):!function(){var a={};j.items.forEach(function(c){b.map[c].forEach(function(b){a[b]=!0})});var c=Object.keys(a);c.sort(),l=c,k.set(c)}()}),{suspend:function(){k.clear()},resume:function(){l&&k.set(l)}}}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./filter":2,"./input":6,"./util":11}],9:[function(a,b,c){(function(b){"use strict";function c(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function d(a,b){for(var c=a.toString();c.length<b;)c="0"+c;return c}function e(a){return a instanceof Date?a.getUTCFullYear()+"-"+d(a.getUTCMonth()+1,2)+"-"+d(a.getUTCDate(),2):null}var f=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=a("./input"),h=c(g),i=a("./filter"),j=b.jQuery,k=b.strftime;h.register({className:"crosstalk-input-slider",factory:function(a,b){function c(){var a=h.data("ionRangeSlider").result,b=void 0,c=h.data("data-type");return b="date"===c?function(a){return e(new Date(+a))}:"datetime"===c?function(a){return+a/1e3}:function(a){return+a},"double"===h.data("ionRangeSlider").options.type?[b(a.from),b(a.to)]:b(a.from)}var d=new i.FilterHandle(b.group),g={},h=j(a).find("input"),l=h.data("data-type"),m=h.data("time-format"),n=void 0;if("date"===l)n=k.utc(),g.prettify=function(a){return n(m,new Date(a))};else if("datetime"===l){var o=h.data("timezone");n=o?k.timezone(o):k,g.prettify=function(a){return n(m,new Date(a))}}h.ionRangeSlider(g);var p=null;return h.on("change.crosstalkSliderInput",function(a){if(!h.data("updating")&&!h.data("animating")){for(var e=c(),g=f(e,2),i=g[0],j=g[1],k=[],l=0;l<b.values.length;l++){var m=b.values[l];m>=i&&m<=j&&k.push(b.keys[l])}k.sort(),d.set(k),p=k}}),{suspend:function(){d.clear()},resume:function(){p&&d.set(p)}}}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./filter":2,"./input":6}],10:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionHandle=void 0;var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./events"),i=e(h),j=a("./group"),k=e(j),l=a("./util"),m=d(l);c.SelectionHandle=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;f(this,a),this._eventRelay=new i.default,this._emitter=new m.SubscriptionTracker(this._eventRelay),this._group=null,this._var=null,this._varOnChangeSub=null,this._extraInfo=m.extend({sender:this},c),this.setGroup(b)}return g(a,[{key:"setGroup",value:function(a){var b=this;if(this._group!==a&&(this._group||a)&&(this._var&&(this._var.off("change",this._varOnChangeSub),this._var=null,this._varOnChangeSub=null),this._group=a,a)){this._var=(0,k.default)(a).var("selection");var c=this._var.on("change",function(a){b._eventRelay.trigger("change",a,b)});this._varOnChangeSub=c}}},{key:"_mergeExtraInfo",value:function(a){return m.extend({},this._extraInfo?this._extraInfo:null,a?a:null)}},{key:"set",value:function(a,b){this._var&&this._var.set(a,this._mergeExtraInfo(b))}},{key:"clear",value:function(a){this._var&&this.set(void 0,this._mergeExtraInfo(a))}},{key:"on",value:function(a,b){return this._emitter.on(a,b)}},{key:"off",value:function(a,b){return this._emitter.off(a,b)}},{key:"close",value:function(){this._emitter.removeAllListeners(),this.setGroup(null)}},{key:"value",get:function(){return this._var?this._var.get():null}}]),a}()},{"./events":1,"./group":4,"./util":11}],11:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];for(var e=0;e<c.length;e++){var f=c[e];if("undefined"!=typeof f&&null!==f)for(var g in f)f.hasOwnProperty(g)&&(a[g]=f[g])}return a}function f(a){for(var b=1;b<a.length;b++)if(a[b]<=a[b-1])throw new Error("List is not sorted or contains duplicate")}function g(a,b){var c=0,d=0;a||(a=[]),b||(b=[]);var e=[],g=[];for(f(a),f(b);c<a.length&&d<b.length;)a[c]===b[d]?(c++,d++):a[c]<b[d]?e.push(a[c++]):g.push(b[d++]);return c<a.length&&(e=e.concat(a.slice(c))),d<b.length&&(g=g.concat(b.slice(d))),{removed:e,added:g}}function h(a){var b=[],c=void 0;for(var d in a){if(a.hasOwnProperty(d)&&b.push(d),"object"!==j(a[d])||"undefined"==typeof a[d].length)throw new Error("All fields must be arrays");if("undefined"!=typeof c&&c!==a[d].length)throw new Error("All fields must be arrays of the same length");c=a[d].length}for(var e=[],f=void 0,g=0;g<c;g++){f={};for(var h=0;h<b.length;h++)f[b[h]]=a[b[h]][g];e.push(f)}return e}Object.defineProperty(c,"__esModule",{value:!0});var i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};c.extend=e,c.checkSorted=f,c.diffSortedLists=g,c.dataframeToD3=h;c.SubscriptionTracker=function(){function a(b){d(this,a),this._emitter=b,this._subs={}}return i(a,[{key:"on",value:function(a,b){var c=this._emitter.on(a,b);return this._subs[c]=a,c}},{key:"off",value:function(a,b){var c=this._emitter.off(a,b);return c&&delete this._subs[c],c}},{key:"removeAllListeners",value:function(){var a=this,b=this._subs;this._subs={},Object.keys(b).forEach(function(c){a._emitter.off(b[c],c)})}}]),a}()},{}],12:[function(a,b,c){(function(b){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./events"),i=d(h),j=function(){function a(b,c,d){e(this,a),this._group=b,this._name=c,this._value=d,this._events=new i.default}return g(a,[{key:"get",value:function(){return this._value}},{key:"set",value:function(a,c){if(this._value!==a){var d=this._value;this._value=a;var e={};if(c&&"object"===("undefined"==typeof c?"undefined":f(c)))for(var g in c)c.hasOwnProperty(g)&&(e[g]=c[g]);e.oldValue=d,e.value=a,this._events.trigger("change",e,this),b.Shiny&&b.Shiny.onInputChange&&b.Shiny.onInputChange(".clientValue-"+(null!==this._group.name?this._group.name+"-":"")+this._name,"undefined"==typeof a?null:a)}}},{key:"on",value:function(a,b){return this._events.on(a,b)}},{key:"off",value:function(a,b){return this._events.off(a,b)}}]),a}();c.default=j}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./events":1}]},{},[5]);
//# sourceMappingURL=crosstalk.min.js.map</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">testOTM Vignette</h1>
<h4 class="author">Peng Xu</h4>
<h4 class="date">21 November 2019</h4>



<p><code>testOTM</code> is a package that computes multivariate ranks and quantiles defined through the theory of optimal transports. It also provides several applications of these statistics, most notably the two-sample multivariate goodness-of-fit testing.</p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>As mentioned, the core of the definitions used by this package is optimal transport: given Borel (probabiliy) measures <span class="math inline">\(\mu\)</span> (source) and <span class="math inline">\(\nu\)</span> (target), whose convex compact supports are <span class="math inline">\(\mathcal{X}\subset\mathbb{R}^d\)</span> and <span class="math inline">\(\mathcal{Y}\subset\mathbb{R}^d\)</span> respectively, a map <span class="math inline">\(T\colon\mathcal{X}\to\mathcal{Y}\)</span> attaining <span class="math display">\[\inf_{T: T\mathbin{\#}\mu=\nu}\int_{\mathcal{S}}\left\lVert s-T(s)\right\rVert_2^2\,d\mu(s)\]</span> is called the (<span class="math inline">\(L_2\)</span>-) optimal transport map, where the notation <span class="math inline">\(T\mathbin{\#}\mu=\nu\)</span> means <span class="math inline">\(\mu(T^{-1}(B))=\nu(B)\)</span> for all Borel <span class="math inline">\(B\subset\mathcal{Y}\)</span>. When <span class="math inline">\(\nu\)</span> is univariate and <span class="math inline">\(\mu\sim U[0,1]\)</span>, the map <span class="math inline">\(T\)</span> provides an analogues of the one-dimensional quantile function of <span class="math inline">\(\nu\)</span>. Thus, by substituting <span class="math inline">\(\mu\sim U[0,1]^d\)</span> when <span class="math inline">\(\nu\)</span> is of dimension <span class="math inline">\(d\)</span>, we are able to generalized the notions of quantiles and ranks, see <span class="citation">(Ghosal and Sen 2019; Chernozhukov et al. 2017)</span> for more detail.</p>
<p>In application, we do not usually know the target measure <span class="math inline">\(\nu\)</span>, but rather have a finite sample <span class="math inline">\(\{X_i\}_{i=1}^n\sim\nu\)</span>. We thus replace the unknown <span class="math inline">\(\nu\)</span> by its empirical distribution <span class="math inline">\(\hat{\nu}_n\)</span>, which satisfies <span class="math display">\[\hat{\nu}_n(B)=\frac{1}{n}\sum_{i=1}^n\delta_{X_i}(B)\]</span> for all Borel <span class="math inline">\(B\subset\mathcal{Y}\)</span>. Accordingly, we define the empirical quantile function <span class="math inline">\(\hat{Q}_n\)</span> to be the solution of the optimal transport problem when <span class="math inline">\(\hat{\nu}_n\)</span> is used. An important result, known as Brenier-McCanns Theorem <span class="citation">(Brenier 1991; McCann 1995)</span>, states that there exists a piecewise affine function <span class="math inline">\(\hat{\psi}_n\)</span> such that <span class="math inline">\(\hat{Q}_n=\nabla\hat{\psi}_n\)</span>. Through some justifications from the convex optimization theory, the empirical rank function can be defined as <span class="math display">\[\hat{R}_n(\mathbf{x})=\operatorname*{arg\,min}_{\mathbf{y}\in\mathcal{Y}}\{\mathbf{x}^\top\mathbf{y}-\hat{\psi}_n(\mathbf{y})\},\]</span> and it can be computed through linear programming.</p>
</div>
<div id="visualizing-the-transport-map-rank-and-quantiles" class="section level2">
<h2>Visualizing the Transport Map, Rank, and Quantiles</h2>
<p>When the source measure <span class="math inline">\(\mu\)</span> is continuous and target measure <span class="math inline">\(\nu\)</span> is discrete, the optimal transport problem is said to be semi-discrete. The solution in this case turns out to have a nice geomtric interpretation: it is a partition of <span class="math inline">\(\mathcal{X}\)</span> by convex polytopes, where each polytope corresponds to one of the <span class="math inline">\(X_i\)</span>s (known as the seeds in this context). This partition is called the power diagram or the Laguerre diagram (and is in fact a generalization of the Voronoi diagram), see <span class="citation">(Aurenhammer 1987)</span> for more information.</p>
<p>Efficient algorithms for solving the semi-discrete optimal transport problem in 2D/3D have been proposed in <span class="citation">(Lvy and Schwindt 2018)</span>, and are implemented in the <a href="http://alice.loria.fr/software/geogram/doc/html/index.html"><code>Geogram</code></a> library. <code>testOTM</code> provides a wrapper to <code>Geogram</code> to solve the specific problems when <span class="math inline">\(\mu\)</span> equals <span class="math inline">\(U[0,1]^2\)</span> or <span class="math inline">\(U[0,1]^3\)</span>.</p>
<p>In the following example, we demonstrate how to compute and visualize the optimal transport map from <span class="math inline">\(U[0,1]^2\)</span> to a bivariate Gaussian sample <span class="math inline">\(\{X_i\}_{i=1}^{20}\)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># generate bivariate normal sample</span></a>
<a class="sourceLine" id="cb1-2" title="2">p =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1-3" title="3">n =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb1-4" title="4">Sigma =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), p, p)</a>
<a class="sourceLine" id="cb1-5" title="5">eS =<span class="st"> </span><span class="kw">eigen</span>(Sigma, <span class="dt">symmetric =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-6" title="6">X =<span class="st"> </span><span class="kw">t</span>(eS<span class="op">$</span>vectors <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(<span class="kw">pmax</span>(eS<span class="op">$</span>values, <span class="dv">0</span>)), p) <span class="op">%*%</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(p <span class="op">*</span><span class="st"> </span>n), p))</a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co"># compute the optimal transport map from U[0, 1]^2 to X</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co"># notice that X will be automatically scaled into [0, 1] range</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co"># tos is an abbreviation for Transport Optimal Semi-discret</span></a>
<a class="sourceLine" id="cb1-11" title="11">X.OTM =<span class="st"> </span><span class="kw">tos.fit</span>(X)</a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co"># plot the restricted Voronoi diagram and the restricted Delaunay triangulation</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1-15" title="15"><span class="kw">plot</span>(X.OTM, <span class="dt">which =</span> <span class="st">&quot;Both&quot;</span>, <span class="dt">draw.center =</span> T, <span class="dt">draw.map =</span> T)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABUAAAAMACAMAAADSUD1fAAAAw1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYYdM06AAA6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmZjpmZmZmZpBmkLZmkNtmtttmtv+QOgCQZjqQZmaQkDqQkLaQtraQttuQtv+Q2/+2ZgC2Zjq2kDq2kGa2tpC2tra2ttu227a229u22/+2///bkDrbkGbbtmbbtpDbtrbb25Db27bb29vb2//b////fwD/tmb/25D/27b/29v//7b//9v////RC3kZAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAgAElEQVR4nO29iZocRZKubcUAVdCj/oGeGg3LnAMHMaI4otXAkUALVNz/Vf0Zucbim7mbubtlfO/zgCoz3c0t0i3eWDOTBgAAAFlQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCrVOAAAArEKtEwAAAKtQ6wQAAMAq1DoBAACwCmkP8Pj6t4eHh59e/6E9EAAZoD5BCaQa/dU3dOHJC9WxAOCC+gSFkGLs91/QnA+/VxwNAB6oT1AM6YV+ezcW5af3Bz4ZH9x8pTccACxQn6AcUov81+e7gvxu8sSvu4L94J9q4wHAAfUJBCC1yC9X5TiW7GesGASMIVhAyqA+t4hgAR1LQDzikceviZYHRG+JPuJc7Wz9bgM+giWkCupzmwiW0KEGpAOe2G3OV8dDrudC2FkdwQE7M4b63CIQKOgaOzOG+twihgS6O0S6Wd4Vwj9EEkwIVMDOjKE+t4ghgQ7PVtU4nnb6mBMCBWoNQzOG+twglgT67m5XoT9Pnni/q8/VRj8ICtQahmYM9blBLAl0vE9kV5H33z6M/Hi4U5l7l4hOZkALSzOG+twepgQ6/HK3uIXg5kteABSoNUzNGOpzc9gS6PD4fFqiN0+533iDArWGrRlDfW4NYwLd8fjq4fn9/f3ThxcZ3xeGArWGuRlDfW4KewItAgVqjW3N2LaW9hqAQEHXbGvGtrW01wAECrpmWzO2raW9BiBQ0DXbmrFtLe01YFyg4c8ap3x3iqsNaMlyfmQrpi7l9Qn6ZuMCVbMAyGY5Q9I1UxMI9Nq5aoGuEVw9t13sagu/JYGusb20W8S4QIc/X//OaS65em56f0Ft2a9LoKX1CXrHukCZiK6e2zWo4sHmlQmUybaW9hqAQMvClfU3yl6fSosOgQJLQKCF8QoDWOSw0BCoAtta2msAAi0NWBrBGuejd50lh0CBJSDQ4ojbKvrL8kKg8mxraa8BCLQ85JaqfrqwKssNgQJLQKASQSWiWGC+sYBAxdnW0l4DEKhIVJEw3bPc2dZYbAgUWMKQQP/6nFy0+iTSPMwGKn+9kBDoFI36BL0DgYqwAYO6FlFhoSFQYAlDAh3ef9GtQFsdxr8ZqTKSc/kg0CkK9Ql6x5JAh8evuT8Tu0Rx9RQz6O1IWtM3R2QGDuDbw1YoHwo/7hn5+uwRRn1uAFMC3VfoVyUBNFdPIYPeHklpW0ug3jMUEOgM8frsEE59bgBbAmV/PdgS1dVT5kQoo0DfvKlj0MByidePaYGK12eHQKAzjAl0eFt2kKS7ekoY9PY2vULrCDS4VBDoHOH67A9OfW4BawLdHSSVbOK1V89ygwYLlI4yO/77Zv+vskAjWwX5d1A3vjLC9dkfEOgcawId3t3f/5/83uqr5/HSa36AfW0uRDl4YtbYA40tDAQ6R7Y+++NcnjInrMxjTqBl6K+ekxtYsvqztvDq/kxYDOG30LpAy+h/aaf+hEchUHK1Kh6hpLh6ugqfsgAQqCAGlvboz7E+IVIIlFytZEbIrCzWKSb1/c+kVrJjakbvHQNLu67pTXsUAtUdIaOuejlDn5ozBCqHgaXd7Xx66nmTHoVAlUc4PGewqtKzFb6ZVjF49/S/tLsM95Xhr45teRQCVR5h8oKlmuKkCYGK0f3S0kmgAYOeW25BpBCo8gjLV23UEy9DyaWBQHvmpE4aUnO9do9CoMojOJv0Xk3M1CBQKTpf2pM5D2mykr1Wj0KgyiN4m/VbS/ykBBcCAu2XszjP/+aEuC6PQqDaQwSb9lhJGelAoEJ0vbSXHc9jmvl1ez0H9hCo9hDx9n2VUVYecrlDoL1CZ22e0yyt2SvwKASqPURip06KKDMDCFSGnpf2Ys353yKhzXoUAtUegtOzeQlljy2WMgTaKefUpgKVTdiiRyFQ7SHY3RsWUP6gEKgI/S4t+QRKrtalQ9kRKQSqPURejBbVUzScVKYQaJfM/TnJU69EbXgUAtUeoiBQ3dopGwgClaDXpaWpMYdZnurl2bdHIVDtIUqj1aqc0hHErieohDVCp0tLM2EO8zwrbt879CgEqj2ESEj1uimPDYEK0OfS0sqXszyrn2fqSaQQqPoYYmEVi0YiqkxeEGh3rP25FOj0UR268SgEqj6GbGyNkpEJB4GW0+PSkmN3c55nQ4E19ygEqj6GwgCyBSMVSCQKBNobS1mun2tp0HMCjTwKgaqPoYNctYgVHARaTIdLu3Kl48le8m5wYA+Bqo+hiECpSNaZxomATlbNSvS3tMvycAu0r8RrehQCVR9DmbJCEa0viVgQaFe4/emapsUTPVDDoxCo+hg1yC0T4bKCQAvpbWlX9eETaJ8GPaDqUQg0BdavBzerJHaR9FhOEGhHrOvDK9CeDXpA58AeAk3gzZG8MerCqBCFwxpOQPfPN0Og/eCoD79A+zfogWSPpv28OASagCWBHlPw1Yfm0cwhfmrL2yORAB28mxXpamldBRIQaF/JR4l51FOf6zDiiUkHlCRr9XzzxpxBR5abWgcag6a2hEAd9LS0IX+6E+0p+1S8awQE6mJLAt0TcqZKnqlBb2/dFQqB9kJwJ9MjUNezJlitJr76XHcUT0U6oCSbE2joTCcE2h0dLW14H9OdqGGDHlh6FAJdsD2BBo7UdfJMjDqWpqtAIdA+cJdNRKD2DXoEAvVQ4yJSR2tBSJ9Dk13Q8/t40icEOqWbpY3405toNwtQyi0E6qJEoGRPoGF/NtgFnWyKCBeR1vSytJ66iQu0myUo5KxPXESakbl6HgSaO0grIvpsLFBchXfQydL6CmfytH8X1POCISbH7xDonKLVM7VtJyUU9adWov6wJ3/S2aDRzp28mZXoY2m9hZMgUPsGPerz6m+kf3z10+/sTtsRaFyfzQRKFDidfDUCFanPJiRddvRnatugp8tH6e3FM5AOOOO3h4efx3/ffzEu5c1/MbuXrZ6pjTuooLQaqG3Q4+5n6HqccYEK12cTks5vBjLtYiHy4OrTmkB/uRuX7qM/hrd3xyXd/c2hzuqZEZX1dSUJCaSl0ESg4UU1LVDx+mxBaN8ypVUfS5HDSZ/E6iOehXTACy+Py/fxX5/vtu7395+Mf7Mi9CpQ5o1S0fETM9Cq9KhB07taWhnl67MBgdpJF2jgxW7J0actgb7bbdY//PbH3cHRfxB9Nj4zVuxXnBBbECijBiBQSRTqsz6h4kkVqEWD5unTlkCfHY6IHr++bNifMTfxxatnUnt2VO5nncKDtzwDHgscXUjDAlWoz+oEiydZoNYMelRnhj8tCXQszP3m/O3u+Oj7w3O7jT7rLNP1C7T1GZzSuHYFqlGftUn2ZyzT1gvCoUCfpgT61+f0wT9nf8z+TKJ89UzpkCfQ8NXpNLhFkHmyQSOwp6OdNVGjPisTrh6OQFsvSTqn4/Y8f0Kg3CxSOjQTqP4p8NQ9ZQh0WPyZRNuljVQPU6CRBn1QqE9TAt0dIh2OjHbHRc0O4ZOWL2u/rtyfNU6BJ59qyC0suwLVqM+qxMqHJVATBp3qk3JDyKVzjCgd8MzpjPzu38NFzv1lzroXkfKGiSIh0KwiYHZJP1m7PYFq1GdVeEfl9g161ma+Pm0J9O1uOf/++vUPRJ9etvU93saUtQsa+nxj0pA1TuEwrnYJHRL1vhZOUKjPmjDPasZT7XvqRPRpS6D7TfvIR/9vV5hPHh6+Ie5HPboVaPmIeWNCoILI12dFogXEFmjHc0eXg/Yyf9oS6OMP++Xebd1Pn/ngnaIXWj3jfWpXTrVTOMevAlG8EG9ZoPL1WY94BeUINN6mBXL6NCbQYXj135/+7em4Tf/X4cPGT3gfNRZaPaOdKhdOQRVwOx71mXK2YXsCla/PaiRUEF+gfRqUJqtLsT+tCfTC42//ff8t+/vCOhZoRpfTYPXO4RDnhn+Rk7I9roIpyNRnLfj+TEu1P4PK6tOwQPMQWj1jvWoKtPI5HMbnpTYt0DwaLW1KCeVNTGfTt9QnBdqmRiwOsYwoHVASqdUz0i3nfqKcNIbybbxmhWdtRyj8+Lpps7RJNZQ5MT3N30yZIvqEQMnVSnyYlC6ZA9U7h8MfCALl0kqgGY2SBZrWTh8NfUKg5GolPkxKl7xxihcgNYDI8XhGl27Wvyo0Wdq8g/H0wklsqArND9jF/GldoOHPGpODZQudvKoUjUwVJK4+irGDXbpY/bIprc8apA26apScagcGVdMnBEqufimEO9aoGaEySFt9NIMHe7Rf+0owINDEMfMF2nwKF++r7Nt81QJdI7h6Bnvq14xYFaimCoH2/m1MqWW0bmbEoEtfCm+ljAt0+PM16167bgXKbi9WBrrVzX8jKPzYGIX1qU5yGZUJNLmpNMr6tC9QJpKrZ6irskCrHoQUjbR1gTKpvbTpdVQi0GYGXR2ty58kgUALgqWPUxLLFV1y2sKxSkfi9odAqw6XOp6jISfXJgatoE8IlFyt5MeJd+DEls06GK14JAiUQ92lZRRSoUCbnJtYLp6GPy0K9PH1bw8PDz+9Zn5Pw54rEGjVszgCIzGztS9QyfrUhXUQXtKb3bqUWvq0J9BX39CFJy+43bsVaHpg8dDKpc1M2LhAhetTFd4xeFH3ugfxa3u6npIaSzyidMAJ77+gOR9+zwsgvHr6eyuVS82jEKmBNiRQ8frUhFNKrqbsQwte+2xcrtTSpzGBvt1/yeKn9wc+GR/csH4xwbpAax6FyI1UdLLMkkDl61MRVi0JCLSSQevq05ZA//p8V5DfTZ749Y77ld/Sq6e3O3fznNSo5lGI4EhbEahCferBqyUJgdZYOOeRuqY/TQn05aocx5L9jBPCskDV6sC5dmgPkNrWkEAV6lMNZi2JCFR96err05RAH79e/8ThW+avdomvnr7+zPpMaKJXB+pr7TYEqlGfWnCLyX2QwouhfBBPTn1q+9OSQF2fK274WXjeQJHWCfHqHYbID1RwucKOQDXqUwkRf2btgrK7pEduoU8IlFytBJAVaM3DEI2RINBE6iwtu5qkBKplULc9fU8LDy0eUTrgid0h0s3yrpDmh/CpAxUGq3cYojNQev52BapRnzoIXf7JSVZn8+xePyro05RAh2erahxPO33MCaGxejpDCL6vVQ9DlEbagkA16lMFqas/WcmKL2FTfdoS6Lu7XYX+PHni/a4+Vxv9IOvVU5OklG5HgilXOAxRHyQ5vGGBKtSnBsypHstTVKA5vULhfMl1ujcfjygd8MLL8V25uf/2YeTHw53KrLtEKgs0ZQ73/iSvQqvUQXq2BUNkNjQkUIX6VIA5zQd/OuszL1nJMvMWbZXV5jiSeETpgBN+uVv46eZLXgCV1XMaY3Y6MUVLYYHWKYT9GMoSTQ1sWaDy9SkPd4bFBSpm0EC51vOnMYEOj8+nJXrzlPuNNzqr5yTI8o6gmJVO/nQbtFIdHAWquie6CYGK16c4Of7cC9RRn7nJihRYH/o0J9Adj68ent/f3z99eJHxfWH6q+c6YlBKIYFmFsKbEU6Hgz8ng6pUYGJI2wIdhOtTGvbEaghUYCkDJap5GOUcTjyidEBJWgh0CDk0INASf7IUOg5D8ycUJLoVgRahfimPEX+yKy0s0NLFDBVnXX1CoORqxWdyKT1wXOGY29szjvZZqeQJdP2cuETTYkGgGhwrLCE8OREXaHbXvvQJgZKrFZvjTuRtOKRTSVr+TDdosBoFKxICjaO0tMcai5bmnFPXvUHdvXITyq+qYEXW9ycEKhJ2KtBgzLWTnAItKAS2QMNDSUo0KQoEqsDJn8voXm1Ou+7s6SmAgmwzS6o3fUKg5GrF5XweM7ILehxyXqiO/c+SSuAKlKLvgW/VYgOBRtFZ2rM/T1v4qDannccDeHeLsgPxjC7BTJv4EwKViDoXaELQYNWWFcLOnMQQKKW9BzIOTRuJ3+d6UBSoS5tJox1u0nA1LcqW27lLfUKg5GrFZXEpPXFPy1MQpZVAHH8OjLegXKIQaAw9gXK1uUzJXaoFSfHyiOQtsHXPBAIVYHkpPTGqq5yLC4HEriE525ZJNOkqMLvLFaEq0PB3Lvg4C5R8L2XCKKNYzTXTJwRKrlZsFleCmJUxmf1yfzJupKfjkMwRChwKgUbQu4hEns9jRjml5Jjy0lrl7GhEXi9KpAQIVILlpfScvbqhciUEDs0S+mZKNOX0MLfHNdGfQKcbd/9reaSf64o1KMujBAhUhMWl9Ny9uopn5U+Nc4fMyxgCDaO1tL7r6HEm3VYRirNNvNwaa1CYRREQaI1hkrrU1OdllsouCrElGm0LgWpFzgs9Eyh5X8sjQY6RMVr7EwKtM05ip/x08jtm9zz1ZzkUAg3SnUBnvZYxyrMNZWVBnxAouVrJj5Paq3o9iAzIkWisFQSqFTkr9LyX/OR400ooqNKDNhE2L1ByNZMfKLlbXj/eGL4HRUETJQqBhuhcoJGHAgOcn43n24M+IVCtSSi4NqM7lPwqMImV4tDoURmr+ZWhKtCM2JEdDol0HTHs6BMC7dGgrJ65F4+yeifEj0oUAg3Qu0AXBpURKK2eSLs6Xz62AJsXqNZRc3ZUXmkkNXV9X95psPShUokdzceuvHJaXxvdC3QQF+iY2exDKJb0CYGS2nnHgivqwgl5vnL0MJToSJO4fodCoH46E6iry/Q5mXSPBr1NuvB+7CAysAQQqJZBC4ImFkjqACeBOtprFqJXosFBIVCtyGICpeDrfG6PAjWoTwiUDv+nVUv5sVhdyy9nnzl/HbnrZ5dYabFxH81DoF76Eqj3Cnm4AZNDbd6m2TPtEL8iEOjhH1q2lB+L2Tl2sSU51O352/Yco/CyysHhUM41pq7WFnUsCHTQEGiqFzvTJwRKp38V5qXYoIH+jNCLbyudD8JNK4+FRCFQHyYEOiRNJGOUAwnfddKdPiFQOv+h8E6UREzfKMdYflvpdAyB8InMjuYDA0OgWpHZsQP3UVCkRfIIZ7w3iiyalw0oDwR6+XPxmvxo3M4ehXKjeq/C1y7Hs0MhUA+aAmUH97c/lWXhaf6LO1O+7blHfUKgNP178aL4aPzODoXyg3Yj0MOY4V1rCFQtspxAzy/l5DtR56F3mkD79CcEOnuweFV6tJzeS93khKx9F2iEoEEhULXIzOApN0uwQy7ceeA2fgK0U31CoDR/tHhZeriszrN6KwnoG6AFEKgTQwKlaJtlB//BRyxM8JilLRDo/OHideHhcnvrFFDTmoxe4Y20u07MCPS4qiSFDLozYah+dz8HCHT1ePGE8HjZnTUU2lig7tEhULXIvODxvcKkRjF3xofqWZ8QKK0aLJ8RHS+/c7QKy8LXx7M0EKhaZFmB7hsErzOluDM+VN/+hEDXLVZPSQ7I7Hz5qflBfC+0dV1CoGtsCZScnw9muTM2VOf6hEDJ0WT9nNyAHG7P31JziSaYXfPKdCYAgapFZgVPaLyvxvn9HRN1MgYLnBvt3Z8QqKuN40mxERkcb4+bbePlSqp9bToTgED1IotI7cLtTKB57gwO1b5E45gV6J+/Pbz4g90rafXs5ED5dH/x+k4BkfxySl2YaxaoTH3KIS/Qw5eAXL6HLruevJcTLcy9MYG++scH/9z98/j8bj9dH37H7J+2evZh0FNpru4xljHf/piucY06z6BEm3SMdH3KwRRoyg7ozJwFmXtXwvyQ9TAl0MdviMYCffz6PGt/523lE1dPybkrFKjnM5jF5XXo3lihjsEtC1S+PuVQESjje+iYQxnRpy2B7utyV6D7f2/u7+/HzfzHrBCpq2cPBr29DXxIuLhwT53bKvSqBKpQn3LwBJrScrYHmpuWZywz/jQl0Le7d/X/++Pw72fjE4//syvU7zkhkldPwRks3gX1xpU5bpJQ6JuRsjQ8T1hZkQaV+pRDXqDD+Rx9mURdG1E7s25JoM+Odfnssl1/xtzEp6+eHRg0ItAi9c36FSv0zZGcPGj5RPhxxyjUpxwaAqXzGaYSia5n3JA/LQn0r88Pm/PTvyPv7ugjzlkmzuopNo2Fu6Dh0JlZyl7azxfo6l22K1CN+pSDJdC0hjQ7v5R7OO/yJy9CU2wJdH+J8/TvsPg7BdbqKTWT4meI5q9npek4dM5f3DdvigwaemhLoOL1Kcc+cmr4pHbrgsly6LyxMX2aFOjj15UEasOgWerznbjnxjlQJNDVGhR6tWc06lMOFYE6n2RKdHUyKbFfJxgS6Hhx86vxj2eXQ6S3pHcIP4gZVFegOepzN885Aht582bsly9Qmj1avpoTswUa9SkHR6CZO6DTV5IlOm1jT5+mBDq8PNxlN55YOp6ZH2v2M04I7uqZNqPRnS9tg7IVGq79tAh0HrdsD3S5DxJ4sW8U6lMOaYGG6yTdoZMGFv1pSqC74yH68OdhX6mH20R+ULuN6dIg1iLlEoq6QJkKjdZ+8OV1gCJ/LvdC/K91jkJ9yiEs0Hi5TRwaanh+0aQ+bQl0eDvemfy3b1+//p9dpT798ZvxIWsDn7F6Jkxrgj4qGJSj0OipX+flAX/HYoHS5O/la5lBGyBfn3IwBCp20mjqUF/r4wus7X9PmBLoeHC0gFefOatndGJTDmBrCJRxAJ5w5uIkzLSAJfqc52NZoPL1KYe0QFmbdb9DJ/5MCtcdtgR6/paGI0pfJrJsE26UdAaw5H1m9J0Vqu/HOIMBJ+JMH7aYy1imBSpen3KICjTdn4fWbomeb3O2q09zAt3x54/3//h0x9/+81ulr7Nbdwq2Uhcor/O5TL0/B++Id9njXMepwWUo2wIdhOtTjnSBpp3W4mU6c+ix5+m7Hkz706BAi8hbPcMTvHdn9CaeSrugh+b7hMMCnexpRuJU4TySeYEWoSzQxCOuaAOuP4+95hI9+tO0PiFQcrVydAu1OwmUNTILbud9id46DXqoXvnrUqVAoCMWBEqH7W9eElPOX0SSE6oXINDEfoGGSQKtuQs6zBU6XEzIOBM2icMdPIvz5QTn0xuhA4Em7ICW5Ekr/F+WYwEINLVjoOVeoNyhWfA7B76rMeP0FXf0DMi9ikOgkpEFBHo5/5Ofynw/tCBUe4wLNPxZ4/XWLn/1jNRMQpy6u6Cn46P1SVB2rEoKvUaBltanHFICpbId0EsUCNQXUTpgiHoCHYqru+4u6O35FxcE8qijUOf5BQhUhlSBVvHncPg2Zt0lrsNVC3RNyepZOtkNBOo8SZ+VR41Sd66ctlewzr6NSUKgSVHiQKDeiNIBg/z5+ndO87LVs6FBs47hnT/7lZtFhWK/PoGW1qcciQKt5c9DObkPkUxhXaBMCldP/2ynxGmxCzqeYZortPACam7nxBGuTaBMOhcoSQn0uFn3nGSyBATK7O/pkBSnwS7oqfOlTsuS0C13qRMOZtEWaHSA4Oui/hwOFzitGxQC5QZw90iKU3cXdN75VKjFV8JU6x0CVY6ccojuf5ESQqSkMj1XY9ygBgX6+Pq3h4eHn17zP2kscYbNM9tpcerugi6603G7XxRGu+CvQKCS9SmHiEATIiQkcvQnTR4XxmyINYG++oYuPHnB7S6werpnOy1OcDjV7yM5RhCpVdWKNy5Q4fqUo1ygiScBYmms9mMh0EVE6YAT3n9Bcz5kfd+3zOpZMt2BrtGvdOpIfYo1b1qg4vUpR5L+wv6keIB4Fo48TBvUlED33/hNn94f+GR8cPMVK4LI6hS/aUkAACAASURBVFkw3SUCFZkrqVJVO/CyLFD5+pSjVKAu8/FzOPeehbFsUEsCHX9z5mb6FbW/3hHvPmWh1VPDoAnfKiozV1IzrqRQwwJVqE85ygWa0D+Sgcefpg1qSaAvV+U4lqzqr3J6wyz7pcbpQaAkNUcadW9YoAr1KUeKAOP+LEhwWiursrFrUEMCPf/u9gTl34UPxFkGys3ghPovK82iiO6GyoQ6Rww/7heN+pSjTKDFB/DzOlmHMWtQQwJ1fa645mfhFx3nPZPjtBfoIUyvCrUrUI36lCNlF9L72sWfgd7BwSP+tGtQCDSTxXQnx4kew2d1ZiFcqbKlD4HqkCDQqD8LznjR/KG7TV70thgS6O4Q6WZ5V0irQ/hhWQbpcby7oFRLoJcwMuFEi9+uQDXqU44ygUb7BkdeXTLyNcuK3xZDAh2erapxPO30MSeE5OqZOeG+TpTy2+riBpWJJ1j9dgWqUZ9yFAi0qFrWleEfxqJBLQn03d2uQn+ePPF+V5+rjX4Q0dVT1KBpkeQt1ZtCDQtUoT7liAs0ILZY19Cw6wn1hTFpUEsCHe8T2VXk/bcPIz8e7lRm3SUivXpmTXiJQBUMKoZM/RsWqEJ9ypEt0Muk8pNzVURwF9ieQU0JdPhl/1GPCTdf8gJIr56T6spPgtNdTKCzODJBRVYAywKVr085ogKV96ezHIJRDBrUlkCHx+fTEr15yv3Gm/TjieSAxwCMOGUnXvP7BuL0cyBvWqDi9SlHvkAjDfwDukohUh4QqLJAdzy+enh+f3//9OFFxveFOQRKrnaciIcAnDAdGrQbhdoW6CBcn3JEdyR918bDrwfGc3aIRTFnUHsCLcIlUHI15ITcB+BEWWVR0DcXvUIte0/NC7SIdgL1+ZPCDbyjxXzM7dkrmxdo+TtwmHFWlJIzkFq7oIKxSxQKgSpH5gg005/e+U8oC4FdmqpAoFIGzU6D2VlsxmKrTFnszECrbqbWpmK6E2j4dd9QvNME697pYzUHAhVwRplBS/qWoFunWeuBo5OllamcZgKV82dg3tOC2DIoBNrEoNPS5A/G7cEOJDICf0UgCJTUI6cLlDIEGpz0xCCmDAqBDq0NmjFYft/EQE0O5Ml1QsXOqiRBTwLN9Wc8haIonQGBHv6hZUt2YF6ETgTqj1RfoXQ8HNDIwwqtBBrxJ+PgO/hqSpB4oK6AQJ3P50RmhTiZO2+onF66kQJDpL0zp2YQqHLkdIEGX3bFCM8082CE0bolugJ9/Ek6eiHe1VNiF5QV4rC7lTtWXj92JJFxKMWh5yZVBdp9fWpEdp/uDD2TUtrRSeauHkYMqivQvz6nv7F/G1uTgEAXr7AjM0Psz/fljpXbkR1J8EA+GIkmE6GRgYfu61MjcmRv8/QMhV52RIhtizMuKLI6NEJdoDue9FOj/tVTYL54c14yYMWDeKGhwgol/+qtLdC+61MjcopAmf5MOsSIBVmHZHZpgvI50F+/2L8RN09+9rSuTGD1rG3QLi4jsZY65RufgyP5xqLZNCxfyx4xgd7rUyNymkBDr64ay/vTzC6o+kWkx+efHGr06e/SI2UQWj0lJqwjgybqLu36wDmggkLnz9a+iNR3fWpEDp/vXD+R4s/46NEmWXHboy7Q4VKj/8b+di9xgqtn0XtBpxjJQXQFmqy7NIOSgEDdCl08VVugQ9f1qRE5LtDwjKzaBl9PiVEUujE1BLrjz+P3JH74XdsaDa+eRUo7x0gLQsoGZQg0KQ2ihN9dTglDy/ecFg2WHUqGS6XX+tSIHBUow58pR++xGOHoWR0rUkmgw7lG+V8yK0lMoIuXOZF5QciRDGu4SN+Un5lPDMWPGBlu+g6t3q02Ah06rU+NyOED9tWUhFJKNFz2emXAoNUE+us3dIT3M1uyRFbPgvm6dEwJQs5sOMNFunJ0l5bGGOuwG5rSOjze6S1yHtHnJFdOn/WpETku0MCL85dSj7bSmpUM0Yw6Av31H8cDpFfftK3Q+P7O4on0yJwg5B6dNV64L0+gKXlI7YEeRxzHdK0eTQTabX2qRA6fNImcUpm8oO/PsoPCKlQQ6HHbfjw2Yv9UtijR1VNkwpKDqO2C0uWUpVgacv4cjqufa9z6Au25PlUiR/Y4yf/ivJ3vpXXLtIZlwzRCW6CvjkdGlxvt3t3RB/+UHjSV+OqZ8oZEPVJn2xx8iaU71i5oUsSUMZ2jVhZo5/WpEjkk0OWkeBLieK1smXo3qK5AD5/02B0azZ/rp0Adix9/RxJMUsGgHv2cnmUKNCUPSX16x6wq0O7rUyVyYB8zzZ/pR+/eEOl0blB9gS4va+6e+6jZhc4kga6fm+N00yqwN8r0Bald0MNws2gs3VWvUe9qUV2gXdenSuSgQL29Js9xlFauv74Nqi1Qx2fkXkuPyCCxQIIx3FdTln28UWjeKjhUkEtfgUmsXKP+laKyQDuvT5XIfoGm+jNv3Fy6NmiFi0g9kbR6RuYrTaDeQ9SEBBLZ9RUrrbolGto/p/Dj66a+QNfHMf7HA19mIgvUs0EhUGcr59NH9u5c3RC57uGMsnyq8Aplfud1MLlY8bH8g0Gg6pF9Al1Nyyob3tG7M0QWEGgvJK6eIgJNm/a8CdiHFp27ejUaXgkhUP3Inr+T/Jk/agn9GhQCTWo3g/EhyVCYhJEifYQNKhgsOE5wJAhUP7Jbmg5fLh6ys5PzXrcGhUA97TwvjLA+4zON44zJPCU/i8fpmhBbMpp/lPAwEKh+ZKc1Iwfw/KP3VYgSuj0NCoH6GvpeGTh3CM3m3R2RMQOxfYQyqpRodBAIVD+yS6DriVlsqzNSkz1H32clQKDelt6XBuclo2gcf4vAQKcYvqtdsa4c9Cs0YS2AQPUjT3c7z38sR553yDvTlNEpFE0ynBQQqL+p/zWGQC9xfC3Cl1QCL0b68tGu0JR1AALVj+wUqL9D1tG7M2YREGgHcFZPIYGeJj7UICOD1BYclEs0KTwEqh95LdCYP0tHFKFLg0Kg6Y2nLyU8M4kTGsU5TnKtGNoFTVsmCFQ/8mq/0zE1k5fyclLQXY8GhUBDjb2vrl/IDOTMouS6UhmKFZpY/RCofuSlQP3+zD16H3QWpUOD2hXo428PP7G/9IG3eorNVyTQ7HCJG5mfTTCcbLxp4LTIVyNQkfqUYxb5rEfvqPunCvSptCT9GdSuQLO+doy5ekrN17QQb0dWr6dk4wmdm1SNcJewueckultjUhGpTzkCAp0Puq/Psz/zh8vu2iRuNhBopH2kQdqok0C3RxajdLOlVylQxuJBoDr4BTqfnNuTQEv0qbcgZVkpYEmgf76e8mpXoC92//7OCcFePT0NHM8GItFwKdO5QOlUw5E0Ahg4iOfENCxQhfqUwyFQlz9PO6Al2/TlaKJAoNkcvz58CWszz1893S0cT/oj0THQ+O/t7cSg03OfsTz80fO7VonH3GmwK1CN+pTDJ1CXP28L9alquc4MCoFGeziauHqlRbo9Vygzj1Dc/L4V4jHXRQhUB79AZ83O/lyeps8fTJq+DGpIoMMvd0Q39yf+445u/n33739yLnVmrJ6u+XL1Sot0LNDVdaSr3QXllrtdgWrUpxxrgbr8OZwO31fXObPHkqcrg1oS6PD+a6IPT7/BUOUi0qHNqpGrlyfS9Ol9YbquIl3vLii72A0LVKE+5XALdDU9dPJnxwLtyqCmBDoM/9pt1v/r8Gc1gRbN17znxKDrQfLHyO/qiUfOm62yIhG7S/hx30jXpxxOgS6m53LeoWt/ntcj7WFSMCbQ4f0XRB/tN/L1BFrwJi070lmhcmPIz6Ff89w4/NRsC1S6PuVYqnLlz7M6SwVaY//QtxbVx5pAh8f/Ibr5cqgq0Ox3ad3Nf3zUpUELo1BOp/Dj3pGtTzncAp08cdra7ea+LIsaM3baD9EfKZ6JeETpgEve7TbyT/6oLNB5O1evtEh+rfQlUAGD5u2JWBeobH3K4RDo+amLPQ+zVpRFjQnb7yb3YVCDAh0ef9ht5L+rKdDVySJXk8uf4ak1YNDbcoHmHL4f+oUfG0CwPuWYRp7fKT/V5+nSUsk4BZ1TuT0bVH+sCBYFerhh5N/vKgp0cbrI2eL8V+wEoqfGehLoaNCiAs315zUIVLA+5ZhEPn/UaFja89Sso1J0AoGWMt4wwrxHeU/+6jktM2eny5Onm+WTYmUlI9nVxaE+C64l5O+HXIVAxepTDodAh+l+6KkVlaVRZ7oO+UOgJfzrrq5Ah2SBnvzJPorvR6DD8Wb/7ItncmugTYFK1accl8iTD7uv5ul8VJ89Sm5P5ihHgVYYLJqLeETpgB7e/zfvQx57SlbP1LZnfwamd7Y/uyI9J3ZyiUw/LsWPXLIaXYtAZepTDqdAfY3Ejh80OMizkx1QwwLNokygaY3P/gxN79qaZR7V2AU9hWTGztwEeAYzK9AsKgn0uAfnbZR/5JHXjzXEvrxKzi+JAoFyOntbTy8a+T6tuQrmE2WORxVKd7aTzOkmehcMBCrB/oDiPMbenqEPc2RfAMzrxxngNEYvdQGBsnofmq86zY/Zkz7GEx+Z51Fdg+4fJnYqSwQCVWByRuZUTk5/0uXPnGGU52q6HnRTFsYFGr7ZjhwsW7CGO/ZfdeILlHX5P8Wj+gJNGqJ4J+S6BFpan0KcBXpyp0egrj/T0Z2q+bvTTVlAoCwOAZadlmc9U/Y/mQPHPVrBoNExBAwAgcpzuGx0uflzekA/zcb9dypa9j8Fn4XvpiyuWqBrilfPJIEmROGOO+npWd1UBOqK6R9HQgBbEugaTYFOCya2Bc4TKL9PcuhFZfVTFcYFOvyp/JtIzgjLThkC5Q67CrD2aI1d0OBAIrsg1yXQ0vqU4STQS306xindGmveQLCqrH6qwrpAmUgIdN0l7bp7yaj+ZHQP/zwx3XumIgn0u6rUQE2gB39eLsQ7RqbZI/YgWhPlrOx+qgIC5YdY9+H6kz9qLKCSQkMh569IjQ6BKnD66GNgmOUtF9xElDJ3V3VHRQGBZsRYdWq0A7qKq2HQtNfExoZAVcLOv9kgvkuXd3VVGt9OQUdFYVCgj69/e3h4+Ok1+3Nyg9Dq6TNoZg6CKCg0GHByUUJqXPsClaxPGejwRfOBYYpPMuqcP/KUVU81YU2gr76ZnPN78oLbXUug1XrHgyucYI20E10m4wIVrk8RDrMTEWhZIionj7xV1VNN2BLo+IszMz78nhdARqBF75ry7AsolFbE25eNOAsWftw14vUpwXF2QgItvUojvlMQLrueasKUQN/ejW/rp8cf3v5kfHDzFSuCmEBz+uWPyBwhcwyfNiMBBZQ9ixZ+3DPy9SnAaXImoRP2N7kCZaUUDxesqK5KwpJA//p8/KmEyRO/sr9zUUig+QYV31Z7BmGNEtvhDMY7v8gaMhAu/LhjFOqznMvUTbeI8VE5mchmHd0gd1USlgT6clWOY8l+xgkhtnpmirCKP9N3CiPinDf0vnL5Mz3DwEjhxx2jUJ/FOKdnMYpzbhmZiBZ1Qul2VRKGBPr4NdHygOgt0Uecq51yq2de1VSb+wQhJpkzFm/+rMDi2RWoRn2WMp2egEDLMhE9gROvxr4qwpBAXZ8rrv5Z+LKuNefeWYoLcXLScTV3j8EI6hom/LhfNOqzkNn0+ATqHjM9E7mc00qyr4qAQNmcuvD7ih7rJA1H078zzemM537i9HROdE/nvlaXEP0J1Hd4sHjaOWZyJmJFnVqXfVWEIYHuDpFulneFtDiEP3XhV07tqV9as7TWFxH84QR37PtaXUJo1GcRi/lxXE0KDMkQKCOlUJjE6uysIAwJdHi2qsbxtNPHnBCSAmUbtMHUC5lzFm/yd7ht5gjhxx2jUJ8lrI8XXIOUbgRlMmaUaGcFYUmg7+52Ffrz5Inx17dXG/0gogJlGlTMYhw0LuvS9F/psQ0LVKE+C1jPz+kJSYGKFDVrC99ZQVgS6HifyK4i7799GPnxcKcy6y4RYYHyyqfJzCvM736h00o+Y3TDAlWoz3wc8+MSqH/AWgfUzAOk3urBlECHX+5ozs2XvADSq2fvM68yKLfkz3+9GYkGDz/uGvH6zMY1QQ6BBuaxzgUdZi31Vw+2BDo8Pp+W6M1T7jfeiK+e9S9WstAZNLPm3xxJaux73DfS9ZmLc4KcAi1LRfaqpP6A8hgT6I7HVw/P7+/vnz68yPi+sNLVc/W1dakFcE3+5Ac+NN+AQAfh+uRyrE93tR2fTPNnUipl6fL12WE52BNoEYWr5/zni48RkkK0mXi9UXPObr5JMah5gRZRuLTH7/X21CRPoAm5FO0V5Oizw3KAQDk4BJpWRdfmz5zQb4gg0AgiAvVV5Eqg4dFSBJqamKNrln37qwYIlIH71zcTKqHNAbxqufFj78x5VCgnbn+rjCZlS3v2p+fHEQ7Rz2NEqjKaS36ymfrssRogUAaeny9W3VQXoDpqlkCxBxpBQKA0/fEjV/SJQItyyd4ryNZnj9UAgTLw/f57vNQ4o4ihO2y+QVlh+1tlNCkXKCULtLRqM3Mt0GePxQCBMvD9/nv0WIg1ihgQqDlKBUoHQgK9+DMyVuEOqq9XydrQYTFAoBx8P18cLoqr9Ge2QZlRO1xnFClc2sPup9dRC4EW5ZLjQSrTZ5fFAIGGWK7x3t9/D9WFjmji9CfQnKgdrjOKlC3tXp+3foNOBZowkvBeQbE+u6wFCDTA+pjT+/vv/tLgF03SoW4U/WpTGQECze979Ofxb090GYGyEy22Z86gFYBAA3BM5ouUUTYQqPYg3VJ0fnDa2W/QxaX4vGS4VS2hzz5LAQL1k3bfTSRUvj/LDFqj2jTGgEAzO67fuHWws0CTdCZ2WkpEn52WAgTqhytQV6yM9xcC1R6jX3KX1m1Lh1QZO6CBRqw0hfTZaSlAoH72EqNkk7nKJKd0RARap9gURoFAs7o5+63MdRJo2jAip/XF9NlpJUCgfs7+TDSZ55iJxb7eDAlUfBgINKNTSHU0e8gRqLdZepZy+uy1EiDQAFyRuQ6Z0rueG1s5glcZBgLl9wlf7aHpo8tp0PxskpOU1GevlQCBBmCbbHXEFAzva2RmB1RjIAiU3SXcZyqxg0CTreY9MZCamOTkdVoIEGioNdtj83jB6OQ/mCq/iQkCtUnWKZ+EJjT5m7MHmf6sa9DUcQqSaQ4EGmicE5+mD9ITkaVisUkPBYHy2ice5ND5L9Z5pdQnHQNqF0YnQKD+tuzo8y+zdZaQQmU5gECNwlxaxsH42PL0ZSNF2cS7q9R4r3UAgfrbcoPPvw58XkR1xHkerNZI8oNBoIzGvIuUx0/JM4ZwtGWdMRCk1zqAQL1N2cHnP6jgFmkVIFCr8OzG1u3h20JL0omNqbaj0GsdQKALvF8XEuX0VU2HmMdCajHvlcfUvVbQ64qjQ3xpw18XEo59gFHeLoFGh+BllZ1JJ0Cgc7xfWBfn8pOI1GS/8wwEapbo0t7OqozF8QCeU9yrMWL3lajNVrdlAIHOOdVnRuxjYR8O4ttNeM2TracRFYN1u+aokCrQpDkmNwUCDQ2rqc+OqwACnXGqz5xd0MsPftR32JnTWlJ3TMVg/a46GsSW1ltfHll6yE3H31O56PqtAgh0xtmfBcfwt+0O4I9lbNmgEGiIsz9zPDntmpWPt5v6NrvfKoBAZ/h+dzOJyfnTJhM+KeOCes74GBQEKkWKQLN3Kk8nQYd0hy5vxfM00t5gd1wEEOgM3+9upnHp2GDG52WcXdJZH8QXXFwINMT5PHtefZ7NmarQhUCdLdT12XURQKBzSvwZiqvNqoxzyzpToFljuUOFH183SReRWNeBFtFnBynxaZs2cDWuos+uiwACnWNToK4yzqvszG9zhkBlSLsKz7oZfh59eoNIgv3CxzR17Nl3DUCgCyT0WXnKfXWcU925X4cvtsAQaJjLRzWygk8FOsQdOhPo6rU6+uy7BiDQKuMoEqjjjAJ/82YMB4E2IuPSDi/46b/Jk0EPTnZXly/U0mffNQCBVhlHjVj5p10poHOk7B9kklpiCFSumaPX4T9aPB/aBp/brLrk5JBD1yUAgVYZR4loHQdeP/VdNMj9OnwIVAJNgV5m23007ox5EeiyeUYGmXRdAsYE+vj8H5/++//+4/z4r8/pg38y+l+VQJPqeNJkuqfpJfv3RIQW2bZApeuzrJmj06Gno7/HocenVudNM8bPpusSsCXQf93tZ+/m6alENyzQeB3PhZmaUu7viUCgCvVZ2m7VxStQj0JXAq2uz84rwJRAX9KJj44V2qtA1WfdX8crYdaqeJlRLAtUvj5L2626OPYoZ22WxbIQbn199l4BlgT6brd9//C7169/GP89lOVGBTqv49iheaWi37xAFeqzvOGiQ1igDoVOrjo5d1HV6bwALAn05WnL/v6LU4VaF2jWXaeHOuYcmhsyqGGBKtRnecNFB+dFoWXLiycPN+1fNtDcUQXovAAMCfTxa6KvLn/ua9W4QHmfe4rtaUa7KrNxgWrUZ3nDRfsEgU5cefjU03EntNFMdF4AhgQ6LcaxQj8eNiHQ+Z5mbiFXqX+JIewKVKM+JVrOmk/OZkbaj8y++4k1nhi9z79RgY4P6DPrAvV895N/T7OgkGusAhCodH1KtJw1n14OivXYK7StPvuff6sCHc/Y33x/TQKd72m6YxYVsg2DXolAhepTouWs9aVbQoDWe5+HHNqNnYIhgU7OMY28Jfrg5ysQaGqBlhey/oogsLLZFahGfco0dR+5xwOcDuAFvl0nl+6n35BAx6ucH88ffvB/7Qs07SqSyH6A+r6EwA6LXYFq1KdMU/d+Z4pATwZNH0qY7qffkkDH++ye/H55/Gw/uYYFmnwVXuowStmgk9tdsocxLFCF+hRq6z5wTzAoHc+CpmclTPfTb0mg+096TOvxh14FmuqQNIFKnoXSXBnOsUscaligCvUp09az2xkPsD98b/krs/3PvimBDr/czetx97g/gdKEWNvK+hw0d0JpvnJm5m1ZoPL1KdPWd9wejUB0/pVZRmKC9D/7tgQ6PP76n3/MHv9w15dAJ+IoO5SdxitNahVRNOAl8Hog/limBSpenyKNvXud8TuZJn+2mAgDk29MoKXorp4rZZAEkhmeshKP6X4rM5bAtkBLqSvQSIRVKacNJ4iByYdA5UK7ZNGjQFUM6ovJXQgIVLxxpkCXs9ZAoQYmHwIViuvXRNkYWgYVjhoKyHIoBCrdOnTUHp619TNJA4phYe4hUImgQUEUjmHDoJFw6Q6FQKVbhwXqC+F8pbJCLcy9cYGGP+kRPyAuX/y4GkrH0Cla2agJwRIdel0CLa3PCCnNwwftvgieTOoa1MLcQ6AlJBW9xJX4wgjaURNjpUgCAmVQLlBPCH8iFRVqYuqvWqBrJFfP1IoX2cstDeGOKhSWESjqiS0JdI28QGMnPZ0hwhNUa0pMTL1xgQ5/vv493uiC2OrJ2V+4eoOyV/vAe3ddAi2tz/L20atG7nOd4ZB1JsXE1FsXKBOZ1ZN5tCXwHiuVrEzYjCD+d/DKBMqkD4HGT0rVmBUbMw+B8kNwz1VJvMcdGzQzhud9hEBF2ye8nY6j+mgWNRRqY+YhUGZ/rj0zBvGNLBDFFbY0bn4A17sJgYp2yBBoUkVUMKiNmTco0MfXvz08PPz0+o940xVFq2eWPbmDhEaXCOMIWxa3rPvqPbUvUMn6LO2QdM1oeZ0+LQdthRqZeGsCffUNXXjygtu9YPXMtCdzlHACEmGE40rswU7fWeMCFa7P0h6JAiXPg8jIqnNjZOJtCXT8we0ZH37PC5C7ehbYkzFKPAmROJJxZXKaONS0QMXrs7BH2jX36ZOs+dRUqJV5NyXQt3fjlH16f+CT8cHNV/FuE7JWz/kuUgZSb7KiQXMDi2V0epMtC1S+Pgt7JAr08iyzEBQNamXeLQl0/KnYm+8mT/zK/b7ajNWz2J5JoyQHkoq0ipsXWDQf51ttZUUaVOqzrEvKJffZs/wyUFOolXm3JNCXq3I8/vp2OszVU8Ke+zBpvxyXEqk4GcnA4umYFqhCfZZ1SRbooUIzh1eZITPTbkigi5+N3fOW6CPO1U7O6ilkz+EsUAmFdmVQjWTsClSjPsu6JAv09vTbR+zRB6WSNDPthgTq+lyx2mfh5ex5iCYlUFWDciPXWHPMrEkq9VnUx33F3dXydm/Q/PM4ChYRj6gEBOpsJWnP8wb+2gxa5djNzJpkWKD7nc/9TxjzRz8ElT+VIxtPD0MC3R0i3SzvClE4hJe25yAsUD2DMiPXOfllZ1XSqM+STrE7li6cfro4vz6l1xg7s25IoMOzVTWOp50+5oSIrZ4K9hyOApULrGrQ5NBKWdgVqEZ9lnTiCzR3D3QQN6idWbck0Hd3uwr9efLE+119rjb6QYKrp449h8Ue6GmMgoG6MGil21fsrEoa9VnQifHsyZ9F1S+56hiadEsCHe8T2VXk/bcPIz8e7lRm3SUSWD3V7Dly67yR6SRSvlD1DJocWu9MbJ1xNJCvz4JeHK3uz3+eLZqTwiBqUEOTbkqgwy93NOfmS14Az+qpas/BJ9Alc6EmNFUhLbRaApYFKl+f+b04x/UDneuzaE0QW4cMTbotgQ6Pz6clevOU+403rtVT256HcdhXkMJ7proGjcbWG960QMXrM78X78QoTTbvBeuD0Hpkac6NCXTH46uH5/f3908fXmR8X5jnohG52kpSNIJzz5SX9JsRxnix2Jr6rjWSEqL1md8tXaCO6c5fK0RWJktzbk+gRTgF2mDcolBnoSb3eXOEMUbk9eShuZgXaBFiAvUFcrX07ZVmrRsCK5SpKd+8QNuMKxMz+SIUV6ARg2pudCBQkX7JAg3MZaZDixVqasoh0DYDy8Qkx2NH0b95k2NQCryYHIcNBCrRzxvHcQgWjpvh0FKDmppyCLTNwEJBA1Ene6YZAg2tBapvy7gLHgAAEyZJREFUGgQq0S917hJUl+PQIoXamnEItM3AUlFTwu5a8QXqD655AA+BinQMHZbPHyWNx3doiUFtzTgE2mZgsbApcXP2QL3Bdf0JgUp0TBQoYyrZDs1XqK0Zh0DbDCwXNyVwlj89K4HyWwaBCnRMEyhTcUyH5hrU2IRDoI1GloubEDhToK6VQPsdg0DLe6Zd/8sQHM+heQo1NuEQaKORBQMnRM7Spyu68gE8BCrRM0mg2TuI6Q7NMqixCYdAG40sGVkt9Cq6uj8h0PKu4Xszzn9kD8VwKF+h1uYbAm00smhovdiLdUD//YJAi7umCLSwZpIdyjaotfmGQBuNLBtbMfh0HajwdkGgpV2DMQ4v5p2dXEZKcyhvLHPTDYFKEvrOOrsGPYfXP4CHQMv7BmLsf/tIxp+HkVIcyhrN3HRDoILchn75SHkvUTH4yZw1/AmBlvYN+rPo1zfdgyY4lDGguemGQAWRFCj7k5es6Fz2K4nuEpxHCj++bmoIVHo7mODQ5J1Qe7MNgebgdsPtbcigvKGkv4CulMRrBhOyb94PP75uipb2dH7T97rAb8d5R47UR2r12JttCDQDjxtaClT/+BoCrUC5QMM7oIW/XhwcPOzQNIXam20INJ2zG0MCPZXR5d+cofK+gI4xAJ9Mf3INCoFmczzB6Q19hP3jMqmEHZpiUIOTDYEmc9699LnBswe6FKrv32mfzC+gS2/MBwKtQMnSHk9wruxIc+I/blhA0KFxhRqcbAg0mahAwxeRomNNhfrmzfgPUz+qBuXGfkOnL9ErG8fgOlWArEDn5ozVpxABh0YNanCyIdBULvuXb96c7OBpkjZ2iLz9N02DJoc+bQewB5pBwdIezx9Nf5x46bIqAh1CDg0r1OJcQ6CpHIuPJmpYuSFYnlknQRldBlWDsu9DwUWkDMoF6lbnpI26Pvf4HBo0qMW5hkBTOepzegxfNnaQbP1wBmEFjg68aAKBZiAlULGECvCkEkivj7x5QKCpTC4RCbkhSM4Ag55BQxcGPC/lLQEEmkn4Jro2OB3qrRiTUw2BJjOpTxk3qKBkUNdaUGkgjVF6pewiUm/+HHE51HuCtEI+0kCgyRQXaJ0CURHbJKbyASIEmkufAh1cDvWcHq2UjygQaDql5VmpQjQMtwtJjttVFYBAs+lTn3tWDnUo1OZMQ6DtBtcbR3KgfbR61yUg0Ctl4VDXudGq+QgBgbYbXHEgsZEOkSq+TdexWuVy3Us7d+jqsL56PhJAoA1HVxyodKT5ERcEWomrX9qpQ5cH9S3yKQYCbTi65kiZQ60vmQ513yUI9NqZOHR+TN8onzIg0Iajqw41GSvh6oJTnJcXRXJKAgLdAGeHHv5/+AxA45wygUAbjq471nmw2Ef0yf3CtIlQUglAoNvg5NDxf8fP+LVOKQsItOHoyoOdRnMLlJJvS2p6pW07ShnZ1NLSGQh0GlE64JLH1789PDz89PqPjL6NV88mBl18xi9dnJdAwplxBrOnFMn6vHZoJtHW2eRgTaCvvpm8509ecLtvSaAng16+RiozAwg0HeH63AAQ6DKidMAJ77+gOR9+zwuwKYEeDTr5GqnMKIIpsUczpRTx+twCpx9qgkCPEaUDXnh7N77Vn94f+GR8cPMVK8K2BHowaOnX9ECgqcjX5xbo8Wuk0rEk0L8+3xXkd5Mnft0V7Af/5ITYmEDnBs2OIZgQezRDSlGoz01g2Z+mBPpyVY5jyX7GCdF69WxiUEs7oM1nqACF+twEEOg8onTAE49fEy0PiN4SfcS52tl69ay/gpwNmh9AMBv+cHaUolGf28CuPk0JdLc5Xx0PuZ4L0Xr1bLCCUOGYEGgiGvUJegcCrUqLFaTMoK3fITtKgUC3iCGB7g6RbpZ3heAQPmnQglFbv0N2lKJRn6B3DAl0eLaqxvG008ecEK1XzzYrSIFBG1z1apxAPgr1CXrHkkDf3e0q9OfJE+939bna6AdpvnpaM2jzN8iQUhTqE/SOJYGO94nsKvL+24eRHw93KrPuEmm/ejZaQ7IN2vwNsqQU+foEvWNKoMMvdzTn5ktegOarZ6s1JNOgLW67ap1BAeL1CXrHlkCHx+fTEr15yv3Gm+arZ7M1JM+gECgP6foEvWNMoDseXz08v7+/f/rwIuP7wpqvnu3WkCyDQqBsROsT9I49gRbRfvU0ZdAm9/03T6Eh21raawACbZxB1aG5Y0OgldnW0l4DEGjjDOqOzRwcAq3Mtpb2GoBAG2dQeXDW6G0+eNo+h3Zsa2mvAeMCDX/WmBzEW4C2LGdIumZqUlqfoHcgUNAZyxmSrpmaQKDXzlULdA0K1Bq2Zwz1ee0YF+jw5+vfOc1RoNYwPmOozyvHukCZoECtsa0Z29bSXgMQKOiabc3Ytpb2GoBAQddsa8a2tbTXgEGBPr7+7eHh4afXGR81RoGaw96MoT63hDWBvvpmcsvHkxfc7ihQaxibMdTnxrAl0PdfLO6a+5D1fd8oUHuYmjHU5+YwJdC3+y9b/PT+wP4Lv2+Wv8QdBgVqDUszhvrcHpYE+tfnu4L8bvLEr7uCZd2njAI1h6EZQ31uEEsCfbkqx7FkWT86gwK1hqEZQ31uEEMCHX8jdnlAhN/dvnbszBjqc4sYEqjrc8X4rPG1Y2fGUJ9bBAIFXWNnxlCfW8SQQHeHSDfLu0L4h0jAGoIlpArqc5sIltChBqQDnnm2qsbxtNPHnBCt32zAR7KEVEF9bhLJEtrXgHTAM+/udhX68+SJ97v6XG30WUgvvvjb2XuC3S9wRVCf1x+vQn0qDvByFP7N/bcPIz8e7lRm3SWyYnPz1Xs8ywJFfV5/PNsCHX65W+w+33xZFnBz89V7PNMCRX1efTzjAh0en09L9OZpzjfeTNncfPUez7ZAUZ/XHs+6QHc8vnp4fn9///ThRWl1Dhucr97jGRfogPq87nhXIFBRNjdfvcezL1BRNjddvceDQOdsbr56jweBztjcdPUeDwKds7n56j0eBDpjc9PVezwIdM7m5qv3eBDojM1NV+/xINA5m5uv3uNBoDM2N129x4NA52xuvnqPB4HO2Nx09R4PAp2zufnqPR4EOmNz09V7PAh0zubmq/d4EOiMzU1X7/Eg0Dmbm6/e40GgMzY3Xb3Hg0DnbG6+eo8Hgc7Y3HT1Hg8CnbO5+eo9HgQ6Y3PT1Xs8CHTO5uar93gQ6IzNTVfv8SDQOZubr97jQaAzNjddvceDQOdsbr56jweBztjcdPUeDwIFAIB+odYJAACAVah1AgAAYBVqnQAAAFiFWicAAABWodYJAACAVah1AgAAYBVqnQAAAFiFWicAAABWodYJAACAVah1AgAAYBVqnQAAAFiFWicAAABWodYJAACAVah1AgAAYBVqnQAAAFiFWicAAABWodYJAACAVah1AgAAYBVqnQAAAFiFWicAAABWodYJAACAVah1AgAAYBVqnQAAAFiFWicAAABWodYJAACAVah1AgAAYBVqnUCA99/cEd08+Zn3Uk68x+efEtG/MeNFs3h3R18JxXv8Zczw0y//EIr3KucN3PPX5x/8kzfWtYL6nGS41fok6YBy/LJb4pGb/+K8lBPv9ArR34US3PPX58Qq0EC8d6cMP3QVBzve4w+nBf6Mkd+h69fkKtCsGbEN6vPCduuThOPJ8ZbOLGc58FJOvMkr9LFIggeesfILxTvXJ9FHydv4QLxnl5eYFfq46+oo0KwZsQ3q88KG65Nkw8kxbh4/3O1wv/pi9Y4EXsqJt3/lxXB46eZ7gQQPvOVNV2SBb74cj+Tu0isqEG+s9/Fg5v3XnAUe2W3fXUubNSO2QX3OX9pqfZJoNEFenjZm43vyWepLOfHenrfr40vJm/hYFuOkcQo0vMDHaX+bvokPxzsu5jPeJv7X/Z7GugSzZsQ2qM/ZS5utTxKNJsduSU/bnt32aDYpgZey4j27lFF6vGgW47mY/8Uo0LQFnvxZkN+z80tvOQeF73fbb3ryxbpAs2bENqhP50vbq0+SDCbIbvt4WtDlpAReyornblUacLfR++olo0AD8XaTzjj1lZBfZoG+HA/UXCfps2bENqjPC5uuT5IMJsj0nXs2n+fAS1nxJjAKNBJwV1SfDZwCDS8w/7AjlN/sEIlxEHfz9z+cVzmzZsQ2qM/ZS9utT5IMJsh0Ul765yu5BNI6MTZ44YC7adxVOrNAffH2D/f3sf3bl6nhgvmNp7/2J+m/4Vw1Hf4cm3oKlD8jtkF9Xth0fZJkMEGmy7nYwgVeyop3YTdxyfv34YCHgxDOZAXijcFeHm/CSL7PLpjf/mwRL94JV4FmzYhtUJ/zYJutT5IMJkiLAh3vIeNc5PQHPD4hV6D/cb6NLfUujPACjzeIjDxhn1CHQPegPi9suj5JMpggDQrUcw9uRsDTqSqZAt3f27Y/pPnzh/RbqYML/PJc7zfpB13nbCBQ1Cfq8whJBhOkfoE+8u7aDQV8dpxDwQL97PxKYo6h/Mb6/Pvvx4JnnhGCQPegPmeJbbc+STKYINUL9D3rYx5pCYodIl1OpSdfRAzEm3wG+hf2JzMg0D2ozwubrk+SDCZI7auc45cNsE5Y+wNebosTuso5/ThG8vyH38D8uzpwFX4P6vPCpuuTJIMJUvk+u/1BA+uEtT/g5QQO5+sQAgm+zCzQQLyvJn/zNsi4D3QP6nMWcLv1SZLBBKn7SY8f+F/74g+YV6CBBKfzn1xQgXhFRzT4JNIe1OeFTdcnSQYTpOJnjfczxn5X/QHzCjSQ4O7xuSaSN6CBeOKHSPgsPOrz+Pfm6pMkg0nystq33YwT9gH/m6oTsmCdbwnEG+//O8w646S6P974bWHHvNKvmp5wfmFt1ozYBvV5Ycv1SaLRBDl9C6Lv+xbdL+XE43y+g5cFq0AD8caKGl/6k3MoF4j3bHqbCPN7IJwFmjUjtkF9XthyfZJoNEneXg4yDrN8KaTVS0Xx5oc06bUaSPAI74pfIN4kxYJv/D7HO3wV5AHuZ+WmBVo4I7ZBfaI+h54FOvxr8TMmk/lfvlQS7/HrzAINJXiAectEwgKzPtvmj3dZZvYJIXeB5s2IbVCfqM+uBbr8Ib3p/Ev86uEx3nRzxyvQUIJ7uPecBeL9+fyT3Ut/e8EJF4r36h/7l3jxRjwFil/lRH1usj5JOiAAAGwFap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIAAGAVap0AAABYhVonAAAAVqHWCQAAgFWodQIb4y3RB/8c/3j8mujj1tkAMAf1yYRaJ7AxznV5rlQA+gH1yYRaJ7A13t3RzffD8NfnRF+1zgWAJahPHtQ6gc3xjOijP47/B6A3UJ8sqHUCm2O/bd8dII3beQB6A/XJglonsD12xflvd0Sftc4DABeoTw7UOoHtMZ6nxwES6BXUJwdqncAGeXeHAyTQL6hPBtQ6gQ0ybuJxiwjoFdQnA2qdwAZ5OR4i4RQT6BTUJwNqncD2+OtzurnDMRLoFNQnB2qdwPZ4ttu8v8Tn5ECnoD45UOsENsfb8QonPugBOgX1yYJaJ7A1xjP0X+GjxqBTUJ88qHUCW+Pl4Ra7sU5xnh50B+qTB7VOYGO8O52ex4flQIegPplQ6wQ2xrPz2flnOE8PugP1yYRaJwAAAFah1gkAAIBVqHUCAABgFWqdAAAAWIVaJwAAAFah1gkAAIBVqHUCAABgFWqdAAAAWIVaJwAAAFah1gkAAIBVqHUCAABgFWqdAAAAWIVaJwAAAFah1gkAAIBVqHUCAABgFWqdAAAAWIVaJwAAAFah1gkAAIBVqHUCAABgFWqdAAAAWIVaJwAAAFah1gkAAIBVqHUCAABgFWqdAAAAWIVaJwAAAFah1gkAAIBVqHUCAABgFWqdAAAAWIVaJwAAAFah1gkAAIBVqHUCAABgFWqdAAAAWIVaJwAAAFah1gkAAIBVqHUCAABgFWqdAAAAWIVaJwAAAFah1gkAAIBVqHUCAABgFWqdAAAAWIVaJwAAAFah1gkAAIBVqHUCAABgFWqdAAAAWIVaJwAAAFah1gkAAIBVqHUCAABgFWqdAAAAWIVaJwAAAFb5/wHxNjQKe/nhDgAAAABJRU5ErkJggg==" width="672" /> The two plots being produced are the restricted Voronoi diagram (RVD) and the restricted Delaunay triangulation (RDT). RVD is the partition we mentioned above, each polygon (cell) corresponds to one datum (blue point), and any point within that cell will be transported to the datum by the optimal map. The orange points are the centroids of the cells, and by setting <code>draw.map = T</code>, dashed lines will be draw between the centroids and the data to indicate which cell corresponds to which data point. The RDT on the other hand is the dual of the RVD and has many computational applications, see for example <span class="citation">(Cheng, Dey, and Shewchuk 2013; Toth, ORourke, and Goodman 2017)</span> for more information.</p>
<p>Now with a fitted <code>tos.2d</code> object available, we can use it to compute the 2D empirical ranks and quantiles. The following snippet shows how to do so for some arbitrary points <span class="math inline">\(\{Y_i\}_{i=1}^{5}\)</span>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># choose some arbitrary points</span></a>
<a class="sourceLine" id="cb2-2" title="2">Y =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">3.2</span>, <span class="fl">-0.9</span>,</a>
<a class="sourceLine" id="cb2-3" title="3">             <span class="fl">-1.2</span>, <span class="fl">1.8</span>,</a>
<a class="sourceLine" id="cb2-4" title="4">             <span class="fl">4.1</span>, <span class="fl">-2.1</span>,</a>
<a class="sourceLine" id="cb2-5" title="5">             <span class="fl">-2.5</span>, <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb2-6" title="6">             <span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> T)</a>
<a class="sourceLine" id="cb2-7" title="7">Y[<span class="dv">5</span>, ] =<span class="st"> </span>X[<span class="dv">1</span>, ] <span class="co"># take one point from data</span></a>
<a class="sourceLine" id="cb2-8" title="8">R =<span class="st"> </span><span class="kw">tos.rank</span>(X.OTM, Y) <span class="co"># compute ranks</span></a>
<a class="sourceLine" id="cb2-9" title="9">Q =<span class="st"> </span><span class="kw">tos.quantile</span>(X.OTM, Y) <span class="co"># compute quantiles</span></a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co"># to visualize ranks and quantiles, we first apply the scaling of X on Y</span></a>
<a class="sourceLine" id="cb2-12" title="12">Y =<span class="st"> </span><span class="kw">scale</span>(Y, X.OTM<span class="op">$</span>Location, X.OTM<span class="op">$</span>Scale)</a>
<a class="sourceLine" id="cb2-13" title="13">Y =<span class="st"> </span>Y <span class="op">*</span><span class="st"> </span><span class="kw">diff</span>(<span class="kw">range</span>(X.OTM<span class="op">$</span>Data)) <span class="op">+</span><span class="st"> </span><span class="kw">min</span>(X.OTM<span class="op">$</span>Data)</a>
<a class="sourceLine" id="cb2-14" title="14"></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co"># plot ranks</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb2-17" title="17"><span class="kw">plot</span>(X.OTM, <span class="dt">which =</span> <span class="st">&quot;RVD&quot;</span>, <span class="dt">draw.center =</span> F, <span class="dt">draw.map =</span> F, <span class="dt">draw.data =</span> F)</a>
<a class="sourceLine" id="cb2-18" title="18"><span class="kw">points</span>(Y, <span class="dt">col =</span> <span class="st">&quot;firebrick3&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb2-19" title="19"><span class="kw">points</span>(R<span class="op">$</span>Rank, <span class="dt">col =</span> <span class="st">&quot;forestgreen&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb2-20" title="20"><span class="kw">segments</span>(R<span class="op">$</span>Rank[, <span class="dv">1</span>], R<span class="op">$</span>Rank[, <span class="dv">2</span>], Y[, <span class="dv">1</span>], Y[, <span class="dv">2</span>], <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-21" title="21"></a>
<a class="sourceLine" id="cb2-22" title="22"><span class="co"># plot quantiles</span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="kw">plot</span>(X.OTM, <span class="dt">which =</span> <span class="st">&quot;RVD&quot;</span>, <span class="dt">draw.center =</span> T, <span class="dt">draw.map =</span> T, <span class="dt">draw.data =</span> T)</a>
<a class="sourceLine" id="cb2-24" title="24"><span class="kw">points</span>(Y, <span class="dt">col =</span> <span class="st">&quot;firebrick3&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb2-25" title="25"><span class="kw">segments</span>(Q<span class="op">$</span>Quantiles[, <span class="dv">1</span>], Q<span class="op">$</span>Quantiles[, <span class="dv">2</span>], Y[, <span class="dv">1</span>], Y[, <span class="dv">2</span>], <span class="dt">lty =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABUAAAAMACAMAAADSUD1fAAAAyVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYYdM0iiyI6AAA6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmZjpmZmZmZpBmkLZmkNtmtttmtv+QOgCQZjqQZmaQkDqQkLaQtraQttuQtv+Q2/+2ZgC2Zjq2kDq2kGa2tpC2tra2ttu227a229u22/+2///NJibbkDrbkGbbtmbbtpDbtrbb25Db27bb29vb2//b////fwD/tmb/25D/27b/29v//7b//9v///8+1r2tAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAgAElEQVR4nO29C5vkRJJmrWSAJKGHXqAnh+Ey+8FSTJEsdFUDWwV1gYz//6O+UNylkFzu5mYuc+mc5+mmFBEyk0sn39AtIpoNAACIaOZeAACAWiFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQIh5gD6+/O3h4eHHl39YNwIQgJ+Qg22Avvi6OfPxT6a9AFLBT8jEMkDfftZ0efc7w24AaeAnZGMYoK/vWik/ut/zYTtx86VdO4Ak8BPysQvQvz7dCvntxQO/boV9559m/QBSwE9QwC5Anzd9HVtlP0mq0UBlKApkDH6uEUWBDgqoVzzw+FXT9A+IXjfNeylXO+de25COpkOW4Oc60XRo54B2wSPbt/Or46Ghx0LU8+cIe+rZYvi5RghQcE09Www/10hFAbo9RLrp3xWSfoikuURgTz1bDD/XSEUBunlyZWN72un9lBIIWhsVbTH8XCE1Beibu62hP1888Hbr59WbfhAErY2Kthh+rpCaArS9T2Rr5P03Dy0/7O9UTr1LxGjRwIiathh+ro+qAnTzy13vFoKbL9IKIGhtVLXF8HN11BWgm8enl4refJ76jTcIWht1bTH8XBuVBeiWxxcPT+/v7z9/+EnwfWEIWhvVbTH8XBX1BWgWCFob69pi6xrtEiBAwTXr2mLrGu0SIEDBNevaYusa7RIgQME169pi6xrtEqg8QMOfNY757hTB16+AKf3toy5NQfBzefS3j7YzVQVo4XUPEfS3kIE2xcDP5dHfQtrOOArQaxSHf7UqV4XZ4NcUoNfgpxIV+1l2s/358veUl2sO//rdaEWYjX1ZAYqfM1Gxn643murw12vowKGMXunw9LLBTxWq9tP1NlMe/koN3elpNHQCNDSdXG5Va+9I3X663mTaw1+loftBVyuoZ/BTgcr9dL3F1Ie/PkNPR0c2IydAQ9OCgqtaf5sF+Ol6g+kPf20nms7jrVVQz+BnLvX76XpzGQx/XYZeDtZk3ARoaFpUck2rcAF+ut5aJsNfj6HdP8ZKBfUMfmaxCD9dbyyb4a/F0P7OjMWwCdDQtLTqOlbiMvw021Z/fTr4yaq5PunRLbMCRUt8jK3mAMXPeVmKn2sM0DUYOjREg0EToKFpKfip18a6hd2GevuZW0GXf5g0OL4qBTUDP6941VKk03L8NNxOj1+l/kxsH8Pht1vwgxa1io4Y24Mx0KfeAPXvpwq3LXEvfXVAp3GAJflpKXxr6Jc5BSyH3zQfHNCr6YTRI8AaBTXEuZ8qxW4PxLy2VIAuyk9T4VO/HqyP6fAXG6CBPz11f6oOUOd+qkRoQoC+elUmQZflp63wr/MOkkyH/8EHi0zQ4N9dhYKa4tlPlQS9vY1P0DIBujQ/bYXfHiTlvMUToMlM/NVpC1R5gHr2c6NxGB8M0OYgy+G/r3b/NQ7QxflpLPyb+/v/I5/bPED3J0Lr+qMPMvUnV5+gtjj2c1+wydsP3WVnLyg3IzVL7IEuz0/Xwtvvge4SNNdSN0QMQ3mctQdoHgX+PM+I5k85hLe/iLREP10Lbzv8Y4BmW+qFmAFUJ6hnSgToJi9FPV2FX6SfroW3D9A2QY+1a0/RuCXXvtBhWd07hQL08C+RnykBanwj/TL9dC288fD3AdptUG2Kxi5zbYJ6pmSAHiaT/Uy4kd6UpfrpWvgy55iGHqsuReOXVvlmRcPi7ikeoIfH8DO+rWHxfUXtgprME6CnJ+qxNGUxKxPUM/ME6OEJ/BQUI0D1OwSK1iJp2hJqjoYADU3rd+g/i59ptQhQ/Q5TRf1bmrhodQnqmbkD9PAS/IyuRYAadxh9mV9L0xdKcRAEaGhav8Poy/AzqhQBat0i+FKPlgoWpypBPYOf0yzdT0/r+gpfgh5e78tS0XLoLTsBGpo2aDH9evwMVCJArVtEzuTEUuES1CSoZ/AzYkFEs+ktgFXlU0Xtgpp4FfQw5+yWinurLTIBGpo2aJEyJ34SoOFpgxbJs89oqbxpRYJ6Bj+nmovnVFsEo8LnitoFNfEv6KHGHJZmtdNaUgI0NG3QQlYDP5XrXlTULqhJMUEVCpe2NK9RPYJ6ppIAPRTCTwLUTFClyuUsze2gNmCTspVQU4AequGnMq6Fry5AD7XMLc2vXY2gnqkuQA8l8VMP18KX+PM0SNB9PUNLNarqLBcBGpq26KFWFj9VcC18xQF6KGphqU65WgT1TMUBeqiNn9kdtAtqUnuAHirrWqpVSKUKARqatuhh0AA/czpoF9SkpKC2oupJqra3UImgnllEgB664Kewg3ZBTZYToIcW2ZZqHm1ZHGgRoNY9DMFPSQftgposLED3bXIsVT1bpVGLAA1NW/QwBj9TO2gX1GSBgh56yixVvmRahaCewc+r+XQXQ70EAWreoxjJlipfLN1ojJ0ADU2PkPTrwfipWYEANe9RlgRL9f2sQlDPyEb/6oCsR1nq8XP455sJ0OC0RY8ZGLe06WDRWbmAg7VZkOUH6GER/Pt5e2CiAAFq32QmmmksmioXcLIyCyEa/atX1SVoi3M/CdAh1hSgO0JOuhw8ARqaHqTSAN3h1s/b2+EEJUCD09pNHLg6/k5OgLpjdQHq1k8CdJDie6Czyxo4ErJZtsyqBGhoepCqA9Srn210Ng0B2mNtARo+keRxF5QADU0Pk5afnlapOz9P6/EYnwRoh/LnQGe1deJEvMddUAI0ND3MPj6b+gLUnZ8Xb0UNF5EGWFWATl7HJEC9IRz9PkClTebCoZ8XAcpV+CHWFKDT94EYLVtWWQI0NB2eWdhkJhz6eczP5pSgkzPXG6CPL378PXmmGW5jmknXmNvoCFBDyvtZVYC69PMQn03gdHLtAfrbw8PP7X/fftZugZv/Spy9zJ+ng13QuNuQHSZo5QE6q58VJahPPw+7n6HrcXUH6C937Yp/74/N67vDfbfbf6ewkgCN/RQHAapLjX7GkfR1JREL4NPPiBvCqg7Q5wcr3//r0+27+/39h+2/kyq4FVS5f+QSWC1oRt2aA3S5fibeKDXZ36uf0+OsOUDfbN/W3/3mh+3B0X80zSftI62xX6aU8Cqobvfo/gSoJgv2UzNAPfu57AB9sj8ievzq/Mb+JPEt3qugqs3j25stqLxwxQHqwU+bI+PUzzqFm3v2c3KQFQdoK+bu7fz19vjou/1j2zf9pLNMyw/QtO+w8bcLWm+AuvDTfYDi52QH7YJH/vq0eeefnX90/hnF0gM09TvA/O2C1hugPvyMmUEWoOGr03HY+xkZ8479JEDn+6NP9ZMAVcSHn64D1N7P2D1lx35aHsLvj4y2x0WVHcKXSYFkPS0XTFq53gB14mfEHKL9uvz8LOFn9KkGv36aXkR6//Df/UXO3WVOhxeR5klQgZ8Od0HrDdCa/ZxCI0BL+Bl/stavn3bCv95ugb+/fPl903x0fq/3eJvIUIA+e/bMpNW5g2gs7nZBKw7Qiv189mzCz12A5rUs4WfC1S63fhoK/+T48Y7/txXz44eHr5M/6jGToM+e7RLUMEKFfhKgmlTs57PJCM3tWMRPAjTI4/c7P7fv7sfPfKSdol9sgEr1NM0nnb+YmgLUiZ/T85QO0GJ+Hr4KxPBCfNUButm8+O+P/vZ5+57+r/2HjT9O+6jxTAHaummZoHI/CVBdfPg5OdOAn5YJWtDPQ3zGnG3w6mch4R9/++/7b5K/L2yJAZqh58ZfgtYdoGfm9NMkQMXboaSfTcoN/079dC38AgM0z08C1BVKo5+aayhAp65zyvchi/qZ8Hkpp366Fn6+ALU6RMrT0zagJLUJ0NB0dJ2kNocAbUJ+ZuSncM7j/Fmzq9cmQIPTRm3M8jPz7X2zRkE9M6efYZWk16zL+ZneyKefroVfWIDm+2kbUILiBGho2qjNs0OChmaR9Snmp8rxuGCWygM0/FnjZoD+K2yWa9BQ/SYai+9sF3RZAYqfClWiXmVYOzgLAWpCiT97HT+97YISoN1XSDuHZ1yan/IztLlzLDpAr1lOgCrpSYCaMqOfwTnxU1p8YQG6+fNl0r12iwlQNT+NFzW5+rICdEY/dQM0fTPipxDXwi8kQPX03Hh7i19YgCaiOfrgJSHbAC3qZ1Ynh366Fn4ZAarqp7O3eAI0NJ1WLL7P5HNJy1HSz9K38RGgwWmrPrq1dasToH7w4OegXgnLUdTP7E7+/DQX/vHlbw8PDz++TPyehh0eBM0urVzc/HRD1svrC9Dq/RwSLH45ivqp0Mmdn7bCv/j64paPj39Knd2FoHmF1Uvbn69Ne3l42jmL8DPDMfzMxnK4bz/r3TX37ndpBYr9eRoVNvDT2S5o1QHqzc/xuY0StKSfWo28+Wko/Ovdlyx+dL/nw3biJukXE2oPUAs97TMqqX7NAerOT2mASkUr6We5y/zBF9cUoH99uhXy24sHft0Km/aV31UHqMnb+4YA1cKhn6OzT94b1H0+ajGK+lnsMv/Ei2sK0OdNX8dW2U9SStQcoFZ+2mdUSoOKA9Shn+IAja3TKVnQz3LX+SdeW1GAPn51/ROHrxN/taveADXTkwBVwqWfY/MnnviLeAl+KmE22qHPFed91viDlvwFm26kUc/0ziiz0skN6g1QfT/dvMFPv7ikn7NeRiVAz3xwQGHZwo0UqpnmCAGqwYoDtKSfNlcXxC+tKEC3h0g3/btCsg6RqglQYz8LhFR8h3oDVN3PgWk1qvVz7ssAFQfo5smVje1pp/dTSlwO94MPDBNUcb1a60mAKqHs59C0hOGbgOIKx7ysqJ9GnTz5abcy39xtDf354oG3Wz+v3vSDDAdoY4TKqO393Cgu7XgL4QsrClBlP/fTlsQsT3PbEn4JfqouinbBM8/b9Xhz/81Dyw/7O5WT7hK5DtCmMQxQha1eQM+LP1PLFsIXVhSgyn7up42ZXqA2QZvRCMXPmgJ088tdb/vffJFWYDhAFZewc7omf7MX8XO/0MaSxhauOUB1/RyaFjF2CSZqi+8SdDRA8bOuAN08Pr1U9Obz1G+8ub6ItE1QzQXs33GRt9WL6HleaMt3ej+CWqLq58C0jE5o9upPbPBteO53QgcTtKSf2/9bh5/Wq/TxxcPT+/v7zx9+EnxfmHmADqxQ8UYv8/Z+dZeIkaPCyxZ1BehG08+B6XwS/bzdJehwgAo1edWSMsM+Py+aLttP18J3h3tIUMMOpwcFG71Ufl4vsomkbgT1zBwBugn5ebtL0MEAzcnPpAht2zTdB5bsp2vhB4avvQZG6qVu82LxObzEBkdLcbUI0NC0lItL6Wl+3p4YeL1oUWQBev3YYv10LfzQ8Iu9k6Vs8pnz87QMisvhRVDPGI1+dxnoEIKJflrlZ3yCrs1P18IXCNBgvchtXjA+J8avKWlUFQI0NC3kMkAT/RwM0AwjkgM03GqBfroWvsSf50TNiE1eND8n14Ha0ZITQT1jM/rb27hd0EPL7tYe2P/MkSE1QKfPsS3NT9fCF/nznC4a3OJl4zNuHeg4GtcpfZ7lUCJA5/Vzm5xNQoBGHiEuyU/XwjsJ0E3AUY/5eXhhrqQ+BPWMXYDeNgkBujH0s0nJz80K/XQtfJk/z4QLRf0NXjo+01ZB7tFSxIwEaGhaRv9S+px+NmrXkAZfuwA/XQvvKkA31++a5fMzeRXkOOpCUM+YXUTqXAma0c8m4Ub65tAysUPtfroWvtCfp+RdczNLfMrWgFjSmNNvqXMsiTIBWoWfjSw/DzNV7Kdr4UeHr7sepO+aM6SFtKVsiT0I6hmr0fcupc/iZ9rMuX+Y9frpWninAbo5bHDNZYjumzNvsqSTryVAQ9NGbaJmKRmf5xRZn5+uhR8f/uwJOs8RfPa4Ex11IKhnSo2+uJ/yGVfnp2vhXQdoDZeQRorESzr1KgI0NG3VJ3Yu/CRAe9OuEnRT3FCtftFHS/ML6pmAn7aNomez3xydFiv007XwA4K6OQt6mK/s+tNsF+foxPMEaHfaz1nQw3zJMyZePGpCk1lU4qdr4YcEdZegBdegeq9pSWcX1DMhP207xc+XFYiTL8+aO6K+fz9dCz8w/NPa9BGgZRPUotXU0VK4JwHamzbSoZCfUS8d/+HPNfrpWvih4XsztORhvN0ptnFH5xbUM6v0c+QrR/etVDtd1PXrp2vhB4dvY2hG0XI7oZZ9RiUNNiVAr6Zr9TO2wTFAB16/Rj9dCz88/FoNzca6y/DREgE6yoL8jC5/jM9m6GeXUpcsDZd+uhZ+ZPgmhmbVLBOhZXpcOZpyDp8A3VTpZ3zx29O37Q10SV6wZNz56Vr4seGb5FW2oearstyZgo6kBOgYi/EzoXTv20q7TQRLJsCVn66FHx2+haH5ghoLVDKcOkdLgcYE6OD0gv0c/eHPlfrpWvjA8JvDCXvDbqkzW0do6XA6OUqAjjDpp2m31JlH/EytOnoVfp1+uhY+NPydDK4C1PpAfo5wGr32eXo+PL1sJv007ZY+88CmTC/qJkD3Pef207XwweGrJ2herdMVWLMMnSmcgkMiQEen1T2w8FNSsvRdoBPM7Kdr4cPD3++9e0nQywsIJirNmU0E6CDTfpq2E83cvf6Su0gDDeaAAB1mYvjaCarxFr//l7ursFbNCdDAtLYF+JncnACdmA6eQc7uJ57ZQtGZBR3uToCGpx0lKH4OTCt01i6oyeTwlRNUTVADRWeOppHREKChae0E1fNT/0TTWv10Lfz08JU9UExQV4tm1p8ADU17S9DzT81v8FOrr3ZBTSKGr2uoZoAqKzq3oMMLQICGpjee/LzdBWj31z7xM7+tdkFNYobvx1DTHWTjm/TjlmDowfD0sqnKz9tDgnbL4WduW+2Cw/z528NPfyTPFTV8PwciI38/KstneYNp9CJMPzb3X5GU5ft5ewhQoxNNq/XTdMwv/vHOP7f/eXx6t1u9736bOH/c8J0YOjazjlmN/UdFY5Zh6qG6AnRNfu6/g67N0KuK+JnTVLvgmcevm6YV9PGr5sjf097lI4fv5l7Q8eXLXcT97DMrOtC85gBdl5+3t0PH8Iea+Clvql3wxM7LraC7/97c39+3b/PvJ5WIHb4LQ0MzZyt6nHleRRcVoCvz8/aUoINF8VPaU7vgidfbVfm//tj/95P2gcf/2Yr6XUqJ6OErbjaTAN3kqnWedVZFB240mHiBX9bm5zFAR+v68fNVS95ijDxQU4A+OXj55Py+/iTxLT5++B4MnZo3Q63OfDNG6FXjigN0bX5OBKgjP18dkCxHcT/NhP/r0/3b+fG/LW/umvdSzjIlDF/PUKtd0E2GWkaXTiUL0l+S/vMFFyaLwn7qHcZn7oKGS7vwUx6gM/hpGaC7S5zH/256/44hMUB1xmIYoOLFHDg0mSlClxSgJf3US9DF+/nqVVaCBheswgB9/KqMoJUkqGg5h2aYK0K7TesP0FJ+VpKgDvzMCtDifpoJ317c/LL9x5PzIdLrxvIQSctQW0Elag2/PPvSqYhuy3oDtLSfG7UEXbqfr16188kDtKyfdsI/b/Zv52/ujmfmW2c/SSmReIhUi6HJio69eJYIXUiAFvdzE5ugkztfC/Rz/7L9y/P2QEv7aSf89nioeffnzc7U/W0i35vdJnJ8UidOzAVNVLTMmYtoLvtVHKCl/dy/YHr9TKfHgvw8Bmfnwaz8LO2nofCv2zuT//bNy5f/szX18x++bieT3uAFw68mQVMUnTy1Vja2LttVHKBe/YyIj9r9PD40MmN2gJb001L4N/uPGF+Q5qdk+CphUkLQhAOciCPDosG1kAD16WfMAWyNfp4P0afJic9NYT9NhT9+S8MBoy9r6L9m5gRNmDdOUZPz/lmce1UdoC79jDoDOIefYz/GOXUE369TgJJ+Wg/rzx/u//HRlr/95zdGXxd2PVP+mMq8xe9fPLm8saMup+i5Vd0BunHop3mACv0c/Tn4gXoDh+iL9dO18LLhz52gifMe1HrWklOvpKKnTtUHaBYWfu6yc/Imnpn8HA3QiEP0hfrpWnjh8BU2VLm3+M1erWcHcqoVVJQAbTHx8xigSZ2TyPGzl6B75fy9xROgOyRXOff/P2uCps+rE6AlFT20IUBD0+PzBV4YFaCz+bkL0M4h+sr9dC28NEAVErToW/zhAGk4QdOKlVK0Ob5V9R8u0NsN4tFPJWgzeQ16Nj8HTnimtV6Yn0WFD3/WuBmg/4rJFi4SVDNAk2sVUnSJAVrAz3Ot4NMxFWJ7acx79vP6F0GSmy/Kz4UG6CZ7K5V9i1cM0FKKDh6/EaCR1Ofn4USownIsyk9HAXqNZPhaCTpXgKps8hKKNvurr/0HjbuaUsLP82ur8nNnFH4OtNEuGOTPl7+nvDwnQLMP4+c5Rurv2kiXooCiywvQEn5evroeP4/x+ay/4716P10LLxq+VoLOswt6eaSYtxT2ijbXN7BUHqCJZI5+fPukeS4g/cpPz8/8pViIn66FzwzQGRNUuAt6mlshQO0VzTsLuAByRz+6eaLqlPOzXc4LPy8jdPV+uhY+e/hZG2i+/dfztlcqYwQBGp6OKDA8h3mA5s6Mn6eK2gX7PL787eHh4ceX6Z801jiDMVuCZm+pvVtKZaxYQIC69DOuzox+HiMUP22Ff/H1+Yxe8/FPqbMrDD9n88y5C7o5HyllOmaqaOUB6tVPhQA1/T6SQwUVsyr301L4t581Xd5N+r5vneHPlaAam+oiQHMsM1S06gBdsp+TX+kU0XZq0bS8qtpPQ+F33/jdfHS/58N24ubLpAoqw89KHumcuTP3i2jshVps6poDdNF+5n8rc4wyWlJV7Ked8O1vztx8e/HAr1thk+5TVhr+TAmqs620triRohUH6KL9jPhW0Yjdy5wlSKRaP+2EP/7q4ZlWWdNfPRx5pXzLeAjQqzJS0ywUrThAZ/WzN1t/vtg6ZgEarUr7Os0M1Sl1UTM8rdBBu+CR0+9uX2D8u9ujr6w7Qa8f8ROh9QbovH725+sXki7BkdxfVor3ZH+WPvLFk7Xq89NM+KHPFRf8rLFSgs4foINlxBmqrWi9ATqzn/0Zu3POHqAJ7Mp4jVACNDgdP6t0s8x/GWlk0cWi6SpKgIamUyp13/ClS3Ai5qeBLf3MKVeVn5aH8Df9u0JKHiI5SFDDXdC8enqK1hugc/t5Vapz1l68CEf2P6tUIkDPZRzuhVYcoJsnVza2p53eTymhGKDSXTYHu6Ax10vTGukpWm+Azu3ndS1VP5uY31ZXT1B3EVpzgL652xr688UDb7d+Xr3pB8kavoMELRigiaPTUrTiAJ3bz+tiin7GVbq++p+7CN4itOYAbe8T2Rp5/81Dyw/7O5WT7hLRDVChHhXsgm4GhPugJWkOERUH6Nx+DpVT8zOy0NWlVtkILLZ6LX5aCv/LXdPl5ou0AtrDL56gagGaWueDAxNVs5ev5gD17GfGuaqU2bsnXjPuVZFdApusWoGfpsI/Pr1U9Obz1G+8GTgKz1sgSQEHAZpeJyZANRStOkAd+5kZoIJ5s1S4umIrrtSr499Pa+EfXzw8vb+///zhJ8H3hSmdxuxWyF6KUvNK6+y0i0vQbEXrDtCNWz/zzlVJ5vXpgX8/XQs/JGj5BPURoPGFTrtUEQGau06rD9As7PzMulqaMa8UnUs+I5Vd++la+IHhp62BgR8KrjZBU179QXyA5ilKgPamlfxMqpJzBtLST70rAI79dC380PBTVsHgb62nbw0PAZpW6IMPIg/hj7XFl18J0N703H4mzmzrp9KOqWc/XQs/LGj8Ire/wqqxD+ohQdOWOik/N0JFB2YiQNP8HAjQTD+TA9T9QfyhulM/XQs/OPz4NfnsGKC5hnoIUNkuaEr51NXSEKDZfuok6OXF9MQZ9XJvvNBMe6Fl/HQt/PDwo1fks2fDu6CrSdDU+knrpRk6YCVAE/0cCtBifu42eIkEnSNCC/npWviR4ceux9EATTbUSYBab6wURQ8XOwjQ6+kUPwcDtIyfzfAmFBNa6PIRWspP18KPDT9b0FRDXQRoiXSKVfT4MgJ0aHouP3+vQuYAACAASURBVJMPcS/mVWCVfl4WfPxRu3omo8NPNHSwNAk60iPC0dNLigboivxMPeG3391KmaM3rwoTlfT2Qh35eVnwr0+bvyX/NrYlAUGjVkQgQBMTdD0BGqNoM5oUpku4RD93p5gGKgv8lK76cn4qHsi78bMXoFs+9uPo+PBTEnS0eNop6fjXas5rVWmqT/iE1sV26D9ltkzL9HMboKPFky+ZCCnop1IrR352Cv762W7Jbj7+eezlZQkMX+GKSpKhXgK01DnGgKJNZzP0nzNcpiX6Gc4BCz+vq87jZ8w3Pgc7+fCzV/Dx6Yd7Rz//XbuTgNDwNbKkxgTVqhTRanD1dB8tfRFpcX4GX2Xg5+BWjZg3Mu7irvCcChpEaGk/rwseHf235G/3Uic4fI11kWCojwAtmaCDivYeKh2gm6X5OfKq5vissp9joTM1X3TcxSVooxCgTvwcLPjn4XsS3/12XkfDw19lgpY7iD9066/zpveC/gzmy7RZlJ/hAI0/ExDVbvSwd3LehACNDPKI312OKTO7n2MFD46mf8msJlOCFk1QHwFadBd001f0am3NE6Cb5fg5EaCRfjbjlaKWaGremJ+ZjyyVXnGi3cx+jhT89evmQNrPbOkyMfx6ElRzuxVO0AtFB4+YwtNWLMbPqQCNKxIqFYNigEYuRltrvxsa8+pwv1n9HCr46z8OB0gvvp7X0On3k5IJ6mYXtHCCHhWNufxQZNmW5OdkgEYUOZ0wnWqWvBhH0gI0Zjm09kAPHefz86rg4b39cGyU/FPZqkwOv5oErXkXdHNQNObyg/2y4Wf04iT1mFiChLiL3wXVyc/NrH52C744HBmdb7R7c9e880/tprFMD19lhUSfqfexCzpHgo5dfygcoIv0czJHcv3MOJVwfCop7pJ2QaMqxvScyc/LgvtPemwPjbqPeRa0mgTVDdBZ9kGHHw5Pq7JMPyOSJMvPkX2zyFkP/0oM0OgEjaqX0bN8gPYva24fe2+2C51RghZM0NXugo7+DRYP0OX5OZhN8SdTm87LhpYx3e39LJ35kuJuTX52A3TgM3IvtTsmEDP8kgnqJUBLGzr+R1g4QBfo5/DVlOiTqU33VQPdk0+gKmzDFfk5w+m0eKKGv8YELStoaP+n+EUkT2j4GRego4eoEwuQ8MfRpH4DVLhWQWb107XwccMvmKBeArSooaE1Q4CGpo+PhlbKLjuvboiMPBdwnZeBThOonllfj5+uhY8cvs5asU5Q5QAtteHCB4EEaGg6/PDhucgAtfTzcBulZNZQxSLM7adr4WOHXy5BV7cLOnESjQANTU89vjkGaOSHJG38PM6Dn6IF0C6oSbygWgk6WcfLLmghQ6fWCAEamj4/HjhJl/QZn8s6I+cLpuuMLBd+ipZAu6Am0cMvl6COdkELbLrJJgRoaPriifFnEu4Q6vgZOl0gO9zHT8kiaBfUJH74WpvLNEFre4sXvJ8QoGOvDB3dD1wymqwTSOSJW+dHn8ZPyUJoF9QkYfjFEtTNLqi5oZIzGgTo6EsDe4zxAXquE4jYQFqnHfDmsQ4/XQufMnytVWOZoNqCmm480WEgARr72suHEwL0uFlCCZt+KSv6FSmsw0/XwicNv1SCrmQXVPbJAgI0+sUXj6YE6NSGGXpa8HEkDVbhp2vhEwX1n6DK28/QUOG3AxCggRcPPZseoMl+JmwT/ExfEO2CIzz+9vBj8pc+pA2/VIJ6ClCjzRf9EerFBOgi/UzuiJ/pi6JdcATR144lDn+NCapa7lxWesxXbYDW5Ofl5rltGV4sSTf8TF4W7YIjlBC0VIL6CVAbQ9O+gSI4XQ0V+dlcFLo9cFl64i6miSVUWEDDeoeijvy0E/7Pl5e82Ar60/a/v6eUSB6+2vpJ+oBtWmH5vIPl9DdgSs2KA9SRnwOPhvTbnLfRIT8PmXm8Qo+f59eGp/MxE/7w9eF9kt7m04fvPkHdv8Wn7b7UG6Ce/EwK0OPxefvfi/zsnvucWo7EBZSzeD8XF6AlEtTRW7zBLkNKQQI0ND00R2RYxlW63P1MWo5QXfm8Beq589NO+F/umubm/sh/3DU3/77973+mXOoUDN99gvoWNHX11RugjvwUBeiu0jFA+9eR8HOke00Bunn7VdO8e/wNhiIn6fevKZCgS32LT155FQeoDz93x95DLxuZu1vp9kT6gowvoHxe63oO/TQV/l/bt/X/2v+zmKDuE1RfUMXxppaqOUBd+Jm2wvpH6s1wfrrzc3AZJZX8+Wkr/NvPmua93Zt8OUEVV9L4FnMkqFpBgZ+VB6gDP9PO6F1VOkbo1JKlNNH3cyzmU+t49NNY+Mf/aZqbLzZFBSVBhVUEZSoP0Pn9TLqkPFBpl04Ri5aAXYJmVnHpp7nwb7Zv8h//UVhQvVGN1fIlqEJFWZHaA3R2PxPPgQZrCRZFedaxggoJ6tVPe+Efv9++yX9bUtAVJmh+BVmN+gN0Zj8jAjQcPRX4eZsfoH79LCF8e8PIv98VFLREgjoSNL+i1M8lBOi8fm7/MazX6V9TJxD9+9neaXXb5ASoYz+LCN/eMNKUFHRtCZo5XPnsiwjQOf2MDtDx0u793N+qen23asLy+PWzkPD/2r7JlxRUdU0Nbz8/guZWzIjfZQTofH6OHcGfHzzmZ/JRvCM/b/cH8dKyrv0sJfzb/077kMeOnOFbJej1p/9EBfUWLrtizu7rUgLUr5+n/Azsvnn38/aQoLvSgoXx7Kdr4fME1U3QSdLq6S3baQnFM2YszGICVEQJP0/5GTr+9e7n7iBeVtu7n66Fzxq+VYIGnore2AY5Iz7Lnnn0r7IUlWLl5+VFo7FPa14Vq8fPxPcZ3366Fj5v+JoJOl0qzVMvCZq7jgjQ0PTU3IfzoP0nusfsUR/jqc/P2CT37mdR4cM3200fd6Tv/UuWcrBSQs8YT50EaPYaWlaAzuOnQoDW6GdMiwr8XHKAqiVoep1JTz0kaMSeSGpPAjSFfYH+TP2znjH7n1X6OdWjCj8dBeg12cPXWV/y7TjuqYmgJU/PH2uEp+tiHj+nAjSiSsV+jvepw8+ywv9p/JszkxVEKLwPXns6+y6oyu75sgJ0Hj8VAjS17VWBGf0ca1SJn66F1xA0f4CKZ1InjpvyGyQtjEHHygM0ERs/466753QdX5hZ/BzeM63ET9fCKwxf4zSK8jqyUzS+pFZ3AjQ0HVMhkKDRJVK7Ti9TeT+7z9Tjp2vhNYafvSWsMsHG0MK9CdDQdEyFgS0x0w7oVd2yfl4+V5Gf5sI/vvzt4eHhx5fJn5PbKA0/c1sYRoKBonEF9frWH6Dz+rmdYyxBhcugSGk/T0/W5Ket8C++vjin8vFPqbPrDD9rpZmcC7oobnACK+alSk1rD9DZ/RwO0KQCC/OzqcxPS+HbX5zp8O53aQWUhp+z1owTQUHR5orpGfI6dmqFp13jwM82QPHz6vV5HTvFwtMKHbQLnnl9166Ljw4/vP1hO3HzZVIFtQAVj9I+EMS+jGk5UVDVz6oD1IOfhwDFz+5soobD1cLTCh20C57469P2pxIuHvg1+TsXtYYv3iSqYRNoktRl6g09WE83P2sOUBd+7gIUPwee5CLS86avY6vsJykl1IYvFK2In/FvutNHQs9aQopqj6jiAMXPhDYz+KkytooD9PGrpukfEL1umvdSrnbqDV+mWrE4mFB02sw9zw6M1lP/i6s3QPEzqdEcfioMr+IAHfpccfHPGufNWjINBo2aOhjqcxJ0uF7qsVgE9QYofib2msnPvDESoMHpFCTnp4qmwaU+qWbuefbswtBrHQ3ykwANTkfVEM+7Ej+zRllxgG4PkW76d4XMd4gk0a10GPStTF7irqD94ySTv7d6A9SLn+cAXYefTbqfijv2FQXo5smVje1pp/dTSqgOP3V7z5AFUjMP9AL0aqdBYxF71BugXvwUb6A6/WwaoZ+yljUH6Ju7raE/XzzQ/vr21Zt+EN3hp233wgdIx6Y5c18F6FlRi8P3fd3wtGOc+HmeBT/1e9ccoO19Ilsj7795aPlhf6dy0l0i2sNPcm6WKMhseuXn0Uyr/Kw5QF34KT/JskI/Bd2rDtDNL3e9UyY3X6QV0B5+wvw1+jkk6PG4K6/wKDUHqAc/u3Ms1M+TgBp+nl/5qmWydXg6H9Pt8Pj0UtGbz1O/8UZ9+NEFZjlAyh/f5SXOi6p2g6k6QB34eXUhOnq+SvzsnjW9js9Nsp/HF786EPXisel8rLfD44uHp/f3958//CT4vjCDAI2rUI2f46W6x4Zqha/6hKfdM6uft7dN0/nauuX5GbV7Kbp8tpIAzUJ/+JHmzZMDql074nIIb0Lm6G93Adr55s/1+JlbuXkVk6AEaHBaVNLmbLUCyl0v3/sJUBP0A3RFfmaWftU0BOgUFsOPOqJYhqCdu+yUa4/UJUDjuT0GaGqCevdTcNUyfUTb5DxEaEpdAlS/qOQVFph2JUAtsAjQyv3sXjRSLn7JKw7hp7EZ/lSVmULAtq1RdQI0NB1mJEDr9lN6z5w8QZPKEqAqVYNlZjpAIkDrIz9Ah35+Ez+jIECnMRp+WMFF+mlVnwANTU8w9vPF1fmpcaexMEETqxKgSnXHC80VAZZ92/ESoPokjr7/Fz/6+++6fsYEzTTjfXU+6larn66FNxv++AZf5AFSY5agBGhousv1Mefo779r+hl1qDvJWFu9DwpX6qdr4e2GH/BBq0Uaxn2tPg9PgIamu6QkmaKf9gGaV3mqg2pRAtSqtH6HJMz7GiUoARqa7hB3381EKavbfYSLo0qdfroW3jRAh2rN9vdfoDEBqo5pgCr5aRGgZd6MLWoSoIq1r4st9QDergsBGprusAuxJjrJtPxUCdBOX73TnqEuNiUJUM3iV9WWvAO6MXl/IEBD0x1O+RmZZBp+7qJONUDN0nNTqZ+uhbcd/tX2mu+vv1DnGgX1jN1FpH018cq9TDndI3jLL5et0k/XwhsPv1dutgP4crGj3ogADU13SU4yiZ/XL9I+grekQj9dC289/P6pcd3q0uWwbqT5RkGAhqZ7zybnWIKfzWHTDjyVfxOT6W5nt5FxQQJUuX5zOaFbPGUxirbS/HMgQEPT3Scl9SP9NF3tlqc9r3vZ1iNAtRs0A/8sTeEA1YxQAjQ03Xkuufruy5rCftpHW8n03BCgyhQY/rHkOvLzMkFVuhKgoenOc6nFb28vE7S7vcqlWtn8tL7MQYAatGisSscvwgzNCFAFEkYv2gG9SNAZ3+gJ0GAH7YKalPjzPO6S6VdOWoBK2xGgoenA14VMcvyqps5Jl4K7nRcTRXratCNAg9NqTWY8gEfQepkc/egX1k1zys/ifvZOe+JnuIN2QU0KBajVl2VGdi/cW7UfARqaPqWgoPbt8Rc/yvrZv2iEn1MdtAtqUubPs7wjndal21cmqGemRn/MT8ku6PkHPwpfBu/HJ36GO2gX1KTQn+dcAdqcjs9mNDSvOQEamj7lZ8Yx/O3K/dStRYAW6VOEi7f2Oe8UyfvzIEBD06f8zAtQ67U6vJOp46fgY1AEqBoLDtD+ifoZbxXJiVACNDQ99rubcZxnNFyrx4P0fgclP0UfxFccLgEanLbqY86VsqXPc4WXJqVUeHrZWF6FD9bVY3Lv8/yApLwwQNXGS4AGp636GDP2jl9wAa6761QiQDv4D9Dhdlp+Cr/NmQBVYpEBOra/N2uCahUiQLtoxGfFfkq/Dr8iP10Lv8AADRwuF0zQigT1TKV+hk7Z6Pr56lVbjgCdi0oFDTUKWVjwMF6rEQEamrbqk1UqdGunhp/7F+0riX+QqR4/XQtfoaDhNhMGlkvQegT1TIV+Cvc+zy+YmLf3AunX4dfjp6nwj0//8dG//39/nKb/+rR5558J81coaKhJRDzOnaCp/esOUPzsNEnz83JPcxTx74koDbnuAP3X3W713nx+VHTFgsbeKlQqQQPHcDllqgpQ/LxsMbXlu4EZu0jS3xMhQDeb56fzLe8dDPUqqLmhCXdaljqMD1wqSOhfc4Cuxs+ocJw4K3p6em4/86rUFKBvtu/v73778uX37X/3Wi5U0OnqKdIVMlR+JixUpaIAXYef4YtGF6+5nLp6rP9q6dIkQIA+P76zv/3saOgCBY2pnX5icV5D1xGgC/Rz4K7T2L3PlEPzuf3MKFJRgD5+1TRfnv+5c7V2QUWVBboVMbQSQa1YoJ9pn3uKuggUmtWYSvw0WxOXMraGvr+pXlBJXZlrRQ6TNFrUG6AL9DMmQLt7mviZ30G74JGOjNuJ5pPqBU2vKvashKF1CGrF8vzsfANzzDlN/FSgTIC2Z+xvvqtc0OSaWZLVYehCAnQRfp7D8+LCUfBMN37mU+IcaMvrpnnn57oFTayYa5i9oZPLOL0I9Qbo8vwc2PsMVVyAnzElwtP5mF6Ff787+c7/rVrQpHoKepkfJk3e4TK9BPUG6PL8TPj65oX4GVMiPJ2P3Spo77P7+Pfz9JPdyqhY0IRqOmoZG3o+NxY+zpusEZh2zPL8jM3PBfkZVSMwnY/hGnje8/F7r4Jmv89dV9OrpVQpUDvo6MRoKg7Q5fkZF6DL8nOySHg6H0vhf7nr+rid9ido76S7SjmFOhfl9Kr1KnfbjHVabIAuz8/C8blx4edElfB0PqbCP/76n390pr+/8yXoxYZRiVBlPTeGhl6vW8nCVx2g+JnP6v10Lbzt8K82SaOB5hIel0q95vCqFIyg7gDNBT83q/fTtfCGwx/eGB4FNTF0rGbqIAjQ0HRWafwcftyZn66Ftxp+aDPk9bAyVLlqqGCSowRoaFpeFz+D3Rz56Vp4k+FPbIDMHnUYOlFudPdnshABqlAUP0V+xhSqPEDDn/SYPuDIH/70qs/tYWKoctWIYgMramjFLStA8dNHVZmfMZUI0ByiVrrGlc7MCtZVI2tdb4PpLUKAZoCfSbWGt0H/NeHpfBwF6DWaw498y9LZi8gtMVxV7wxbStPLxgN7pf0ZcpduTvAzq+r8fg68IDydT1nh/3z5+/SLzqgNP9bOrCaX3XJLDFfVKZtYprvuFh2g+JlX1YGfE7VqD9BEdIafYqe4Sb9jdg2zsoIi42twYQGaCH4alK3MT9fCKww/0U5Zk6Gu+UVsygprjKxHAjQ0HVUCPzVqzOana+Fzh59up6DJWGeFKkNl868h5DTv9ydAQ9PT8+PndYmc5uX9NBf+8eVvDw8PP778Y/qlV2QNX2RnapNQd40yA2Vzr/Tmtr9Ygg9aFMvPAX5q4svP+gP0xdfNmY9/Sp09Y/hCOxO7hBdAo4xyXY09hP2a3f7vgwOdZzPLlwU/1fHi53Gq/2xm+et+2gUvaH9wu8O736UVkA4/w86ELtMLoVJHs67OMp22Z+UBip8WuPFz/8/+Uwr1uxW1C555fdcO46P7PR+2EzdfTs92gWj40kOjtC5xC6JT6LqutLDaEnUj1KBBAfBz8X5WHaDtT8XefHvxwK+p31crGH62nVFdogs5M1R1eZoPThFq1MEW/Fy4n0OruqYAbX+lq6vj4de340kcvoad012SKhmtXllhzcXpHMZfPqzWwZqK/Yz75biYSov181iw3gDt/WzsjtdN817K1c6U4SvZOdEluZQjQzOPG7vrt/oArdnP2B/fjCi1FD9Ha4anFTpoFzwy9Llis88a69kZbCMpZWdoauXTDM9aBP3667jqq/BV+6kVoMvxc6rmyLRCB+2CR8oJqmvnaBtpLS+Gdv2cUnQoMPsQoLP4eau4C1qtn6lFR6YVOmgXPLI9RLrp3xVicIiknp7DbXKKWa3itMpNWNDRQ/RQzZpvpK/XT9UArcVP8TKEpxU6aBc88eTKxva00/spJaaGb5GeA21yqxkaGl362s+uoVGBOVQ2PO2Yav3cBahe4Tr8FC9CeFqhg3bBE2/utob+fPHA262fV2/6QYLDN0rPgbbZ5RwYen7hXk5hYI6XHZ52TLV+dvZAjz0yGnn0syFAd/eJbI28/+ah5Yf9ncpJd4kEhm+XnkN9s8uZreXY0hcvI0APVOvn7eCNTMcgTQ9Uf342BGjLL3dNl5sv0gqMDN82PQf65teb2dDmKkCrEdSQWv0cDtA+3UCNeKkJi/fTVPjHp5eK3nye+o03Q8M3T8+BvgoFLQ1N/AOp6yS9JfX6mXwFKbxnip/yDtoFezy+eHh6f3//+cNPgu8LGzkpb/5HanFdak5Duy+oS1Bj1ufn4J5p2kK/aknot2Q/XQs/KOgMfVVK2i34VO3+01XdqOyZBfh53jONr/nqQEKPiedPi7L7R1V+uhZ+rj9Piz7zJaht5/D0slmYn7EXoVIDNMpPm313AjQ4XayxTk3TBB0vXvJyGwE6S2Odms3A9ECsvXolSdCgn2ZnPgjQ4HSxxkpFZ0lQ05VGgIamizVWKhqoerFnKgjQKT/NTn0QoMHpYo21qpruCw4Xtz0rR4CGpos11qoaU3b7qvQAXa6froVfmKBzJKjxVQ0CNDRdrLFa2Zi6kj3Q0eLV++la+KUJap6g19WNVxkBGpou1livbkqCphe/PstavZ+uhZ/vz3MpCWq9xgjQ0HS5znp1IwoLA7TnZ5F7ZgnQ4HS5zoqFbU/5DF1JNW0Ynl42a/VTFJ/d6vvwXICfroVfoKBFE9T+tm4CNDRdrrNm5QJ+HvY9l+Cna+GXKKi9oc3FhGGnwQ4E6DydVUvb+3nKUcNOm6EOBOhMnXVrF0rQAquLAA1Nl+usWxs/EzpoF9Rkxj/Peg09lS/xuWwCNDSdSeg76/Azsld4WqGDdkFNFhqg9vduNJsyfhKgwek8bkO/fFShn003ORfip2vhlxqgBRLU/A67Y6fw9LKpJ0CTP3mZVD2u5PngXeKn7Mo/ARqcLthau7p9ghZZVwRoaDqS4Wy4vQ0laFor7S+gS6V/y2e6n+Kb98PT+bgWfrEBWuIGOALUHJ3Rj2TDnAGqrc91XhKgJVhugBbYBzUtP9aGAI3mlI2hAD1/CdLpy5AErWRfQJfQIB1hfqYmKAEanC7ZW79+zWdZx9oQoLGcdi/HsmFkD7QfqGP/vZxH+AV08S9OhwAtwZID1NbQUmuKAA1Nh5gM0PBFpMlel4H66lVz+BK6+OXz5eer05fo5fUhQGfrbdHBrgUBWoKM0Z/3L1+9ejWcbnkBeols/y3Xz9CFoujSx/cB9kAlLDtALROUAC1BfoA2F9FwlQ3BH38XnQRNmGWT6Wf4u5YiK59fxkUkCQsPULsELbaiCNDQdIBDfF4ew+f1DiKOH+HmnPqmuojzD72XEKASZv3zrDlBCdAiqBzCa2VDEEmDjdzPqds8x54N5K5sBARocLpoc6MmJl0I0CKoXETSygYTCvlp9sEPAjQ4XbS5VReDNuXWEwEamg4RvkQkaG6DtZ+F75YiQOdrbtZGvw8BWoas0efFp0M/4/cim+N30Re4VzA8rdBBu6AmawhQiwQlQMuAn52Xxbzy8vuUC0CABqeLNjdspNyp4GoiQEPTRZsbNprsFJmeh2VelJ+uhZ/3z9OToYn1VMultCJA5+tu2Giq0/RV98sXLMpP18KvRFDlBC25lgjQ0HTZ7padhK0Gd0yX5adr4dciqG6CLktQz6zTz4irXxqfQlKBAA1Ol+1u20uv2bIE9cwq/Zz6iH7ECVO95UrtRYDO2N24mVa3Wa9kEKDzdTdudux2CtDeec3Y25IW5qf5aB5f/vbw8PDjyz8E887851lngi5MUGvwM7bZvtsxPw8X3tPv51yYn7ajefF1c+bjn1JnX5Ogagm6MEFNwc+Ubrt2l+kpWoKF+Wk5mrefNV3e/S6twKoEVUrQeQ8jqwpQ/Exs1/Y7BajwU1RL89NwOK/v2vX80f2eD9uJmy+TKqxLUJ0EXZqgduBncr9m6rfuYoroLlRat5oC9K9Pt0J+e/HAr1th3/lnSomVCaqSoEsT1Az8FDRssr8FZWl+2g3nedPXsVX2k5QSc/95VpigM/8NVxSg+Clp2GQG6OL8NBvP41dN0z8get0076Vc7VydoPkJujhBrcBPWccm72ukFuen2Xi2b+dXx0NDj4VYn6DZCbo4Qa3AT2FL/OxW1C54BEGlPXOazr2GCNCS4Gdqv4oCdHuIdNO/K4RDpKimGV3nXkP1BCh+ipvi52VF7YInnlzZ2J52ej+lxCoFzTF0hqsKMy+AHPwUd8XPi4raBU+8udsa+vPFA2+3fl696QeZW9DqDJ19BVUUoPgp74qf54raBc88392afP/NQ8sP+zuVk+4SWaugckNnX0EVBSh+ZrTFz1NF7YIX/HLX+6jczRdpBdYqqNTQOW5rmXsJMsBPeV/8PFbULnjJ49NLRW8+T/3Gm9UKKjR0iYJagp/yxvh5qKhdsMfji4en9/f3nz/8JPi+sPUKKjN0iYIag5/Szvi5r6hdUJPZBa3L0Fnuq559EWZk/tHjZ1pLAnTmJSjaOrX3IgX1zPyjx8+0lgTozEtQtndi80UK6pn5R4+faS0J0JmXoHDzpO5zLOv8W2hO5h89fqb1rDxAw581bgaYfgXMS38LGWhTDPxcHv0tpO0MAQpZ9LeQgTbFwM/l0d9C2s44CtBr6v5zXCN1bzH8XDqVB+jmz5e/p7wcQWuj8i2Gnwun9gBNBEFrY11bbF2jXQIEKLhmXVtsXaNdAgQouGZdW2xdo10CFQbo48vfHh4efnwp+KgxglZHfVsMP9dEbQH64uuLGwo+/il1dgStjcq2GH6ujLoC9O1nvXuy3k36vm8ErY+qthh+ro6qAvT17ssWP7rfs/vC75v+L3GHQdDaqGmL4ef6qClA//p0K+S3Fw/8uhU26T5lBK2OirYYfq6QmgL0edPXsVU26UdnELQ2Ktpi+LlCKgrQ9jdi+wdEub+7Dd6pZ4vh5xqpKECHPlfMZ42XTj1bDD/XCAEKrqlni+HnGqkoQLeHSDf9u0LSyTOtQAAAChRJREFUD5GgNjQdsgQ/14mmQzsHtAueeHJlY3va6f2UEnOvbEhH1SFL8HOVqDq0sQzQN3dbQ3++eODt1s+rN/0ktIevvjq9L6D7ARcEP5dfr4Cfhg2et4F/c//NQ8sP+zuVk+4SuWJ128t7vZoDFD+XX6/uAN38ctfbfb75Iq/g6raX93pVByh+Lr5e5QG6eXx6qejN55JvvLlkddvLe726AxQ/l16v9gDd8vji4en9/f3nDz/l2rlZ4fbyXq/yAN3g57LrLSBAVVnd9vJer/4AVWV1m8t7PQK0y+q2l/d6BGiH1W0u7/UI0C6r217e6xGgHVa3ubzXI0C7rG57ea9HgHZY3ebyXo8A7bK67eW9HgHaYXWby3s9ArTL6raX93oEaIfVbS7v9QjQLqvbXt7rEaAdVre5vNcjQLusbnt5r0eAdljd5vJejwDtsrrt5b0eAdphdZvLez0CtMvqtpf3egRoh9VtLu/1CNAuq9te3usRoB1Wt7m81yNAu6xue3mvR4B2WN3m8l6PAO2yuu3lvR4B2mF1m8t7PQK0y+q2l/d6BGiH1W0u7/UIUAAAvxCgAABCCFAAACEEKACAEAIUAEAIAQoAIIQABQAQQoACAAghQAEAhBCgAABCCFAAACEEKACAEAIUAEAIAQoAIIQABQAQQoACAAghQAEAhBCgAABCCFAAACEEKACAEAIUAEAIAQoAIIQABQAQQoACAAghQAEAhBCgAABCCFAAACGeA/Tt13dNc/Pxz2lPSeo9Pv2oaZp/S6w3uRRv7povleo9/tIu4Udf/KFU74VkBe7469N3/pnWa6ng58USrtVPxwH6y3bELTf/lfKUpN7xmab5u9IC7vjr0yZJ0EC9N8clfHdIjuR6j98fB/xJwvLtZ/2qGRJUtEXqBj/PrNdPvwH6ujnR38qBpyT1Lp5p3ldZwD1PkpYvVO/kZ9O8F/0eH6j35PxUoqGP21kHBBVtkbrBzzMr9tNtgLZvj+9ud7hffNb010jgKUm93TM/bfZP3XynsIB7XqdtrokB33zRHsndxRsVqNf63h7MvP0qZcAt2/f3q2rhXksFP7tPrdVPtwH6/Phm1q6TT2KfktR7fXpfb5+KfoufWop2o6UIGh7wYbO/jn+LD9c7DPNJ2lv8r7s9jWsFRVukbvCz89Rq/fQaoNuRHt97tu9HnY0SeEpU78lZo/h6k0vRnov53wmCxg344p8Zy/fk9NTrlIPCt9v37+bjz64FFW2RusHPwafW56fXAN2+Px4H2t8ogadE9YZflVtw+6b35fMEQQP1ths94dRXxPIJBX3eHqgNnaQXbZG6wc8zq/bTa4Berrkn3e0ceEpU74IEQScKbqX6ZJMiaHjA6YcdoeXrHCIlHMTd/P2Pwaucoi1SN/jZeWq9fjoO0NNGeT6+vaIViJsp4Q0vXHC7GbemJwo6Vm83ubuP7d++iC0XXL729NfuJP3XKVdNN3+2Lx0RNH2L1A1+nlm1n14D9HKcvXe4wFOieme2Gy56/z5ccH8QkrKxAvXaYs8PN2FE32cXXL7d2aK0ekeGBBVtkbrBz26x1fpJgJ5p7yFLucg5XvDwgJ6g/3G6jS32LozwgNsbRFo+Tj6hToDuwM8zq/aTAD0xcg+uoODxVJWOoLt723aHNH+2H9CI/BMKDvj5yfeb+IOu09IQoPiJnwcI0COPaXfthgo+OWxDRUE/OT0TuYyh5Wv9/PvvB+ETzwgRoDvws7Ng6/WTAD3wNuljHnELqHaIdD6VHn0RMVDv4jPQvzSpn8wgQHfg55lV++k1QEtf5Wy/bCDphPV4wfNtcUpXOS8/jhG9/cMrUH5XB1fhd+DnmVX76ThAS95ntztoSDphPV7wfAJnT7RQYwv4XChooN6XF/9Oe0PmPtAd+NkpuF4/vQZo2U96fB/tUURBmaCBBbzc/tFCBeplHdHwSaQd+Hlm1X56DdCCnzXebbHktTpeUCZoYAG30ycnot9AA/XUD5H4LDx+Hv69Oj+9Bmi7mQt92027wd5J/6bqiKVIOt8SqNfe/7ff6gkn1cfrtd8Wdliu+KumRwa/sFa0ReoGP8+s2U+3AXr8FsSx71scfkpSL+XzHWlLkSRooF5rVPvUnymHcoF6Ty5vE0n8HohBQUVbpG7w88ya/XQboO2bz5H9Vj6LdPVUVr3uIU28q4EFPJB2xS9Q72IRM77x+1Rv/1WQe1I/K3cpaOYWqRv8xM+N5wDd/Kv3MyYX27//VE69x6+EgoYWcE/iLRMRA076bNt4vfOYk08IDQsq2yJ1g5/46TpA+z+kd7n9NX718FDv8u0uTdDQAu5IvecsUO/Ppx9un/rbTynlQvVe/GP3VFq9lhFB+VVO/Fyln54DFADANQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAFABBCgAIACCFAAQCEEKAAAEIIUAAAIQQoAIAQAhQAQAgBCgAghAAty+umeeef7T8ev2qa92deGIAe+JkIAVqWk5cnUwH8gJ+JEKCFeXPX3Hy32fz1adN8OfeyAPTBzzQI0NI8aZr3/jj8P4A38DMJArQ0u/f27QFS+z4P4A38TIIALc5Wzn+7a5pP5l4OgCHwMwUCtDjteXoOkMAr+JkCAVqeN3ccIIFf8DMBArQ87Vs8t4iAV/AzAQK0PM/bQyROMYFT8DMBArQ4f33a3NxxjAROwc8UCNDiPNm+vT/nc3LgFPxMgQAtzev2Cicf9ACn4GcSBGhh2jP0X/JRY3AKfqZBgBbm+f4Wu9ZTztODO/AzDQK0LG+Op+f5sBw4BD8TIUDL8uR0dv4J5+nBHfiZCAEKACCEAAUAEEKAAgAIIUABAIQQoAAAQghQAAAhBCgAgBACFABACAEKACCEAAUAEEKAAgAIIUABAIQQoAAAQghQAAAhBCgAgBACFABACAEKACCEAAUAEEKAAgAIIUABAIQQoAAAQghQAAAhBCgAgBACFABACAEKACCEAAUAEEKAAgAIIUABAIQQoAAAQghQAAAhBCgAgBACFABACAEKACCEAAUAEEKAAgAIIUABAIQQoAAAQghQAAAhBCgAgBACFABACAEKACCEAAUAEEKAAgAIIUABAIQQoAAAQghQAAAhBCgAgBACFABACAEKACDk/wfl1kaAS/qbBAAAAABJRU5ErkJggg==" width="672" /> The left plot shows the query points (red) and their corresponding ranks (green). By the nature of their definition, ranks are always vertices of some cells in the RVD, except when the query is a data point <span class="math inline">\(X_i\)</span>, in which case <span class="math inline">\(\hat{R}_n\)</span> is not uniquely defined and can be any point in the closure of the cell corresponds to <span class="math inline">\(X_i\)</span>. By default, <code>tos.rank</code> will sample a point uniformly from that cell.</p>
<p>The plot on the right, meanwhile, shows the quantiles of the query points. As pointed out earlier, the query points will be map to the data points that correspond to the cells they are in.</p>
<p>The similar visualization procedure can be performed for 3D data sets as well. <code>testOTM</code> supports both interactive (via package <code>rgl</code>) and non-interactive (via package <code>plot3D</code>) plotting of the RVD and the RDT. The following example shows the optimal transport map between <span class="math inline">\(U[0,1]^3\)</span> and a trivariate Gaussian sample:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># generate trivariate normal data</span></a>
<a class="sourceLine" id="cb3-2" title="2">p =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb3-3" title="3">n =<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb3-4" title="4">Sigma =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), p, p)</a>
<a class="sourceLine" id="cb3-5" title="5">eS =<span class="st"> </span><span class="kw">eigen</span>(Sigma, <span class="dt">symmetric =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-6" title="6">X =<span class="st"> </span><span class="kw">t</span>(eS<span class="op">$</span>vectors <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(<span class="kw">pmax</span>(eS<span class="op">$</span>values, <span class="dv">0</span>)), p) <span class="op">%*%</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(p <span class="op">*</span><span class="st"> </span>n), p))</a>
<a class="sourceLine" id="cb3-7" title="7"></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co"># compute the optimal transport map from U[0, 1]^3 to the data</span></a>
<a class="sourceLine" id="cb3-9" title="9">X.OTM =<span class="st"> </span><span class="kw">tos.fit</span>(X)</a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; o-[OTM         ] In RVD (centroids)...</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; o-[RVD         ] Elapsed time: 0 s</span></a>
<a class="sourceLine" id="cb3-12" title="12"></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co"># plot the restricted Voronoi diagram and the restricted Delaunay triangulation</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="kw">plot</span>(X.OTM, <span class="dt">which =</span> <span class="st">&quot;RVD&quot;</span>, <span class="dt">draw.center =</span> T, <span class="dt">draw.map =</span> T)</a>
<a class="sourceLine" id="cb3-15" title="15"></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co"># embed the plot into the current document</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="kw">rglwidget</span>(<span class="dt">elementId =</span> <span class="st">&quot;plot3drgl&quot;</span>, <span class="dt">height =</span> <span class="dv">600</span>, <span class="dt">width =</span> <span class="dv">600</span>)</a></code></pre></div>
<div id="plot3drgl" style="width:600px;height:600px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="plot3drgl">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"12":{"id":12,"type":"clipplanes","normals":[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],"offsets":[[-0],[1],[-0],[1],[-0],[1]],"flags":1024},"13":{"id":13,"type":"points","material":{"lit":false,"size":10},"vertices":[[0.0500000007450581,0.292788326740265,0.294304698705673],[0.949999988079071,0.724738478660583,0.767610251903534],[0.808625042438507,0.774199306964874,0.546530246734619],[0.308612883090973,0.276794880628586,0.243318483233452],[0.5914266705513,0.633547902107239,0.316801309585571],[0.21311528980732,0.0500000007450581,0.276105403900146],[0.854238390922546,0.949999988079071,0.949999988079071],[0.261208951473236,0.618094146251678,0.501091420650482],[0.44914299249649,0.695672333240509,0.0500000007450581],[0.473162680864334,0.570011258125305,0.411242038011551]],"colors":[[0.0941176488995552,0.454901963472366,0.803921580314636,1]],"centers":[[0.0500000007450581,0.292788326740265,0.294304698705673],[0.949999988079071,0.724738478660583,0.767610251903534],[0.808625042438507,0.774199306964874,0.546530246734619],[0.308612883090973,0.276794880628586,0.243318483233452],[0.5914266705513,0.633547902107239,0.316801309585571],[0.21311528980732,0.0500000007450581,0.276105403900146],[0.854238390922546,0.949999988079071,0.949999988079071],[0.261208951473236,0.618094146251678,0.501091420650482],[0.44914299249649,0.695672333240509,0.0500000007450581],[0.473162680864334,0.570011258125305,0.411242038011551]],"ignoreExtent":false,"flags":4096},"14":{"id":14,"type":"lines","material":{"lit":false},"vertices":[[0,0,0],[0,0,0],[1,1,1],[1,1,1]],"colors":[[0,0,0,1]],"centers":[[0,0,0],[1,1,1]],"ignoreExtent":false,"flags":64},"16":{"id":16,"type":"sprites","material":{"lit":false,"textype":"rgba","isTransparent":true,"uri":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAARVBMVEX9/v0AAAAAADkAAGUAOY8AZo8AZrU5AAA5ZmU5j9plAABltf2POQCP2/21ZgC1/v3ajzna/v39tWX924/9/rX9/tr9/v2faK8IAAAAF3RSTlP/////////////////////////////AOZA5l4AAAD4SURBVEiJ7ZXZEoIwDEVxQ6uIiNr//1TFhmmae1PHN2aUF5ZyykmalCZ+eTR/YGFAv5qOzUWP3vbwLAOP7k20alAenRylNJ0eHmCKMobBSI1EsgCM1P043a3P0QWMVMpCiBWgkEjX22sVkFlbVwiA9NpLSuKxQrjSswjLKAVE6oBL7AHigkvsAXNuuRCt1kHeZ0IUECnMqAdI3DSCqhL/RC1oKAsK6LTiOhMgCe06T8oCcxenM5GixTfNzLvBKe8QVd1WAd00tKMNUDZNbiYPME3DpXCbyZn5tM3gvsikYKvUBiIVOMC6eMQqbMoxm8UeqnDRf6AfAp7Moaim0wOcRAAAAABJRU5ErkJggg=="},"vertices":[[0.5,-0.16949999332428,-0.16949999332428]],"colors":[[1,1,1,1]],"radii":[[0.479999989271164]],"centers":[[0.5,-0.16949999332428,-0.16949999332428]],"ignoreExtent":true,"fixedSize":true,"flags":2108},"17":{"id":17,"type":"sprites","material":{"lit":false,"textype":"rgba","isTransparent":true,"uri":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAMAAADUivDaAAAAWlBMVEX9/v0AAAAAADkAAGUAOWUAOY8AZrU5AAA5Zo85ZrU5j9plAABlOQBltf2POQCPZjmP2/21ZgC1j2W12/21/v3ajznatdra/v39tWX924/927X9/rX9/tr9/v3WjC5yAAAAHnRSTlP//////////////////////////////////////wDsGBxeAAABYUlEQVRYhe2WUVPCMBCEAREUBYwKRK3//2/aXihtYnb3GH1wxvalMzfJl9u7vbSzzx8/swkxIf4Z4uNh3j6rItrsuujGmcWhW3zzmgff1pUgRNjq+bbCLVODiJTzqhLbVlbXy1lRgnXUEamg2ZFYB2hq6DbcnihUIGK3YfFUBMZMifhmgoBMARFJ+nCq6Rhn5UBYA4Y9TAdCFEqYDjhm2blUB0RkuyI2BUFkuQdsCoaIg8kto7q5KWI0V8TcFDFsJEMqEJfZJEMqEJfDD8wUFNG30lDQFBxxboS9kLkF4myHKHRQhNVxE4QOirAqLB+FDv41s15wUyhE+qBQUyhEKigzt0ZEhw6BSHc/16F+DoLWIRDS3BphLaGmkAg1pBohbjwPgt/cHkTxSbsK0RzbCjbPa1cSALHr58uRhESodiBEP16tDOEJjOgvinsHASDe920pF3cvDsAf/o2fEBPiNxBfQlfD2++BihgAAAAASUVORK5CYII="},"vertices":[[-0.16949999332428,0.5,-0.16949999332428]],"colors":[[1,1,1,1]],"radii":[[0.660000026226044]],"centers":[[-0.16949999332428,0.5,-0.16949999332428]],"ignoreExtent":true,"fixedSize":true,"flags":2108},"18":{"id":18,"type":"sprites","material":{"lit":false,"textype":"rgba","isTransparent":true,"uri":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAS1BMVEX9/v0AAAAAADkAAGUAOY8AZrU5AAA5ZrU5j9plAABltdpltf2POQCP2/21ZgC12/21/v3ajznatWXa/v39tWX924/9/rX9/tr9/v2il05lAAAAGXRSTlP///////////////////////////////8AATQKtwAAAKhJREFUSInt0skOgzAMBFBSoCyFsLbl/78UifiSZMYqh0qA8NHMA2lMsuyc5AZHA9/G4En784NswiAaeYP3ARVYl++8pQKGLf9o/S0HLm9ewZqC2eXLcM/A+7nl8+gBAZ8qLlQDUijIYwAPoAELC+WAFErBSAplQA5Q4HwM6AEI4AfAQCsUAcnjQhGwWqEAyAFqJe8B9kczIHlaaAikUDj5VcGPc4O/gBW0irOPmLL3NwAAAABJRU5ErkJggg=="},"vertices":[[-0.16949999332428,-0.16949999332428,0.5]],"colors":[[1,1,1,1]],"radii":[[0.479999989271164]],"centers":[[-0.16949999332428,-0.16949999332428,0.5]],"ignoreExtent":true,"fixedSize":true,"flags":2108},"19":{"id":19,"type":"points","material":{"lit":false,"size":10},"vertices":[[0.107951775193214,0.359132528305054,0.453938156366348],[0.831536889076233,0.331340819597244,0.786424160003662],[0.784908771514893,0.744213342666626,0.445668935775757],[0.551497161388397,0.224275335669518,0.251888513565063],[0.750945746898651,0.507559657096863,0.248594731092453],[0.335152238607407,0.0807868093252182,0.509166896343231],[0.626523435115814,0.803827166557312,0.851104021072388],[0.157517433166504,0.705608904361725,0.720765233039856],[0.394764274358749,0.769216477870941,0.127093687653542],[0.459202289581299,0.474039018154144,0.605355679988861]],"colors":[[1,0.498039215803146,0,1]],"centers":[[0.107951775193214,0.359132528305054,0.453938156366348],[0.831536889076233,0.331340819597244,0.786424160003662],[0.784908771514893,0.744213342666626,0.445668935775757],[0.551497161388397,0.224275335669518,0.251888513565063],[0.750945746898651,0.507559657096863,0.248594731092453],[0.335152238607407,0.0807868093252182,0.509166896343231],[0.626523435115814,0.803827166557312,0.851104021072388],[0.157517433166504,0.705608904361725,0.720765233039856],[0.394764274358749,0.769216477870941,0.127093687653542],[0.459202289581299,0.474039018154144,0.605355679988861]],"ignoreExtent":false,"flags":4096},"20":{"id":20,"type":"lines","material":{"lit":false},"vertices":[[0.0500000007450581,0.292788326740265,0.294304698705673],[0.107951775193214,0.359132528305054,0.453938156366348]],"colors":[[0.498039215803146,0.498039215803146,0.498039215803146,1]],"centers":[[0.0789758861064911,0.325960427522659,0.374121427536011]],"ignoreExtent":false,"flags":64},"21":{"id":21,"type":"lines","material":{"lit":false},"vertices":[[0.949999988079071,0.724738478660583,0.767610251903534],[0.831536889076233,0.331340819597244,0.786424160003662]],"colors":[[0.498039215803146,0.498039215803146,0.498039215803146,1]],"centers":[[0.89076840877533,0.528039634227753,0.77701723575592]],"ignoreExtent":false,"flags":64},"22":{"id":22,"type":"lines","material":{"lit":false},"vertices":[[0.808625042438507,0.774199306964874,0.546530246734619],[0.784908771514893,0.744213342666626,0.445668935775757]],"colors":[[0.498039215803146,0.498039215803146,0.498039215803146,1]],"centers":[[0.796766877174377,0.759206295013428,0.496099591255188]],"ignoreExtent":false,"flags":64},"23":{"id":23,"type":"lines","material":{"lit":false},"vertices":[[0.308612883090973,0.276794880628586,0.243318483233452],[0.551497161388397,0.224275335669518,0.251888513565063]],"colors":[[0.498039215803146,0.498039215803146,0.498039215803146,1]],"centers":[[0.430055022239685,0.250535100698471,0.247603505849838]],"ignoreExtent":false,"flags":64},"24":{"id":24,"type":"lines","material":{"lit":false},"vertices":[[0.5914266705513,0.633547902107239,0.316801309585571],[0.750945746898651,0.507559657096863,0.248594731092453]],"colors":[[0.498039215803146,0.498039215803146,0.498039215803146,1]],"centers":[[0.671186208724976,0.570553779602051,0.282698035240173]],"ignoreExtent":false,"flags":64},"25":{"id":25,"type":"lines","material":{"lit":false},"vertices":[[0.21311528980732,0.0500000007450581,0.276105403900146],[0.335152238607407,0.0807868093252182,0.509166896343231]],"colors":[[0.498039215803146,0.498039215803146,0.498039215803146,1]],"centers":[[0.274133771657944,0.065393403172493,0.392636150121689]],"ignoreExtent":false,"flags":64},"26":{"id":26,"type":"lines","material":{"lit":false},"vertices":[[0.854238390922546,0.949999988079071,0.949999988079071],[0.626523435115814,0.803827166557312,0.851104021072388]],"colors":[[0.498039215803146,0.498039215803146,0.498039215803146,1]],"centers":[[0.740380883216858,0.876913547515869,0.900552034378052]],"ignoreExtent":false,"flags":64},"27":{"id":27,"type":"lines","material":{"lit":false},"vertices":[[0.261208951473236,0.618094146251678,0.501091420650482],[0.157517433166504,0.705608904361725,0.720765233039856]],"colors":[[0.498039215803146,0.498039215803146,0.498039215803146,1]],"centers":[[0.20936319231987,0.661851525306702,0.610928297042847]],"ignoreExtent":false,"flags":64},"28":{"id":28,"type":"lines","material":{"lit":false},"vertices":[[0.44914299249649,0.695672333240509,0.0500000007450581],[0.394764274358749,0.769216477870941,0.127093687653542]],"colors":[[0.498039215803146,0.498039215803146,0.498039215803146,1]],"centers":[[0.421953618526459,0.732444405555725,0.0885468423366547]],"ignoreExtent":false,"flags":64},"29":{"id":29,"type":"lines","material":{"lit":false},"vertices":[[0.473162680864334,0.570011258125305,0.411242038011551],[0.459202289581299,0.474039018154144,0.605355679988861]],"colors":[[0.498039215803146,0.498039215803146,0.498039215803146,1]],"centers":[[0.466182470321655,0.522025108337402,0.508298873901367]],"ignoreExtent":false,"flags":64},"30":{"id":30,"type":"lines","material":{"lit":false},"vertices":[[0,0.827454686164856,0.263882011175156],[0,0.359527468681335,1],[0,0.667439341545105,0],[0,0.827454686164856,0.263882011175156],[0,0.0945437401533127,0],[0,0.667439341545105,0],[0,0.0945437401533127,0],[0,0.0195842701941729,1],[0,0.0195842701941729,1],[0,0.359527468681335,1],[0,0.0195842701941729,1],[0.25731748342514,0.192460834980011,1],[0,0.359527468681335,1],[0.25731748342514,0.192460834980011,1],[0,0.667439341545105,0],[0.191224694252014,0.477990299463272,0],[0.1747727394104,0.211963325738907,0],[0.191224694252014,0.477990299463272,0],[0,0.0945437401533127,0],[0.1747727394104,0.211963325738907,0],[0.1747727394104,0.211963325738907,0],[0.326506614685059,0.257279187440872,0.755411684513092],[0.191224694252014,0.477990299463272,0],[0.249927684664726,0.580826580524445,0.265496224164963],[0.249927684664726,0.580826580524445,0.265496224164963],[0.326506614685059,0.257279187440872,0.755411684513092],[0.326506614685059,0.257279187440872,0.755411684513092],[0.306019753217697,0.233782574534416,0.885251045227051],[0.306019753217697,0.233782574534416,0.885251045227051],[0.25731748342514,0.192460834980011,1],[0.165632948279381,0.690970957279205,0.309415817260742],[0.306019753217697,0.233782574534416,0.885251045227051],[0,0.827454686164856,0.263882011175156],[0.165632948279381,0.690970957279205,0.309415817260742],[0.249927684664726,0.580826580524445,0.265496224164963],[0.165632948279381,0.690970957279205,0.309415817260742],[0.448492556810379,0.338513553142548,1],[1,0.572966635227203,1],[0.528206646442413,0.0928511694073677,1],[0.448492556810379,0.338513553142548,1],[0.613227069377899,0,1],[0.528206646442413,0.0928511694073677,1],[0.613227069377899,0,1],[1,0,1],[1,0,1],[1,0.572966635227203,1],[1,0.909271836280823,0.584644317626953],[1,0.572966635227203,1],[1,0,0.452482432126999],[1,0,1],[1,0,0.452482432126999],[1,0.00440896023064852,0.448715507984161],[1,0.00440896023064852,0.448715507984161],[1,0.160534471273422,0.41713410615921],[1,0.160534471273422,0.41713410615921],[1,0.909271836280823,0.584644317626953],[1,0,0.452482432126999],[0.882753074169159,0,0.595915257930756],[0.882753074169159,0,0.595915257930756],[0.613227069377899,0,1],[1,0.160534471273422,0.41713410615921],[0.830040276050568,0.222742736339569,0.539736390113831],[0.830040276050568,0.222742736339569,0.539736390113831],[0.533897936344147,0.537192404270172,0.799461603164673],[0.533897936344147,0.537192404270172,0.799461603164673],[1,0.909271836280823,0.584644317626953],[0.893466889858246,0.0743216276168823,0.519309818744659],[0.794080555438995,0.0471910685300827,0.664072930812836],[1,0.00440896023064852,0.448715507984161],[0.893466889858246,0.0743216276168823,0.519309818744659],[0.882753074169159,0,0.595915257930756],[0.794080555438995,0.0471910685300827,0.664072930812836],[0.893466889858246,0.0743216276168823,0.519309818744659],[0.830040276050568,0.222742736339569,0.539736390113831],[0.794080555438995,0.0471910685300827,0.664072930812836],[0.528206646442413,0.0928511694073677,1],[0.448492556810379,0.338513553142548,1],[0.533897936344147,0.537192404270172,0.799461603164673],[0.345451474189758,1,0.568228840827942],[0.341187983751297,1,0.619592428207397],[0.341187983751297,1,0.619592428207397],[1,1,0.545112013816833],[1,1,0],[1,1,0.545112013816833],[0.966240227222443,1,0],[1,1,0],[0.673150837421417,1,0.212193265557289],[0.966240227222443,1,0],[0.375572621822357,1,0.493540048599243],[0.673150837421417,1,0.212193265557289],[0.375572621822357,1,0.493540048599243],[0.345451474189758,1,0.568228840827942],[1,0.160534471273422,0.41713410615921],[1,0.840593278408051,0.000768690020777285],[1,0.840593278408051,0.000768690020777285],[1,0.84545373916626,0],[1,0.84545373916626,0],[1,1,0],[1,0.909271836280823,0.584644317626953],[1,1,0.545112013816833],[1,0.160534471273422,0.41713410615921],[1,0.909271836280823,0.584644317626953],[1,0.84545373916626,0],[0.966240227222443,1,0],[0.533897936344147,0.537192404270172,0.799461603164673],[1,0.909271836280823,0.584644317626953],[0.830040276050568,0.222742736339569,0.539736390113831],[0.533897936344147,0.537192404270172,0.799461603164673],[1,0.160534471273422,0.41713410615921],[0.830040276050568,0.222742736339569,0.539736390113831],[0.830040276050568,0.222742736339569,0.539736390113831],[0.375572621822357,1,0.493540048599243],[1,0.840593278408051,0.000768690020777285],[0.673150837421417,1,0.212193265557289],[0.362606942653656,0.914787173271179,0.654300093650818],[0.341187983751297,1,0.619592428207397],[0.533897936344147,0.537192404270172,0.799461603164673],[0.362606942653656,0.914787173271179,0.654300093650818],[0.345451474189758,1,0.568228840827942],[0.362606942653656,0.914787173271179,0.654300093650818],[1,0,0],[1,0,0.452482432126999],[1,0,0],[1,0.0968339070677757,0],[1,0.0968339070677757,0],[1,0.00440896023064852,0.448715507984161],[1,0,0.452482432126999],[1,0.00440896023064852,0.448715507984161],[1,0,0.452482432126999],[0.882753074169159,0,0.595915257930756],[0.678159177303314,0,0],[0.882753074169159,0,0.595915257930756],[0.678159177303314,0,0],[1,0,0],[0.759828984737396,0.287228018045425,0],[1,0.0968339070677757,0],[0.1747727394104,0.211963325738907,0],[0.678159177303314,0,0],[0.1747727394104,0.211963325738907,0],[0.191224694252014,0.477990299463272,0],[0.191224694252014,0.477990299463272,0],[0.759828984737396,0.287228018045425,0],[0.249927684664726,0.580826580524445,0.265496224164963],[0.326506614685059,0.257279187440872,0.755411684513092],[0.191224694252014,0.477990299463272,0],[0.249927684664726,0.580826580524445,0.265496224164963],[0.1747727394104,0.211963325738907,0],[0.326506614685059,0.257279187440872,0.755411684513092],[0.893466889858246,0.0743216276168823,0.519309818744659],[0.794080555438995,0.0471910685300827,0.664072930812836],[0.882753074169159,0,0.595915257930756],[0.794080555438995,0.0471910685300827,0.664072930812836],[1,0.00440896023064852,0.448715507984161],[0.893466889858246,0.0743216276168823,0.519309818744659],[0.759828984737396,0.287228018045425,0],[0.42945072054863,0.502516984939575,0.22631873190403],[0.42945072054863,0.502516984939575,0.22631873190403],[0.893466889858246,0.0743216276168823,0.519309818744659],[0.326506614685059,0.257279187440872,0.755411684513092],[0.794080555438995,0.0471910685300827,0.664072930812836],[0.249927684664726,0.580826580524445,0.265496224164963],[0.42945072054863,0.502516984939575,0.22631873190403],[0.375572621822357,1,0.493540048599243],[0.673150837421417,1,0.212193265557289],[0.306882351636887,1,0.407522231340408],[0.673150837421417,1,0.212193265557289],[0.306882351636887,1,0.407522231340408],[0.375572621822357,1,0.493540048599243],[1,0.0968339070677757,0],[1,0.00440896023064852,0.448715507984161],[1,0.0968339070677757,0],[1,0.837292075157166,0],[1,0.837292075157166,0],[1,0.840593278408051,0.000768690020777285],[1,0.160534471273422,0.41713410615921],[1,0.840593278408051,0.000768690020777285],[1,0.00440896023064852,0.448715507984161],[1,0.160534471273422,0.41713410615921],[0.759828984737396,0.287228018045425,0],[1,0.0968339070677757,0],[0.759828984737396,0.287228018045425,0],[1,0.837292075157166,0],[1,0.160534471273422,0.41713410615921],[0.830040276050568,0.222742736339569,0.539736390113831],[0.893466889858246,0.0743216276168823,0.519309818744659],[0.830040276050568,0.222742736339569,0.539736390113831],[1,0.00440896023064852,0.448715507984161],[0.893466889858246,0.0743216276168823,0.519309818744659],[0.830040276050568,0.222742736339569,0.539736390113831],[0.375572621822357,1,0.493540048599243],[1,0.840593278408051,0.000768690020777285],[0.673150837421417,1,0.212193265557289],[0.42945072054863,0.502516984939575,0.22631873190403],[0.893466889858246,0.0743216276168823,0.519309818744659],[0.759828984737396,0.287228018045425,0],[0.42945072054863,0.502516984939575,0.22631873190403],[0.42945072054863,0.502516984939575,0.22631873190403],[0.306882351636887,1,0.407522231340408],[0,0.0945437401533127,0],[0,0.0195842701941729,1],[0,0,0],[0,0.0945437401533127,0],[0,0,0],[0,0,1],[0,0,1],[0,0.0195842701941729,1],[0.25731748342514,0.192460834980011,1],[0.343631267547607,0.185153692960739,1],[0,0.0195842701941729,1],[0.25731748342514,0.192460834980011,1],[0,0,1],[0.613227069377899,0,1],[0.613227069377899,0,1],[0.528206646442413,0.0928511694073677,1],[0.343631267547607,0.185153692960739,1],[0.528206646442413,0.0928511694073677,1],[0.882753074169159,0,0.595915257930756],[0.613227069377899,0,1],[0,0,0],[0.678159177303314,0,0],[0.678159177303314,0,0],[0.882753074169159,0,0.595915257930756],[0.1747727394104,0.211963325738907,0],[0.678159177303314,0,0],[0,0.0945437401533127,0],[0.1747727394104,0.211963325738907,0],[0.326506614685059,0.257279187440872,0.755411684513092],[0.306019753217697,0.233782574534416,0.885251045227051],[0.1747727394104,0.211963325738907,0],[0.326506614685059,0.257279187440872,0.755411684513092],[0.306019753217697,0.233782574534416,0.885251045227051],[0.25731748342514,0.192460834980011,1],[0.882753074169159,0,0.595915257930756],[0.794080555438995,0.0471910685300827,0.664072930812836],[0.794080555438995,0.0471910685300827,0.664072930812836],[0.528206646442413,0.0928511694073677,1],[0.326506614685059,0.257279187440872,0.755411684513092],[0.794080555438995,0.0471910685300827,0.664072930812836],[0.306019753217697,0.233782574534416,0.885251045227051],[0.343631267547607,0.185153692960739,1],[0.341187983751297,1,0.619592428207397],[1,1,0.545112013816833],[0.341187983751297,1,0.619592428207397],[0.0532288812100887,1,1],[0.0532288812100887,1,1],[1,1,1],[1,1,0.545112013816833],[1,1,1],[0.448492556810379,0.338513553142548,1],[1,0.572966635227203,1],[1,0.572966635227203,1],[1,1,1],[0.391408652067184,0.395760715007782,1],[0.0532288812100887,1,1],[0.448492556810379,0.338513553142548,1],[0.391408652067184,0.395760715007782,1],[1,0.909271836280823,0.584644317626953],[1,0.572966635227203,1],[1,0.909271836280823,0.584644317626953],[1,1,0.545112013816833],[0.448492556810379,0.338513553142548,1],[0.533897936344147,0.537192404270172,0.799461603164673],[0.533897936344147,0.537192404270172,0.799461603164673],[1,0.909271836280823,0.584644317626953],[0.533897936344147,0.537192404270172,0.799461603164673],[0.362606942653656,0.914787173271179,0.654300093650818],[0.362606942653656,0.914787173271179,0.654300093650818],[0.341187983751297,1,0.619592428207397],[0.391408652067184,0.395760715007782,1],[0.362606942653656,0.914787173271179,0.654300093650818],[0.278136521577835,1,0.409433603286743],[0.345451474189758,1,0.568228840827942],[0,1,0.293556183576584],[0.278136521577835,1,0.409433603286743],[0,1,0.293556183576584],[0,1,1],[0,1,1],[0.0532288812100887,1,1],[0.341187983751297,1,0.619592428207397],[0.0532288812100887,1,1],[0.345451474189758,1,0.568228840827942],[0.341187983751297,1,0.619592428207397],[0,0.827454686164856,0.263882011175156],[0,1,0.293556183576584],[0,0.827454686164856,0.263882011175156],[0,0.359527468681335,1],[0,0.359527468681335,1],[0,1,1],[0,0.359527468681335,1],[0.25731748342514,0.192460834980011,1],[0.25731748342514,0.192460834980011,1],[0.343631267547607,0.185153692960739,1],[0.343631267547607,0.185153692960739,1],[0.391408652067184,0.395760715007782,1],[0.391408652067184,0.395760715007782,1],[0.0532288812100887,1,1],[0.165632948279381,0.690970957279205,0.309415817260742],[0.306019753217697,0.233782574534416,0.885251045227051],[0.306019753217697,0.233782574534416,0.885251045227051],[0.25731748342514,0.192460834980011,1],[0,0.827454686164856,0.263882011175156],[0.165632948279381,0.690970957279205,0.309415817260742],[0.362606942653656,0.914787173271179,0.654300093650818],[0.341187983751297,1,0.619592428207397],[0.345451474189758,1,0.568228840827942],[0.362606942653656,0.914787173271179,0.654300093650818],[0.306019753217697,0.233782574534416,0.885251045227051],[0.343631267547607,0.185153692960739,1],[0.391408652067184,0.395760715007782,1],[0.362606942653656,0.914787173271179,0.654300093650818],[0.165632948279381,0.690970957279205,0.309415817260742],[0.278136521577835,1,0.409433603286743],[0.278136521577835,1,0.409433603286743],[0.306882351636887,1,0.407522231340408],[0.306882351636887,1,0.407522231340408],[0.673150837421417,1,0.212193265557289],[0.673150837421417,1,0.212193265557289],[0.966240227222443,1,0],[0,1,0],[0.966240227222443,1,0],[0,1,0],[0,1,0.293556183576584],[0,1,0.293556183576584],[0.278136521577835,1,0.409433603286743],[0,0.827454686164856,0.263882011175156],[0,1,0.293556183576584],[0,0.667439341545105,0],[0,1,0],[0,0.667439341545105,0],[0,0.827454686164856,0.263882011175156],[1,0.837292075157166,0],[1,0.84545373916626,0],[1,0.840593278408051,0.000768690020777285],[1,0.84545373916626,0],[1,0.837292075157166,0],[1,0.840593278408051,0.000768690020777285],[0.759828984737396,0.287228018045425,0],[1,0.837292075157166,0],[0.191224694252014,0.477990299463272,0],[0.759828984737396,0.287228018045425,0],[0,0.667439341545105,0],[0.191224694252014,0.477990299463272,0],[1,0.84545373916626,0],[0.966240227222443,1,0],[0,0.827454686164856,0.263882011175156],[0.165632948279381,0.690970957279205,0.309415817260742],[0.191224694252014,0.477990299463272,0],[0.249927684664726,0.580826580524445,0.265496224164963],[0.249927684664726,0.580826580524445,0.265496224164963],[0.165632948279381,0.690970957279205,0.309415817260742],[1,0.840593278408051,0.000768690020777285],[0.673150837421417,1,0.212193265557289],[0.759828984737396,0.287228018045425,0],[0.42945072054863,0.502516984939575,0.22631873190403],[0.249927684664726,0.580826580524445,0.265496224164963],[0.42945072054863,0.502516984939575,0.22631873190403],[0.42945072054863,0.502516984939575,0.22631873190403],[0.306882351636887,1,0.407522231340408],[0.165632948279381,0.690970957279205,0.309415817260742],[0.278136521577835,1,0.409433603286743],[0.375572621822357,1,0.493540048599243],[0.345451474189758,1,0.568228840827942],[0.306882351636887,1,0.407522231340408],[0.375572621822357,1,0.493540048599243],[0.278136521577835,1,0.409433603286743],[0.306882351636887,1,0.407522231340408],[0.278136521577835,1,0.409433603286743],[0.345451474189758,1,0.568228840827942],[0.528206646442413,0.0928511694073677,1],[0.448492556810379,0.338513553142548,1],[0.448492556810379,0.338513553142548,1],[0.391408652067184,0.395760715007782,1],[0.343631267547607,0.185153692960739,1],[0.391408652067184,0.395760715007782,1],[0.343631267547607,0.185153692960739,1],[0.528206646442413,0.0928511694073677,1],[0.165632948279381,0.690970957279205,0.309415817260742],[0.306019753217697,0.233782574534416,0.885251045227051],[0.249927684664726,0.580826580524445,0.265496224164963],[0.165632948279381,0.690970957279205,0.309415817260742],[0.249927684664726,0.580826580524445,0.265496224164963],[0.326506614685059,0.257279187440872,0.755411684513092],[0.326506614685059,0.257279187440872,0.755411684513092],[0.306019753217697,0.233782574534416,0.885251045227051],[0.794080555438995,0.0471910685300827,0.664072930812836],[0.528206646442413,0.0928511694073677,1],[0.893466889858246,0.0743216276168823,0.519309818744659],[0.794080555438995,0.0471910685300827,0.664072930812836],[0.893466889858246,0.0743216276168823,0.519309818744659],[0.830040276050568,0.222742736339569,0.539736390113831],[0.830040276050568,0.222742736339569,0.539736390113831],[0.533897936344147,0.537192404270172,0.799461603164673],[0.448492556810379,0.338513553142548,1],[0.533897936344147,0.537192404270172,0.799461603164673],[0.345451474189758,1,0.568228840827942],[0.362606942653656,0.914787173271179,0.654300093650818],[0.533897936344147,0.537192404270172,0.799461603164673],[0.362606942653656,0.914787173271179,0.654300093650818],[0.830040276050568,0.222742736339569,0.539736390113831],[0.375572621822357,1,0.493540048599243],[0.42945072054863,0.502516984939575,0.22631873190403],[0.893466889858246,0.0743216276168823,0.519309818744659],[0.326506614685059,0.257279187440872,0.755411684513092],[0.794080555438995,0.0471910685300827,0.664072930812836],[0.249927684664726,0.580826580524445,0.265496224164963],[0.42945072054863,0.502516984939575,0.22631873190403],[0.42945072054863,0.502516984939575,0.22631873190403],[0.306882351636887,1,0.407522231340408],[0.306019753217697,0.233782574534416,0.885251045227051],[0.343631267547607,0.185153692960739,1],[0.391408652067184,0.395760715007782,1],[0.362606942653656,0.914787173271179,0.654300093650818],[0.165632948279381,0.690970957279205,0.309415817260742],[0.278136521577835,1,0.409433603286743]],"colors":[[0,0,0,1]],"centers":[[0,0.593491077423096,0.631941020488739],[0,0.74744701385498,0.131941005587578],[0,0.380991548299789,0],[0,0.0570640042424202,0.5],[0,0.189555868506432,1],[0.12865874171257,0.106022551655769,1],[0.12865874171257,0.275994151830673,1],[0.0956123471260071,0.572714805603027,0],[0.182998716831207,0.344976812601089,0],[0.0873863697052002,0.153253525495529,0],[0.250639677047729,0.23462125658989,0.377705842256546],[0.220576196908951,0.52940845489502,0.132748112082481],[0.288217157125473,0.41905289888382,0.510453939437866],[0.316263198852539,0.245530873537064,0.820331335067749],[0.281668603420258,0.213121712207794,0.942625522613525],[0.235826343297958,0.462376773357391,0.597333431243896],[0.0828164741396904,0.759212851524353,0.28664892911911],[0.207780316472054,0.635898768901825,0.287456035614014],[0.724246263504028,0.455740094184875,1],[0.488349616527557,0.215682357549667,1],[0.570716857910156,0.0464255847036839,1],[0.806613564491272,0,1],[1,0.286483317613602,1],[1,0.741119265556335,0.792322158813477],[1,0,0.726241230964661],[1,0.00220448011532426,0.450598955154419],[1,0.0824717134237289,0.432924807071686],[1,0.534903168678284,0.500889182090759],[0.941376566886902,0,0.524198830127716],[0.747990071773529,0,0.7979576587677],[0.915020108222961,0.191638603806496,0.47843524813652],[0.681969106197357,0.379967570304871,0.669598996639252],[0.766948938369751,0.72323215007782,0.692052960395813],[0.843773722648621,0.0607563480734825,0.591691374778748],[0.946733474731445,0.0393652953207493,0.48401266336441],[0.838416814804077,0.0235955342650414,0.629994094371796],[0.861753582954407,0.148532181978226,0.529523134231567],[0.661143600940704,0.0700211226940155,0.83203649520874],[0.491195261478424,0.43785297870636,0.899730801582336],[0.343319714069366,1,0.59391063451767],[0.670593976974487,1,0.582352221012115],[1,1,0.272556006908417],[0.983120083808899,1,0],[0.81969553232193,1,0.106096632778645],[0.524361729621887,1,0.352866649627686],[0.360512048006058,1,0.530884444713593],[1,0.500563859939575,0.208951398730278],[1,0.843023538589478,0.000384345010388643],[1,0.92272686958313,0],[1,0.954635918140411,0.564878165721893],[1,0.534903168678284,0.500889182090759],[0.983120083808899,0.92272686958313,0],[0.766948938369751,0.72323215007782,0.692052960395813],[0.681969106197357,0.379967570304871,0.669598996639252],[0.915020108222961,0.191638603806496,0.47843524813652],[0.602806448936462,0.611371397972107,0.516638219356537],[0.836575388908386,0.920296669006348,0.106480978429317],[0.351897478103638,0.95739358663559,0.636946260929108],[0.448252439498901,0.725989818572998,0.726880848407745],[0.354029208421707,0.95739358663559,0.61126446723938],[1,0,0.226241216063499],[1,0.0484169535338879,0],[1,0.050621435046196,0.224357753992081],[1,0.00220448011532426,0.450598955154419],[0.941376566886902,0,0.524198830127716],[0.780456125736237,0,0.297957628965378],[0.839079618453979,0,0],[0.879914522171021,0.192030966281891,0],[0.426465958356857,0.105981662869453,0],[0.182998716831207,0.344976812601089,0],[0.475526839494705,0.382609158754349,0],[0.288217157125473,0.41905289888382,0.510453939437866],[0.220576196908951,0.52940845489502,0.132748112082481],[0.250639677047729,0.23462125658989,0.377705842256546],[0.843773722648621,0.0607563480734825,0.591691374778748],[0.838416814804077,0.0235955342650414,0.629994094371796],[0.946733474731445,0.0393652953207493,0.48401266336441],[0.594639837741852,0.394872486591339,0.113159365952015],[0.661458790302277,0.288419306278229,0.372814267873764],[0.560293555259705,0.152235120534897,0.709742307662964],[0.339689195156097,0.541671752929688,0.245907485485077],[0.524361729621887,1,0.352866649627686],[0.490016579627991,1,0.309857755899429],[0.341227471828461,1,0.450531125068665],[1,0.050621435046196,0.224357753992081],[1,0.4670629799366,0],[1,0.838942646980286,0.000384345010388643],[1,0.500563859939575,0.208951398730278],[1,0.0824717134237289,0.432924807071686],[0.879914522171021,0.192030966281891,0],[0.879914522171021,0.562260031700134,0],[0.915020108222961,0.191638603806496,0.47843524813652],[0.861753582954407,0.148532181978226,0.529523134231567],[0.946733474731445,0.0393652953207493,0.48401266336441],[0.602806448936462,0.611371397972107,0.516638219356537],[0.836575388908386,0.920296669006348,0.106480978429317],[0.661458790302277,0.288419306278229,0.372814267873764],[0.594639837741852,0.394872486591339,0.113159365952015],[0.368166536092758,0.751258492469788,0.3169204890728],[0,0.0570640042424202,0.5],[0,0.0472718700766563,0],[0,0,0.5],[0,0.00979213509708643,1],[0.300474375486374,0.188807263970375,1],[0.12865874171257,0.106022551655769,1],[0.30661353468895,0,1],[0.570716857910156,0.0464255847036839,1],[0.43591895699501,0.139002427458763,1],[0.747990071773529,0,0.7979576587677],[0.339079588651657,0,0],[0.780456125736237,0,0.297957628965378],[0.426465958356857,0.105981662869453,0],[0.0873863697052002,0.153253525495529,0],[0.316263198852539,0.245530873537064,0.820331335067749],[0.250639677047729,0.23462125658989,0.377705842256546],[0.281668603420258,0.213121712207794,0.942625522613525],[0.838416814804077,0.0235955342650414,0.629994094371796],[0.661143600940704,0.0700211226940155,0.83203649520874],[0.560293555259705,0.152235120534897,0.709742307662964],[0.324825525283813,0.209468126296997,0.942625522613525],[0.670593976974487,1,0.582352221012115],[0.197208434343338,1,0.809796214103699],[0.526614427566528,1,1],[1,1,0.772556006908417],[0.724246263504028,0.455740094184875,1],[1,0.786483287811279,1],[0.222318768501282,0.697880387306213,1],[0.419950604438782,0.367137134075165,1],[1,0.741119265556335,0.792322158813477],[1,0.954635918140411,0.564878165721893],[0.491195261478424,0.43785297870636,0.899730801582336],[0.766948938369751,0.72323215007782,0.692052960395813],[0.448252439498901,0.725989818572998,0.726880848407745],[0.351897478103638,0.95739358663559,0.636946260929108],[0.377007782459259,0.655273914337158,0.827150046825409],[0.311793982982635,1,0.488831222057343],[0.139068260788918,1,0.351494908332825],[0,1,0.646778106689453],[0.0266144406050444,1,1],[0.197208434343338,1,0.809796214103699],[0.343319714069366,1,0.59391063451767],[0,0.913727343082428,0.27871909737587],[0,0.593491077423096,0.631941020488739],[0,0.679763734340668,1],[0.12865874171257,0.275994151830673,1],[0.300474375486374,0.188807263970375,1],[0.367519974708557,0.290457189083099,1],[0.222318768501282,0.697880387306213,1],[0.235826343297958,0.462376773357391,0.597333431243896],[0.281668603420258,0.213121712207794,0.942625522613525],[0.0828164741396904,0.759212851524353,0.28664892911911],[0.351897478103638,0.95739358663559,0.636946260929108],[0.354029208421707,0.95739358663559,0.61126446723938],[0.324825525283813,0.209468126296997,0.942625522613525],[0.377007782459259,0.655273914337158,0.827150046825409],[0.221884727478027,0.84548544883728,0.359424710273743],[0.292509436607361,1,0.408477902412415],[0.490016579627991,1,0.309857755899429],[0.81969553232193,1,0.106096632778645],[0.483120113611221,1,0],[0,1,0.146778091788292],[0.139068260788918,1,0.351494908332825],[0,0.913727343082428,0.27871909737587],[0,0.833719670772552,0],[0,0.74744701385498,0.131941005587578],[1,0.841372907161713,0],[1,0.843023538589478,0.000384345010388643],[1,0.838942646980286,0.000384345010388643],[0.879914522171021,0.562260031700134,0],[0.475526839494705,0.382609158754349,0],[0.0956123471260071,0.572714805603027,0],[0.983120083808899,0.92272686958313,0],[0.0828164741396904,0.759212851524353,0.28664892911911],[0.220576196908951,0.52940845489502,0.132748112082481],[0.207780316472054,0.635898768901825,0.287456035614014],[0.836575388908386,0.920296669006348,0.106480978429317],[0.594639837741852,0.394872486591339,0.113159365952015],[0.339689195156097,0.541671752929688,0.245907485485077],[0.368166536092758,0.751258492469788,0.3169204890728],[0.221884727478027,0.84548544883728,0.359424710273743],[0.360512048006058,1,0.530884444713593],[0.341227471828461,1,0.450531125068665],[0.292509436607361,1,0.408477902412415],[0.311793982982635,1,0.488831222057343],[0.488349616527557,0.215682357549667,1],[0.419950604438782,0.367137134075165,1],[0.367519974708557,0.290457189083099,1],[0.43591895699501,0.139002427458763,1],[0.235826343297958,0.462376773357391,0.597333431243896],[0.207780316472054,0.635898768901825,0.287456035614014],[0.288217157125473,0.41905289888382,0.510453939437866],[0.316263198852539,0.245530873537064,0.820331335067749],[0.661143600940704,0.0700211226940155,0.83203649520874],[0.843773722648621,0.0607563480734825,0.591691374778748],[0.861753582954407,0.148532181978226,0.529523134231567],[0.681969106197357,0.379967570304871,0.669598996639252],[0.491195261478424,0.43785297870636,0.899730801582336],[0.354029208421707,0.95739358663559,0.61126446723938],[0.448252439498901,0.725989818572998,0.726880848407745],[0.602806448936462,0.611371397972107,0.516638219356537],[0.661458790302277,0.288419306278229,0.372814267873764],[0.560293555259705,0.152235120534897,0.709742307662964],[0.339689195156097,0.541671752929688,0.245907485485077],[0.368166536092758,0.751258492469788,0.3169204890728],[0.324825525283813,0.209468126296997,0.942625522613525],[0.377007782459259,0.655273914337158,0.827150046825409],[0.221884727478027,0.84548544883728,0.359424710273743]],"ignoreExtent":false,"flags":64},"10":{"id":10,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[1,1,1,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"15":{"id":15,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[0,"NA","NA"],[0.200000002980232,"NA","NA"],[0.400000005960464,"NA","NA"],[0.600000023841858,"NA","NA"],[0.800000011920929,"NA","NA"],[1,"NA","NA"],["NA",0,"NA"],["NA",0.200000002980232,"NA"],["NA",0.400000005960464,"NA"],["NA",0.600000023841858,"NA"],["NA",0.800000011920929,"NA"],["NA",1,"NA"],["NA","NA",0],["NA","NA",0.200000002980232],["NA","NA",0.400000005960464],["NA","NA",0.600000023841858],["NA","NA",0.800000011920929],["NA","NA",1]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[39,40,41,42,43,44,45]},"11":{"id":11,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,4.23834896087646],"modelMatrix":[[1,0,0,-0.5],[0,0.342020153999329,0.939692616462708,-0.640856385231018],[0,-0.939692616462708,0.342020153999329,-3.93951272964478],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370277404785,-15.2787580490112],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0.0500000007450581,0.949999988079071,0.0500000007450581,0.949999988079071,0.0500000007450581,0.949999988079071],"windowRect":[41,70,297,326],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.59999990463257,"activeSubscene":0},"embeddings":{"viewport":"inherit","projection":"inherit","model":"inherit","mouse":"inherit"},"objects":[12,13],"parent":1,"subscenes":[],"flags":5632},"1":{"id":1,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,4.23834896087646],"modelMatrix":[[1,0,0,-0.5],[0,0.342020153999329,0.939692616462708,-0.640856385231018],[0,-0.939692616462708,0.342020153999329,-3.93951272964478],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370277404785,-15.2787580490112],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0,1,0,1,0,1],"windowRect":[41,70,297,326],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.59999990463257,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[10,15,14,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,11,39,40,41,42,43,44,45],"subscenes":11,"flags":7804},"39":{"id":39,"type":"lines","material":{"lit":false},"vertices":[[0,-0.0149999996647239,-0.0149999996647239],[1,-0.0149999996647239,-0.0149999996647239],[0,-0.0149999996647239,-0.0149999996647239],[0,-0.0407500006258488,-0.0407500006258488],[0.200000002980232,-0.0149999996647239,-0.0149999996647239],[0.200000002980232,-0.0407500006258488,-0.0407500006258488],[0.400000005960464,-0.0149999996647239,-0.0149999996647239],[0.400000005960464,-0.0407500006258488,-0.0407500006258488],[0.600000023841858,-0.0149999996647239,-0.0149999996647239],[0.600000023841858,-0.0407500006258488,-0.0407500006258488],[0.800000011920929,-0.0149999996647239,-0.0149999996647239],[0.800000011920929,-0.0407500006258488,-0.0407500006258488],[1,-0.0149999996647239,-0.0149999996647239],[1,-0.0407500006258488,-0.0407500006258488]],"colors":[[0,0,0,1]],"centers":[[0.5,-0.0149999996647239,-0.0149999996647239],[0,-0.0278750006109476,-0.0278750006109476],[0.200000002980232,-0.0278750006109476,-0.0278750006109476],[0.400000005960464,-0.0278750006109476,-0.0278750006109476],[0.600000023841858,-0.0278750006109476,-0.0278750006109476],[0.800000011920929,-0.0278750006109476,-0.0278750006109476],[1,-0.0278750006109476,-0.0278750006109476]],"ignoreExtent":true,"origId":15,"flags":64},"40":{"id":40,"type":"text","material":{"lit":false},"vertices":[[0,-0.0922499969601631,-0.0922499969601631],[0.200000002980232,-0.0922499969601631,-0.0922499969601631],[0.400000005960464,-0.0922499969601631,-0.0922499969601631],[0.600000023841858,-0.0922499969601631,-0.0922499969601631],[0.800000011920929,-0.0922499969601631,-0.0922499969601631],[1,-0.0922499969601631,-0.0922499969601631]],"colors":[[0,0,0,1]],"texts":[["0"],["0.2"],["0.4"],["0.6"],["0.8"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[0,-0.0922499969601631,-0.0922499969601631],[0.200000002980232,-0.0922499969601631,-0.0922499969601631],[0.400000005960464,-0.0922499969601631,-0.0922499969601631],[0.600000023841858,-0.0922499969601631,-0.0922499969601631],[0.800000011920929,-0.0922499969601631,-0.0922499969601631],[1,-0.0922499969601631,-0.0922499969601631]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":15,"flags":2064},"41":{"id":41,"type":"lines","material":{"lit":false},"vertices":[[-0.0149999996647239,0,-0.0149999996647239],[-0.0149999996647239,1,-0.0149999996647239],[-0.0149999996647239,0,-0.0149999996647239],[-0.0407500006258488,0,-0.0407500006258488],[-0.0149999996647239,0.200000002980232,-0.0149999996647239],[-0.0407500006258488,0.200000002980232,-0.0407500006258488],[-0.0149999996647239,0.400000005960464,-0.0149999996647239],[-0.0407500006258488,0.400000005960464,-0.0407500006258488],[-0.0149999996647239,0.600000023841858,-0.0149999996647239],[-0.0407500006258488,0.600000023841858,-0.0407500006258488],[-0.0149999996647239,0.800000011920929,-0.0149999996647239],[-0.0407500006258488,0.800000011920929,-0.0407500006258488],[-0.0149999996647239,1,-0.0149999996647239],[-0.0407500006258488,1,-0.0407500006258488]],"colors":[[0,0,0,1]],"centers":[[-0.0149999996647239,0.5,-0.0149999996647239],[-0.0278750006109476,0,-0.0278750006109476],[-0.0278750006109476,0.200000002980232,-0.0278750006109476],[-0.0278750006109476,0.400000005960464,-0.0278750006109476],[-0.0278750006109476,0.600000023841858,-0.0278750006109476],[-0.0278750006109476,0.800000011920929,-0.0278750006109476],[-0.0278750006109476,1,-0.0278750006109476]],"ignoreExtent":true,"origId":15,"flags":64},"42":{"id":42,"type":"text","material":{"lit":false},"vertices":[[-0.0922499969601631,0,-0.0922499969601631],[-0.0922499969601631,0.200000002980232,-0.0922499969601631],[-0.0922499969601631,0.400000005960464,-0.0922499969601631],[-0.0922499969601631,0.600000023841858,-0.0922499969601631],[-0.0922499969601631,0.800000011920929,-0.0922499969601631],[-0.0922499969601631,1,-0.0922499969601631]],"colors":[[0,0,0,1]],"texts":[["0"],["0.2"],["0.4"],["0.6"],["0.8"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.0922499969601631,0,-0.0922499969601631],[-0.0922499969601631,0.200000002980232,-0.0922499969601631],[-0.0922499969601631,0.400000005960464,-0.0922499969601631],[-0.0922499969601631,0.600000023841858,-0.0922499969601631],[-0.0922499969601631,0.800000011920929,-0.0922499969601631],[-0.0922499969601631,1,-0.0922499969601631]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":15,"flags":2064},"43":{"id":43,"type":"lines","material":{"lit":false},"vertices":[[-0.0149999996647239,-0.0149999996647239,0],[-0.0149999996647239,-0.0149999996647239,1],[-0.0149999996647239,-0.0149999996647239,0],[-0.0407500006258488,-0.0407500006258488,0],[-0.0149999996647239,-0.0149999996647239,0.200000002980232],[-0.0407500006258488,-0.0407500006258488,0.200000002980232],[-0.0149999996647239,-0.0149999996647239,0.400000005960464],[-0.0407500006258488,-0.0407500006258488,0.400000005960464],[-0.0149999996647239,-0.0149999996647239,0.600000023841858],[-0.0407500006258488,-0.0407500006258488,0.600000023841858],[-0.0149999996647239,-0.0149999996647239,0.800000011920929],[-0.0407500006258488,-0.0407500006258488,0.800000011920929],[-0.0149999996647239,-0.0149999996647239,1],[-0.0407500006258488,-0.0407500006258488,1]],"colors":[[0,0,0,1]],"centers":[[-0.0149999996647239,-0.0149999996647239,0.5],[-0.0278750006109476,-0.0278750006109476,0],[-0.0278750006109476,-0.0278750006109476,0.200000002980232],[-0.0278750006109476,-0.0278750006109476,0.400000005960464],[-0.0278750006109476,-0.0278750006109476,0.600000023841858],[-0.0278750006109476,-0.0278750006109476,0.800000011920929],[-0.0278750006109476,-0.0278750006109476,1]],"ignoreExtent":true,"origId":15,"flags":64},"44":{"id":44,"type":"text","material":{"lit":false},"vertices":[[-0.0922499969601631,-0.0922499969601631,0],[-0.0922499969601631,-0.0922499969601631,0.200000002980232],[-0.0922499969601631,-0.0922499969601631,0.400000005960464],[-0.0922499969601631,-0.0922499969601631,0.600000023841858],[-0.0922499969601631,-0.0922499969601631,0.800000011920929],[-0.0922499969601631,-0.0922499969601631,1]],"colors":[[0,0,0,1]],"texts":[["0"],["0.2"],["0.4"],["0.6"],["0.8"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.0922499969601631,-0.0922499969601631,0],[-0.0922499969601631,-0.0922499969601631,0.200000002980232],[-0.0922499969601631,-0.0922499969601631,0.400000005960464],[-0.0922499969601631,-0.0922499969601631,0.600000023841858],[-0.0922499969601631,-0.0922499969601631,0.800000011920929],[-0.0922499969601631,-0.0922499969601631,1]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":15,"flags":2064},"45":{"id":45,"type":"lines","material":{"lit":false},"vertices":[[-0.0149999996647239,-0.0149999996647239,-0.0149999996647239],[-0.0149999996647239,1.01499998569489,-0.0149999996647239],[-0.0149999996647239,-0.0149999996647239,1.01499998569489],[-0.0149999996647239,1.01499998569489,1.01499998569489],[-0.0149999996647239,-0.0149999996647239,-0.0149999996647239],[-0.0149999996647239,-0.0149999996647239,1.01499998569489],[-0.0149999996647239,1.01499998569489,-0.0149999996647239],[-0.0149999996647239,1.01499998569489,1.01499998569489],[-0.0149999996647239,-0.0149999996647239,-0.0149999996647239],[1.01499998569489,-0.0149999996647239,-0.0149999996647239],[-0.0149999996647239,-0.0149999996647239,1.01499998569489],[1.01499998569489,-0.0149999996647239,1.01499998569489],[-0.0149999996647239,1.01499998569489,-0.0149999996647239],[1.01499998569489,1.01499998569489,-0.0149999996647239],[-0.0149999996647239,1.01499998569489,1.01499998569489],[1.01499998569489,1.01499998569489,1.01499998569489],[1.01499998569489,-0.0149999996647239,-0.0149999996647239],[1.01499998569489,1.01499998569489,-0.0149999996647239],[1.01499998569489,-0.0149999996647239,1.01499998569489],[1.01499998569489,1.01499998569489,1.01499998569489],[1.01499998569489,-0.0149999996647239,-0.0149999996647239],[1.01499998569489,-0.0149999996647239,1.01499998569489],[1.01499998569489,1.01499998569489,-0.0149999996647239],[1.01499998569489,1.01499998569489,1.01499998569489]],"colors":[[0,0,0,1]],"centers":[[-0.0149999996647239,0.5,-0.0149999996647239],[-0.0149999996647239,0.5,1.01499998569489],[-0.0149999996647239,-0.0149999996647239,0.5],[-0.0149999996647239,1.01499998569489,0.5],[0.5,-0.0149999996647239,-0.0149999996647239],[0.5,-0.0149999996647239,1.01499998569489],[0.5,1.01499998569489,-0.0149999996647239],[0.5,1.01499998569489,1.01499998569489],[1.01499998569489,0.5,-0.0149999996647239],[1.01499998569489,0.5,1.01499998569489],[1.01499998569489,-0.0149999996647239,0.5],[1.01499998569489,1.01499998569489,0.5]],"ignoreExtent":true,"origId":15,"flags":64},"52":{"id":52,"type":"linestrip","material":{"alpha":0.498039215803146,"lit":false,"depth_test":"always","isTransparent":true},"vertices":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"colors":[[0,0,0,0.498039215803146]],"centers":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"ignoreExtent":false,"flags":32864}},"crosstalk":{"key":[null],"group":"","id":0,"options":[null]},"width":600,"height":600,"brushId":52,"sphereVerts":{"vb":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0746578340503426,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143208,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143208,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503426,0,0,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186547,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186548,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0,0,0.0746578340503427,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503427,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.0746578340503427,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143209,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143209,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503427,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186548,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.195090322016128,-0.38268343236509,-0.555570233019602,-0.707106781186548,-0.831469612302545,-0.923879532511287,-0.98078528040323,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186548,-0.555570233019602,-0.38268343236509,-0.195090322016128,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186547,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.0746578340503426,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143208,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143208,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503426,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1],[0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186548,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0,0,0.0746578340503426,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503426,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.0746578340503426,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143208,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143208,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503426,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186547,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.195090322016128,-0.38268343236509,-0.555570233019602,-0.707106781186548,-0.831469612302545,-0.923879532511287,-0.98078528040323,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186548,-0.555570233019602,-0.38268343236509,-0.195090322016128,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.58793780120968,-0.653281482438188,-0.693519922661074,-0.707106781186548,-0.693519922661074,-0.653281482438188,-0.58793780120968,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.0746578340503427,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143209,-0.353553390593274,-0.375330277517866,-0.38268343236509,-0.375330277517866,-0.353553390593274,-0.318189645143209,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503427,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0746578340503427,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503427,0,0,0.137949689641472,0.270598050073098,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186547,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073098,0.137949689641472,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0]],"it":[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270],[17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288],[18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271]],"material":[],"normals":null,"texcoords":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1]],"meshColor":"vertices"},"context":{"shiny":false,"rmarkdown":"rmarkdown::html_vignette"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
<p><a href="#top">Back to Top</a></p>
</div>
<div id="non-parametric-testing" class="section level2">
<h2>Non-parametric Testing</h2>
<p>With multivariate ranks and quantiles defined, we can use them to construct non-parametric test statistics for various uses. One such application is the goodness-of-fit testing: given independent <span class="math inline">\(\{X_i\}_{i=1}^n\sim\nu_X\)</span> and <span class="math inline">\(\{Y_i\}_{i=1}^m\sim\nu_Y\)</span>, we want to test <span class="math display">\[H_0\colon\nu_X=\nu_Y\qquad\text{versus}\qquad H_1\colon\nu_X\neq\nu_Y.\]</span> Function <code>tos.gof.test</code> implements the statistic (for 2D and 3D) proposed in <span class="citation">(Ghosal and Sen 2019)</span> for this test: <span class="math display">\[T_{X,Y}=\int_{[0,1]^d}\left\lVert\hat{R}_{X,Y}(\hat{Q}_{X}(u))-\hat{R}_{X,Y}(\hat{Q}_{Y}(u))\right\rVert_2^2\,d\mu(u),\]</span> where <span class="math inline">\(\mu=U[0,1]^d\)</span>. Under the null hypothesis <span class="math inline">\(T_{X,Y}\)</span> is expected to be small so we reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(T_{X,Y}\)</span> exceeds certain critical value. However, since we do not yet have the analytical form of the null distribution, we compute the <span class="math inline">\(p\)</span>-value through permutations instead. In addition, the integral in the definition of <span class="math inline">\(T_{X,Y}\)</span> is evaluated through quasi-Monte Carlo, and by default we use a Sobol sequence of length <span class="math inline">\(10000\)</span>.</p>
<p>The following example showcases a goodness-of-fit test with <span class="math inline">\(H_0\)</span> false. For simplicity we set the number of permutations to <span class="math inline">\(100\)</span>, in practice this parameter is usually set to <span class="math inline">\(500\)</span>, <span class="math inline">\(1000\)</span>, or <span class="math inline">\(1500\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># simulate data, H_0 false</span></a>
<a class="sourceLine" id="cb4-2" title="2">p =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb4-3" title="3">n =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb4-4" title="4">Sigma1 =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), p, p)</a>
<a class="sourceLine" id="cb4-5" title="5">eS =<span class="st"> </span><span class="kw">eigen</span>(Sigma1, <span class="dt">symmetric =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb4-6" title="6">X =<span class="st"> </span><span class="kw">t</span>(eS<span class="op">$</span>vectors <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(<span class="kw">pmax</span>(eS<span class="op">$</span>values, <span class="dv">0</span>)), p) <span class="op">%*%</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(p <span class="op">*</span><span class="st"> </span>n), p))</a>
<a class="sourceLine" id="cb4-7" title="7">Sigma2 =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>), p, p)</a>
<a class="sourceLine" id="cb4-8" title="8">eS =<span class="st"> </span><span class="kw">eigen</span>(Sigma2, <span class="dt">symmetric =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb4-9" title="9">Y =<span class="st"> </span><span class="kw">t</span>(eS<span class="op">$</span>vectors <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(<span class="kw">pmax</span>(eS<span class="op">$</span>values, <span class="dv">0</span>)), p) <span class="op">%*%</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(p <span class="op">*</span><span class="st"> </span>n), p))</a>
<a class="sourceLine" id="cb4-10" title="10"></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co"># two sample goodness-of-fit test</span></a>
<a class="sourceLine" id="cb4-12" title="12">GoF =<span class="st"> </span><span class="kw">tos.gof.test</span>(X, Y, <span class="dt">n.perm =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt; Consider setting n.perm to a larger value, otherwise the permutation p-value may not be reliable.</span></a>
<a class="sourceLine" id="cb4-14" title="14">GoF</a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co">#&gt; $perm.stats</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="co">#&gt;   [1] 0.05547294 0.01362790 0.02020353 0.02025701 0.02222902 0.01547936</span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">#&gt;   [7] 0.01775848 0.01510168 0.02076719 0.01271096 0.02889391 0.01589894</span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt;  [13] 0.01733697 0.02083321 0.01310197 0.01815264 0.01476966 0.01402921</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt;  [19] 0.04092426 0.01297677 0.02086594 0.01922223 0.01627245 0.01778115</span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">#&gt;  [25] 0.01559354 0.02069145 0.01589480 0.01770116 0.01783689 0.01821656</span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">#&gt;  [31] 0.01455673 0.02269634 0.01937998 0.01361806 0.01664510 0.01908505</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="co">#&gt;  [37] 0.01742552 0.02645806 0.02266787 0.01691875 0.01683172 0.01768728</span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="co">#&gt;  [43] 0.01511479 0.01708146 0.01722143 0.01275648 0.01964849 0.02114601</span></a>
<a class="sourceLine" id="cb4-24" title="24"><span class="co">#&gt;  [49] 0.02529509 0.01726285 0.01492604 0.01775032 0.01606573 0.01908499</span></a>
<a class="sourceLine" id="cb4-25" title="25"><span class="co">#&gt;  [55] 0.01877251 0.02560740 0.01515603 0.01745057 0.01483496 0.01969811</span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="co">#&gt;  [61] 0.01544080 0.01825925 0.02120513 0.01411049 0.01752653 0.01612723</span></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="co">#&gt;  [67] 0.01568712 0.02220282 0.01356071 0.01963889 0.01731658 0.01644406</span></a>
<a class="sourceLine" id="cb4-28" title="28"><span class="co">#&gt;  [73] 0.02146766 0.01445971 0.02676911 0.01803858 0.02336171 0.03397531</span></a>
<a class="sourceLine" id="cb4-29" title="29"><span class="co">#&gt;  [79] 0.02224157 0.02315803 0.01806431 0.01927216 0.02286131 0.01920470</span></a>
<a class="sourceLine" id="cb4-30" title="30"><span class="co">#&gt;  [85] 0.03045460 0.02080260 0.01981565 0.01389055 0.02064275 0.01999544</span></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="co">#&gt;  [91] 0.01805560 0.01490642 0.04178384 0.01436522 0.01584841 0.01928399</span></a>
<a class="sourceLine" id="cb4-32" title="32"><span class="co">#&gt;  [97] 0.01698221 0.01437074 0.02017172 0.01729559 0.02056135</span></a>
<a class="sourceLine" id="cb4-33" title="33"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-34" title="34"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb4-35" title="35"><span class="co">#&gt; [1] 0.00990099</span></a></code></pre></div>
<p>Another useful application of the multivariate ranks and quantiles in non-parametric testing is the test of independence: given samples <span class="math inline">\(\{Z_i=(X_i, Y_i)\}\sim\nu\)</span>, where <span class="math inline">\(X_i\sim\nu_X\)</span> and <span class="math inline">\(Y_i\sim\nu_Y\)</span>, wed like to test <span class="math display">\[H_0\colon\nu=\nu_X\otimes\nu_Y\qquad\text{versus}\qquad H_1\colon\nu\neq\nu_X\otimes\nu_Y.\]</span> A test statistic for this is presented in <span class="citation">(Ghosal and Sen 2019)</span> and reduced to the following when both <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span> are univariate: <span class="math display">\[T_n=\frac{1}{n}\sum_{i=1}^n\left\lVert\hat{R}_{Z}(\hat{Q}_{Z}(u))-\tilde{R}_{Z}(\hat{Q}_{Z}(u))\right\rVert_2^2,\]</span> where <span class="math inline">\(\tilde{R}_{Z}=(\hat{R}_{X},\hat{R}_{Y})\)</span> is simply the joining of the usual 1D ranks of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. The following snippet demonstrates how to perform this test with <code>tos.dep.test</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># simulate data, H_0 false</span></a>
<a class="sourceLine" id="cb5-2" title="2">p =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb5-3" title="3">n =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb5-4" title="4">Sigma =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>), p, p)</a>
<a class="sourceLine" id="cb5-5" title="5">eS =<span class="st"> </span><span class="kw">eigen</span>(Sigma, <span class="dt">symmetric =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-6" title="6">Z =<span class="st"> </span><span class="kw">t</span>(eS<span class="op">$</span>vectors <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(<span class="kw">pmax</span>(eS<span class="op">$</span>values, <span class="dv">0</span>)), p) <span class="op">%*%</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(p <span class="op">*</span><span class="st"> </span>n), p))</a>
<a class="sourceLine" id="cb5-7" title="7">X =<span class="st"> </span>Z[, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb5-8" title="8">Y =<span class="st"> </span>Z[, <span class="dv">2</span>]</a>
<a class="sourceLine" id="cb5-9" title="9"></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co"># test of independence</span></a>
<a class="sourceLine" id="cb5-11" title="11">Dep =<span class="st"> </span><span class="kw">tos.dep.test</span>(X, Y, <span class="dt">n.perm =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt; Consider setting n.perm to a larger value, otherwise the permutation p-value may not be reliable.</span></a>
<a class="sourceLine" id="cb5-13" title="13">Dep</a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt; $perm.stats</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt;   [1] 0.073505775 0.006518720 0.004143096 0.005541443 0.005001417 0.006595635</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt;   [7] 0.005252833 0.006505574 0.003433359 0.004327010 0.004873735 0.005019515</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt;  [13] 0.004789883 0.006012297 0.004064832 0.003968829 0.005364283 0.005100733</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt;  [19] 0.005533224 0.007205579 0.004206188 0.004333355 0.005751853 0.004721478</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">#&gt;  [25] 0.004132254 0.006250693 0.003724183 0.004856850 0.005691049 0.005835331</span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt;  [31] 0.004829793 0.005157377 0.005144305 0.006197362 0.006152218 0.006337448</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">#&gt;  [37] 0.004229691 0.004489420 0.005762586 0.004583222 0.006165942 0.005937769</span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">#&gt;  [43] 0.004106408 0.006838442 0.004435239 0.006610882 0.005697316 0.004319662</span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co">#&gt;  [49] 0.005161137 0.005551486 0.004602594 0.008249558 0.005559091 0.004151665</span></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">#&gt;  [55] 0.004118469 0.004962297 0.004925248 0.004853449 0.004586046 0.006150044</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="co">#&gt;  [61] 0.004990701 0.005853972 0.003831541 0.005185757 0.005071440 0.006480297</span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="co">#&gt;  [67] 0.004250496 0.004507833 0.004689384 0.005721124 0.005373306 0.005295352</span></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="co">#&gt;  [73] 0.004355905 0.004242256 0.004017391 0.003833847 0.007453587 0.004522687</span></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="co">#&gt;  [79] 0.007252121 0.004603467 0.004891666 0.005331738 0.004680589 0.005663563</span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="co">#&gt;  [85] 0.008634855 0.004519173 0.005219668 0.003815728 0.006149609 0.005723391</span></a>
<a class="sourceLine" id="cb5-30" title="30"><span class="co">#&gt;  [91] 0.005627175 0.004884437 0.005521158 0.005418946 0.006267264 0.004347151</span></a>
<a class="sourceLine" id="cb5-31" title="31"><span class="co">#&gt;  [97] 0.003461499 0.004890923 0.005063414 0.004540293 0.004248092</span></a>
<a class="sourceLine" id="cb5-32" title="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-33" title="33"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb5-34" title="34"><span class="co">#&gt; [1] 0.00990099</span></a></code></pre></div>
<p><a href="#top">Back to Top</a></p>
</div>
<div id="statistical-depth" class="section level2">
<h2>Statistical Depth</h2>
<p>The statistical depth is a measurement of the center-outward ordering of points in the support of a distribution, and it can be used to generalize some univariate notions, such as the median, to multivariate. Following suggestion of <span class="citation">(Chernozhukov et al. 2017)</span>, we compute the sample depth of <span class="math inline">\(\{X_i\}_{i=1}^n\sim\nu\)</span> in <span class="math inline">\(\mathbb{R}^d\)</span> as <span class="math display">\[\hat{D}_n(\mathbf{x})=\frac{1}{2}-\left\lVert\hat{R}_{n}(\mathbf{x})-\frac{1}{2}\mathbf{1}_d\right\rVert_\infty.\]</span> The following example shows the sample depth of the banana-shaped data presented in <span class="citation">(Chernozhukov et al. 2017)</span>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># simulate banana-shaped data</span></a>
<a class="sourceLine" id="cb6-2" title="2">n =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb6-3" title="3">x =<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">-1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-4" title="4">phi =<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi)</a>
<a class="sourceLine" id="cb6-5" title="5">z =<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-6" title="6">r =<span class="st"> </span><span class="fl">0.2</span> <span class="op">*</span><span class="st"> </span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(x)) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-7" title="7">X =<span class="st"> </span><span class="kw">cbind</span>(x <span class="op">+</span><span class="st"> </span>r <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(phi), x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>r <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(phi))</a>
<a class="sourceLine" id="cb6-8" title="8"></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co"># fit a transport map</span></a>
<a class="sourceLine" id="cb6-10" title="10">X.OTM =<span class="st"> </span><span class="kw">tos.fit</span>(X)</a>
<a class="sourceLine" id="cb6-11" title="11"></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co"># set a grid to evaluate the depth, so that we can plot them</span></a>
<a class="sourceLine" id="cb6-13" title="13">k =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb6-14" title="14">q =<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="dt">length.out =</span> k)</a>
<a class="sourceLine" id="cb6-15" title="15">Q =<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">expand.grid</span>(q, q))</a>
<a class="sourceLine" id="cb6-16" title="16"></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co"># compute depth, then plot its heatmap</span></a>
<a class="sourceLine" id="cb6-18" title="18">D =<span class="st"> </span><span class="kw">tos.depth</span>(X.OTM, Q, <span class="dt">scale =</span> F)</a>
<a class="sourceLine" id="cb6-19" title="19"><span class="kw">filled.contour</span>(q, q, <span class="kw">matrix</span>(D, k, k), <span class="dt">color.palette =</span> <span class="cf">function</span>(n) <span class="kw">cm.colors</span>(n)) </a></code></pre></div>
<p><img src="data:image/png;base64,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" width="480" /></p>
<p><a href="#top">Back to Top</a></p>
</div>
<div id="reference" class="section level2 unnumbered">
<h2>Reference</h2>
<div id="refs" class="references">
<div id="ref-FA1987">
<p>Aurenhammer, F. 1987. Power Diagrams: Properties, Algorithms and Applications. <em>SIAM Journal on Computing</em> 16 (1): 7896. <a href="https://doi.org/10.1137/0216006">https://doi.org/10.1137/0216006</a>.</p>
</div>
<div id="ref-B1991">
<p>Brenier, Yann. 1991. Polar Factorization and Monotone Rearrangement of Vector-Valued Functions. <em>Communications on Pure and Applied Mathematics</em> 44 (4): 375417. <a href="https://doi.org/10.1002/cpa.3160440402">https://doi.org/10.1002/cpa.3160440402</a>.</p>
</div>
<div id="ref-CDS2013">
<p>Cheng, Siu-Wing, Tamal Krishna Dey, and Jonathan Richard Shewchuk. 2013. <em>Delaunay Mesh Generation</em>. Chapman; Hall/CRC.</p>
</div>
<div id="ref-CGHH2017">
<p>Chernozhukov, Victor, Alfred Galichon, Marc Hallin, and Marc Henry. 2017. MongeKantorovich Depth, Quantiles, Ranks and Signs. <em>The Annals of Statistics</em> 45 (1): 22356. <a href="https://doi.org/10.1214/16-AOS1450">https://doi.org/10.1214/16-AOS1450</a>.</p>
</div>
<div id="ref-GS2019">
<p>Ghosal, Promit, and Bodhisattva Sen. 2019. Multivariate Ranks and Quantiles Using Optimal Transportation and Applications to Goodness-of-Fit Testing. <a href="http://arxiv.org/abs/1905.05340">http://arxiv.org/abs/1905.05340</a>.</p>
</div>
<div id="ref-LS2018">
<p>Lvy, Bruno, and Erica L. Schwindt. 2018. Notions of Optimal Transport Theory and How to Implement Them on a Computer. <em>Computers &amp; Graphics</em> 72: 13548. <a href="https://doi.org/10.1016/j.cag.2018.01.009">https://doi.org/10.1016/j.cag.2018.01.009</a>.</p>
</div>
<div id="ref-M1995">
<p>McCann, Robert J. 1995. Existence and Uniqueness of Monotone Measure-Preserving Maps. <em>Duke Math. J.</em> 80 (2): 30923. <a href="https://doi.org/10.1215/S0012-7094-95-08013-2">https://doi.org/10.1215/S0012-7094-95-08013-2</a>.</p>
</div>
<div id="ref-TOG2017">
<p>Toth, Csaba D., Joseph ORourke, and Jacob E. Goodman, eds. 2017. <em>Handbook of Discrete and Computational Geometry</em>. 3rd ed. Chapman; Hall/CRC.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
